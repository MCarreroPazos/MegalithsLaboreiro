<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Denise Lima e Silva">
<meta name="author" content="Miguel Carrero-Pazos">
<meta name="author" content="Francisco Lara-Piñera">
<meta name="author" content="João Fonte">
<meta name="author" content="Benito Vilas-Estévez">
<meta name="dcterms.date" content="2025-05-21">

<title>Spatial insights of the tumular phenomenon in Serra do Laboreiro region (NW Iberian Peninsula)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="quarto_project_files/libs/clipboard/clipboard.min.js"></script>
<script src="quarto_project_files/libs/quarto-html/quarto.js"></script>
<script src="quarto_project_files/libs/quarto-html/popper.min.js"></script>
<script src="quarto_project_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="quarto_project_files/libs/quarto-html/anchor.min.js"></script>
<link href="quarto_project_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="quarto_project_files/libs/quarto-html/quarto-syntax-highlighting-de84f8d6bb715db06a919283c2d1e787.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="quarto_project_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="quarto_project_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="quarto_project_files/libs/bootstrap/bootstrap-b2b299225222a4928e5fd54fb9990afc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#abstract" id="toc-abstract" class="nav-link active" data-scroll-target="#abstract">Abstract</a></li>
  <li><a href="#keywords" id="toc-keywords" class="nav-link" data-scroll-target="#keywords">Keywords</a></li>
  <li><a href="#introduction-study-area-and-the-context-of-its-megalithic-landscape" id="toc-introduction-study-area-and-the-context-of-its-megalithic-landscape" class="nav-link" data-scroll-target="#introduction-study-area-and-the-context-of-its-megalithic-landscape"><strong>1. Introduction: study area and the context of its megalithic landscape</strong></a></li>
  <li><a href="#methods-and-analyses" id="toc-methods-and-analyses" class="nav-link" data-scroll-target="#methods-and-analyses"><strong>2. Methods and analyses</strong></a></li>
  <li><a href="#descriptive-approaches-to-the-distribution-of-sites" id="toc-descriptive-approaches-to-the-distribution-of-sites" class="nav-link" data-scroll-target="#descriptive-approaches-to-the-distribution-of-sites"><strong>3. Descriptive approaches to the distribution of sites</strong></a></li>
  <li><a href="#laboreiros-spatial-structure-based-on-the-monuments" id="toc-laboreiros-spatial-structure-based-on-the-monuments" class="nav-link" data-scroll-target="#laboreiros-spatial-structure-based-on-the-monuments"><strong>4. Laboreiro’s spatial structure based on the monuments</strong></a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><strong>5. Results</strong></a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><strong>6. Conclusion</strong></a></li>
  <li><a href="#reproducibility-statement" id="toc-reproducibility-statement" class="nav-link" data-scroll-target="#reproducibility-statement"><strong>7. Reproducibility statement</strong></a></li>
  <li><a href="#acknowledgments" id="toc-acknowledgments" class="nav-link" data-scroll-target="#acknowledgments"><strong>8. Acknowledgments</strong></a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><strong>9. References</strong></a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Spatial insights of the tumular phenomenon in Serra do Laboreiro region (NW Iberian Peninsula)</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Denise Lima e Silva <a href="mailto:limadenisearch21@gmail.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Coimbra
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Miguel Carrero-Pazos <a href="mailto:miguel.carrero@usc.es" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0001-9203-9954" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Santiago de Compostela / CISPAC
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Francisco Lara-Piñera <a href="mailto:flara@geo.uned.es" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            National University of Distance Education
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">João Fonte <a href="mailto:jfonte@fcsh.unl.pt" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0003-0367-0598" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            NOVA University Lisbon
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Benito Vilas-Estévez <a href="mailto:vilasbenito@gmail.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Arbore Arqueoloxia
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 21, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="abstract" class="level2">
<h2 class="anchored" data-anchor-id="abstract">Abstract</h2>
<p>The region encompassing Planalto de Castro Laboreiro (Melgaço, Portugal), Baixa Limia (Ourense, Spain), and its surrounding areas is renowned for its significant concentration of tumular and megalithic sites. Despite the lack of formal excavations for most of the sites, this study employs a landscape archaeology approach supported by spatial statistics to identify possible spatial patterning behind the construction of the megalithic landscape. We tested multiple landscape features that have long been emphasized as having a significant influence on the placement of these monuments within the territory, and present how the geomorphology of the territory acts as both a constraint and social booster in the construction and deconstruction of these multiple spaces over time.</p>
</section>
<section id="keywords" class="level2">
<h2 class="anchored" data-anchor-id="keywords">Keywords</h2>
<p>Landscape archaeology, GeogrLandscape archaeology, Geographic Information Systems, Spatial Statistics, Megalithic Complex, Portugal, Spain.aphic Information Systems, Spatial Statistics, Megalithic Complex, Portugal, Spain</p>
</section>
<section id="introduction-study-area-and-the-context-of-its-megalithic-landscape" class="level2">
<h2 class="anchored" data-anchor-id="introduction-study-area-and-the-context-of-its-megalithic-landscape"><strong>1. Introduction: study area and the context of its megalithic landscape</strong></h2>
<p>The regions circumscribing the Northwest of the Iberian Peninsula boast one of the highest concentrations of megalithic sites in Europe. Currently, there are over 10,000 registered <em>tumuli</em> and dolmens in this area (see Scarre, 2018). Amongst this area, Serra do Laboreiro and its surroundings stands out as the area with the most abundant concentrations, situated administratively between Portugal (Alto Minho, Viana do Castelo District) and Spain (Galicia) (<strong>Figure 1</strong>).</p>
<div class="cell">
<div class="code-with-filename">
<details class="code-fold">
<summary>Code</summary>
<div class="code-with-filename-file">
<pre><strong>Figure 1.R</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Code for figure 1</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(prettymapr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Set working directory and paths</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"~/Desktop/Laboreiro/"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>shp_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"shp"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>grid_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"grid"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Load spatial data</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">invisible</span>(<span class="fu">suppressMessages</span>(<span class="fu">st_read</span>(<span class="fu">file.path</span>(shp_path, <span class="st">"sites_lab.shp"</span>), <span class="at">quiet =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="dv">4326</span>)))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>study_area <span class="ot">&lt;-</span> <span class="fu">invisible</span>(<span class="fu">suppressMessages</span>(<span class="fu">st_read</span>(<span class="fu">file.path</span>(shp_path, <span class="st">"mask.shp"</span>), <span class="at">quiet =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="dv">4326</span>)))</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Load DEM</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>dem <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(terra<span class="sc">::</span><span class="fu">rast</span>(<span class="fu">file.path</span>(grid_path, <span class="st">"dtm.tif"</span>)))</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>dem <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">project</span>(dem, <span class="st">"EPSG:4326"</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Iberia basemap</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>iberia <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">country =</span> <span class="fu">c</span>(<span class="st">"spain"</span>, <span class="st">"portugal"</span>), <span class="at">returnclass =</span> <span class="st">"sf"</span>, <span class="at">scale =</span> <span class="dv">10</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>iberia <span class="ot">&lt;-</span> <span class="fu">st_cast</span>(<span class="fu">st_geometry</span>(iberia), <span class="st">"POLYGON"</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>iberia <span class="ot">&lt;-</span> iberia[<span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(iberia))[,<span class="st">"X"</span>] <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">10</span>, ]</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>iberia <span class="ot">&lt;-</span> <span class="fu">st_union</span>(iberia[<span class="fu">st_area</span>(iberia) <span class="sc">&gt;</span> units<span class="sc">::</span><span class="fu">set_units</span>(<span class="dv">50000000</span>, <span class="st">"m^2"</span>)])</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>iberia <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(iberia, <span class="dv">4326</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>franceandorra <span class="ot">&lt;-</span> <span class="fu">st_cast</span>(<span class="fu">st_geometry</span>(<span class="fu">ne_countries</span>(<span class="at">country =</span> <span class="st">"france"</span>, <span class="at">returnclass =</span> <span class="st">"sf"</span>, <span class="at">scale =</span> <span class="dv">10</span>)), <span class="st">"POLYGON"</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>franceandorra <span class="ot">&lt;-</span> franceandorra[<span class="fu">st_area</span>(franceandorra) <span class="sc">==</span> units<span class="sc">::</span><span class="fu">set_units</span>(<span class="fu">max</span>(<span class="fu">st_area</span>(franceandorra)), <span class="st">"m^2"</span>)]</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>franceandorra <span class="ot">&lt;-</span> <span class="fu">st_union</span>(franceandorra, <span class="fu">st_geometry</span>(<span class="fu">ne_countries</span>(<span class="at">country =</span> <span class="st">"andorra"</span>, <span class="at">returnclass =</span> <span class="st">"sf"</span>, <span class="at">scale =</span> <span class="dv">10</span>)))</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>franceandorra <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(franceandorra, <span class="dv">4326</span>)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>northafrica <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">country =</span> <span class="fu">c</span>(<span class="st">"morocco"</span>, <span class="st">"algeria"</span>), <span class="at">returnclass =</span> <span class="st">"sf"</span>, <span class="at">scale =</span> <span class="dv">10</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>northafrica <span class="ot">&lt;-</span> <span class="fu">st_cast</span>(<span class="fu">st_geometry</span>(northafrica), <span class="st">"POLYGON"</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>northafrica <span class="ot">&lt;-</span> <span class="fu">st_union</span>(northafrica[<span class="fu">st_area</span>(northafrica) <span class="sc">&gt;</span> units<span class="sc">::</span><span class="fu">set_units</span>(<span class="dv">50000000</span>, <span class="st">"m^2"</span>)])</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>northafrica <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(northafrica, <span class="dv">4326</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>andorra <span class="ot">&lt;-</span> <span class="fu">st_cast</span>(<span class="fu">st_geometry</span>(<span class="fu">ne_countries</span>(<span class="at">country =</span> <span class="st">"andorra"</span>, <span class="at">returnclass =</span> <span class="st">"sf"</span>, <span class="at">scale =</span> <span class="dv">10</span>)), <span class="st">"POLYGON"</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>andorra <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(andorra, <span class="dv">4326</span>)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>iberiaAndorra <span class="ot">&lt;-</span> <span class="fu">st_union</span>(iberia, andorra)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel 1 and Panel 2 in the first row, and Panel 3 in the second row spanning both columns</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>layout_matrix <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the layout</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(layout_matrix)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel 1: Plot study area</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iberiaAndorra, <span class="at">border =</span> <span class="cn">NA</span>, <span class="at">col =</span> <span class="st">"grey75"</span>,</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"a. Study area in the Iberian Peninsula"</span>) </span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(franceandorra, <span class="at">col =</span> <span class="st">"grey90"</span>, <span class="at">border =</span> <span class="cn">NA</span>, <span class="at">add =</span> <span class="cn">TRUE</span>) </span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(northafrica, <span class="at">col =</span> <span class="st">"grey90"</span>, <span class="at">border =</span> <span class="cn">NA</span>, <span class="at">add =</span> <span class="cn">TRUE</span>) </span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw a solid rectangle to represent the zoom window</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="fu">rect</span>(<span class="at">xleft =</span> <span class="sc">-</span><span class="fl">8.4</span>, <span class="at">xright =</span> <span class="sc">-</span><span class="fl">7.85</span>, </span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>     <span class="at">ybottom =</span> <span class="fl">41.85</span>, <span class="at">ytop =</span> <span class="fl">42.25</span>,</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="fu">addnortharrow</span>(<span class="at">scale =</span> <span class="fl">0.5</span>)</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="fu">addscalebar</span>(<span class="at">pos =</span> <span class="st">"bottomright"</span>)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel 2. Study area in the Iberian Peninsula</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>zoom_window <span class="ot">&lt;-</span> <span class="fu">st_sfc</span>(<span class="fu">st_point</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.9484</span>, <span class="fl">41.7</span>)), <span class="fu">st_point</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">7.7481</span>, <span class="fl">42.2</span>)), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>window_coord_sf <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(zoom_window)</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>iberia_nw <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">country =</span> <span class="fu">c</span>(<span class="st">"spain"</span>, <span class="st">"portugal"</span>), <span class="at">returnclass =</span> <span class="st">"sf"</span>, <span class="at">scale =</span> <span class="dv">10</span>)</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>iberia_nw <span class="ot">&lt;-</span> <span class="fu">st_cast</span>(<span class="fu">st_geometry</span>(iberia_nw), <span class="st">"POLYGON"</span>)</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>iberia_nw <span class="ot">&lt;-</span> iberia_nw[<span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(iberia_nw))[,<span class="st">"X"</span>] <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">10</span>, ]</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>iberia_nw <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(iberia_nw, <span class="dv">4326</span>)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="do">## Set up the plot layout and margins</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot Iberia map with bounding box (window coordinates)</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(iberia_nw), <span class="at">col =</span> <span class="st">"lightgray"</span>, <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">main =</span> <span class="st">"b. Serra do Laboreiro region"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(window_coord_sf[<span class="dv">1</span>, <span class="st">"X"</span>], window_coord_sf[<span class="dv">2</span>, <span class="st">"X"</span>]),</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(window_coord_sf[<span class="dv">1</span>, <span class="st">"Y"</span>], window_coord_sf[<span class="dv">2</span>, <span class="st">"Y"</span>]), </span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Longitude"</span>, <span class="at">ylab =</span> <span class="st">"Latitude"</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="do">## Add custom axis labels for longitude and latitude</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">8.95</span>, <span class="sc">-</span><span class="fl">7.75</span>, <span class="at">by =</span> <span class="fl">0.1</span>), <span class="at">labels =</span> <span class="cn">TRUE</span>)  <span class="co"># Longitude (x-axis)</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="fl">41.7</span>, <span class="fl">42.2</span>, <span class="at">by =</span> <span class="fl">0.1</span>), <span class="at">labels =</span> <span class="cn">TRUE</span>)  <span class="co"># Latitude (y-axis)</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="do">## Add labels for Spain and Portugal</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.6</span>, <span class="sc">-</span><span class="fl">8.59</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">42.13</span>, <span class="fl">41.91</span>), </span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Spain"</span>, <span class="st">"Portugal"</span>), </span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"black"</span>, </span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>, </span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>     <span class="at">font =</span> <span class="dv">2</span>)</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a><span class="do">## Draw the dashed rectangle to represent the zoom window</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a><span class="fu">rect</span>(<span class="at">xleft =</span> <span class="sc">-</span><span class="fl">8.3015</span>, <span class="at">xright =</span> <span class="sc">-</span><span class="fl">7.9843</span>, <span class="at">ybottom =</span> <span class="fl">41.9483</span>, <span class="at">ytop =</span> <span class="fl">42.1125</span>, </span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex=</span><span class="dv">2</span>)</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a><span class="do">## Add the vertical text for "Atlantic Ocean"</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">8.99</span>, <span class="at">y =</span> <span class="fl">42.0</span>, </span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="st">"Atlantic Ocean"</span>, </span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"black"</span>, </span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>     <span class="at">srt =</span> <span class="dv">90</span>, </span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>, </span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>     <span class="at">font =</span> <span class="dv">2</span>)</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a><span class="fu">addnortharrow</span>(<span class="at">scale =</span> <span class="fl">0.5</span>)</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a><span class="fu">addscalebar</span>(<span class="at">pos =</span> <span class="st">"bottomright"</span>)</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>() <span class="co"># add bounding box</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel 3: DEM with site points</span></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot DEM</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dem, <span class="at">main =</span> <span class="st">"c. Altitude (masl)"</span>)</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Add site points</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sites<span class="sc">$</span>geometry, <span class="at">add =</span> <span class="cn">TRUE</span>, </span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">21</span>, </span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"white"</span>, </span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>     <span class="at">bg =</span> <span class="st">"black"</span>)</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted North Arrow Position (moved left)</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a><span class="co"># North Arrow (top-left)</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="at">x0 =</span> <span class="sc">-</span><span class="fl">8.15</span>, <span class="at">y0 =</span> <span class="fl">42.085</span>, </span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>       <span class="at">x1 =</span> <span class="sc">-</span><span class="fl">8.15</span>, <span class="at">y1 =</span> <span class="fl">42.09</span>, </span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>       <span class="at">length =</span> <span class="fl">0.1</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the "N" label for North just above the arrow</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">8.15</span>, <span class="at">y =</span> <span class="fl">42.093</span>, <span class="at">labels =</span> <span class="st">"N"</span>, </span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">font =</span> <span class="dv">2</span>)</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a><span class="co"># Small Scale Bar (just below the arrow)</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the start and end points for the scale bar</span></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>scale_start_x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">8.154</span></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>scale_end_x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">8.145</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>scale_y <span class="ot">&lt;-</span> <span class="fl">42.082</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw the scale bar with tick marks</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> scale_start_x, </span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>         <span class="at">y0 =</span> scale_y, </span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>         <span class="at">x1 =</span> scale_end_x, </span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>         <span class="at">y1 =</span> scale_y, </span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="st">"black"</span>, </span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>         <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a><span class="co"># Add scale text below the scale bar (e.g., "1 km")</span></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">8.1497</span>, </span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> <span class="fl">42.0789</span>, </span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="st">"1km"</span>, </span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>, </span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>     <span class="at">font =</span> <span class="dv">2</span>, </span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend for the site points (centered on the plot)</span></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">8</span>, <span class="at">y =</span> <span class="fl">42.03</span>,  <span class="co"># Adjust x and y coordinates for the legend position</span></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="st">"Sites"</span>, </span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>, </span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>       <span class="at">pt.bg =</span> <span class="st">"black"</span>, </span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>       <span class="at">pt.cex =</span> <span class="fl">1.2</span>,  <span class="co"># Adjust point size if needed</span></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"white"</span>, </span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">"n"</span>,     <span class="co"># No border around the legend</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="dv">1</span>)     <span class="co"># Adjust font size of the legend</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="quarto_project_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 1. The geographic positioning of the Serra do Laboreiro region within the Iberian Peninsula (above), and study area with the selected megalithic monuments (black dots).</figcaption>
</figure>
</div>
</div>
</div>
<p>Knowledge on the tumular phenomenon at the Portuguese-Galician frontier remains somewhat sparse even considering decades old continuous studies of some areas in the northwest of the Iberian Peninsula. Several efforts coming from Spanish and Portuguese universities, such as the University of Santiago de Compostela (e.g.&nbsp;Eguileta Franco, 1999), the Archaeological Unit of the University of Minho or the Group of Archaeological Studies of Porto (GEAP – Grupo de Estudos Arqueológicos do Porto), jointly with the efforts by the regional governments, such as Xunta de Galicia, were put forth in the decades between 1978 until circa 1992 to survey the territories in the north of Portugal and south of Galicia. Those works resulted in the creation of new site and monument records for the area.</p>
<p>Amongst the most debated, surveyed and excavated megalithic group in the Iberian Northwest remains Serra da Aboboreira (Porto, Portugal) (Cruz, 1980, 1992; Jorge, 1982a, 1983-84, 1992), Trás-os-Montes and the entire region of Entre Douro e Minho (Portugal) (Jorge, 1987; Silva, 2003; Sanches &amp; Nunes, 2005; Bettencourt &amp; Vilas Boas, 2021), with Planalto de Castro Laboreiro (shared between Portugal and Galicia) (López Cuevillas, 1923, 1925a, 1925b; 1973), and the region of Baixa Limia (Ourense) (Eguileta Franco, 1993-94, 1995) with important concentration of prehistoric sites as early as the 5<sup>th</sup> millennium BC. In Galicia, Costa da Morte appears to be one of the regions with the highest density of sites, as several researchers have pointed out (e.g.&nbsp;Carrero-Pazos Rodríguez Casal, 2019).</p>
<p>In the case of Serra do Laboreiro, the continuous surveys and field prospections went from the identification of 64 monuments to circa 200 (Jorge, 1982: 421; Sousa, 2012; cfr: Canedo et al.&nbsp;2023), reaching, today, a little bit over 1,000 registered monuments for the north of Portugal only<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. However, although there are, indeed, over 1,000 entries in the current national database – Geoportal de Arqueologia do Património Cultural, I.P. (<a href="https://arqueologia.patrimoniocultural.pt/" class="uri">https://arqueologia.patrimoniocultural.pt/</a>)-, there is a need for an intensive revision, as some sites may have more than one entry under different identifications or names. In this aspect, a remote identification has its limits, something that is being constantly underlined, stating how indispensable conducting thorough fieldwork validation continues to be - and despite the refinement of AI algorithms (see Canedo et al.&nbsp;2023, 2024).</p>
<p>Only Serra da Aboboreira and its neighbouring mountain, Serra do Castelo, were excavated, published, and studied to their maximum during the 1980s and beginning of the 21<sup>st</sup> century, leaving us a layout for the study of these types of ancient social and territorial contexts. Despite this, the number of monuments is not enough to understand the phenomenon, some defending it even creates a somewhat fragmentary knowledge of it (Jorge, 1987: 270), specifically for the north of Portugal, as we rest mostly on the knowledge of one <em>necropolis.</em> That is not to say that the only source of knowledge for this type of contexts rests solely on one example, rather it is the only one where information can be derived out of one single landscape with approximately 40 (excavated) monuments instead of a small group of them. In fact, if there is something that Serra da Aboboreira underlined was that the tumular phenomenon/tumular landscapes is to be regarded as a heterogenous and polymorphic behaviour (see Jorge, 1981; Fábregas Valcarce, 1988: 280), whose background rests behind a multitude of social layouts and variables – most of which unknown or poorly understood – which stretch over a large chronological space.</p>
<p>As previously mentioned, amongst the most well-known tumular landscapes rests Planalto de Castro Laboreiro and its surrounding areas, and the Galician region of Baixa Limia including Maus de Salas, with 269 identified barrow-like structures, some of which identified in the last decades of the 20<sup>th</sup> century, others inedited and recently added to the database. The monuments are located at altitudes ranging from 1300 m.a.s.l. and 700 m.a.s.l. (<strong>Figure 2</strong>).</p>
<div class="cell">
<div class="code-with-filename">
<details class="code-fold">
<summary>Code</summary>
<div class="code-with-filename-file">
<pre><strong>Figure 2.R</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magick)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define directory path</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>dir_path <span class="ot">&lt;-</span> <span class="st">"/Users/miguelpazoscarrero/Desktop/Laboreiro/images/"</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load images</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>img1 <span class="ot">&lt;-</span> <span class="fu">image_read</span>(<span class="fu">paste0</span>(dir_path, <span class="st">"OFeM1.JPG"</span>))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>img2 <span class="ot">&lt;-</span> <span class="fu">image_read</span>(<span class="fu">paste0</span>(dir_path, <span class="st">"OFeM3_Dolmen.JPG"</span>))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>img3 <span class="ot">&lt;-</span> <span class="fu">image_read</span>(<span class="fu">paste0</span>(dir_path, <span class="st">"Landscape.JPG"</span>))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the target width for the full composition</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>target_width <span class="ot">&lt;-</span> <span class="dv">800</span>  </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Resize the top images so that they add up to the target width</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>img1 <span class="ot">&lt;-</span> <span class="fu">image_resize</span>(img1, <span class="fu">paste0</span>(target_width <span class="sc">/</span> <span class="dv">2</span>, <span class="st">"x"</span>))  </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>img2 <span class="ot">&lt;-</span> <span class="fu">image_resize</span>(img2, <span class="fu">paste0</span>(target_width <span class="sc">/</span> <span class="dv">2</span>, <span class="st">"x"</span>))</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Resize the bottom image to match the target width</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>img3 <span class="ot">&lt;-</span> <span class="fu">image_resize</span>(img3, <span class="fu">paste0</span>(target_width, <span class="st">"x"</span>))</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels "A", "B", and "C" correctly</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>img1 <span class="ot">&lt;-</span> <span class="fu">image_annotate</span>(img1, <span class="st">"A"</span>, </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">gravity =</span> <span class="st">"northwest"</span>, </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">location =</span> <span class="st">"+10+10"</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>                       <span class="at">size =</span> <span class="dv">40</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>                       <span class="at">strokecolor  =</span> <span class="st">"black"</span>)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>img2 <span class="ot">&lt;-</span> <span class="fu">image_annotate</span>(img2, <span class="st">"B"</span>, </span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>                       <span class="at">gravity =</span> <span class="st">"northeast"</span>,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>                       <span class="at">location =</span> <span class="st">"+10+10"</span>,</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>                       <span class="at">size =</span> <span class="dv">40</span>, </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>                       <span class="at">strokecolor =</span> <span class="st">"black"</span>)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>img3 <span class="ot">&lt;-</span> <span class="fu">image_annotate</span>(img3, <span class="st">"C"</span>, </span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>                       <span class="at">gravity =</span> <span class="st">"northwest"</span>,</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>                       <span class="at">location =</span> <span class="st">"+10+10"</span>,</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>                       <span class="at">size =</span> <span class="dv">40</span>, </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>                       <span class="at">strokecolor =</span> <span class="st">"black"</span>)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the first row (OFeM1 and OFeM3_Dolmen)</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>top_row <span class="ot">&lt;-</span> <span class="fu">image_append</span>(<span class="fu">c</span>(img1, img2), <span class="at">stack =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge both rows vertically (top row + full-width bottom image)</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>composition <span class="ot">&lt;-</span> <span class="fu">image_append</span>(<span class="fu">c</span>(top_row, img3), <span class="at">stack =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the final image</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(composition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="quarto_project_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 2. Megalithic sites from Serra do Laboreiro. Photographs by Goreti Sousa (Sousa, 2012).</figcaption>
</figure>
</div>
</div>
</div>
<p>Most of these groups of tumular monuments remain to be excavated. The inner structures encased by the earthen barrows may refer to megalithic chambers like dolmens, or cists, each case referring to particular periods; the very own structural layout of some of the first ones (open dolmens, closed dolmens, dolmens with corridor, megalithic cists) (see Criado Boado &amp; Valcarce, 1989: 688, 692) seems to suggest different timelines not too distant chronologically, as some already suggested (López Cuevillas, 1973; Rodríguez Casal, 1979; Cruz, 1992: 69-72).</p>
<p>The life <em>tempo</em> of some of these monuments – from their construction to abandonment and posterior reuse - stretches in time to such an extent that it becomes challenging to determine concrete phases of interaction with the monument when we want to go beyond the simple determination of a beginning and an end (which, in itself, is not “simple” regarding the invisibility of artefactual and material record and samples for dating). For most of these cases we can mostly consider their landscape framework, <em>i.e.</em>, since we are dealing with a space-related phenomenon, there are associations we can reflect upon, particularly the relationship between humans and their landscape.</p>
<p>Given that this phenomenon brings the novelty of space demarcation through the construction of funerary structures (Renfrew, 1973, 1976; Díez Castillo 1996: 32; Murrieta-Flores, 2012), and since there are many aspects of their builders’ intentions and cultural backgrounds we cannot know for sure, there are common characteristics in terms of territorial display that allude to the criteria used for their construction (something also extensively studied in the Gor necropolis, in Granada; see e.g.&nbsp;Esquivel <em>et al.,</em> 2022; Cabrero González <em>et al.</em> 2025).</p>
<p>Natural elements in the landscape as well as geomorphological features act as those criteria of choice (e.g.&nbsp;Villoch Vázquez 1995; Criado Boado, Villoch Vázquez 2000; García Sanjuán 2008; Blas Cortina 2010), some of which may even rest on aspects of a cultural basis or even a pragmatic nature. We take into consideration the timeline in which this phenomenon first appears and the socioeconomical implications associated with them, meaning, human groups still somewhat mobile, and the first indications of a producing lifestyle - in some places, still very much incipient - coupled with pastoralism and hunter-gatherer activities (Díez Castillo 1996; Fábregas Valcarce &amp; Vilaseco Vásquez, 2006: 2).</p>
<p>The ways of assessing these elements come from a crescent improvement in digital tools from fields such as Geographical Information Systems, Artificial Intelligence and Spatial Statistics, as well as a renovated interest in their application in current archaeological science (Bevan, 2015; Cortell-Nicolau &amp; Pardo-Gordó, 2023). In fact, the importance space holds over humans did not go by unnoticed during earlier studies on these specific monuments (albeit the focus during field works remained towards the obvious parts of the structure – the chamber, corridor, etc.). The most obvious and debated elements relate to the structures’ closeness to rocky outcrops (e.g.&nbsp;&nbsp;L’ Helgouac’h, 1965; Bueno Ramírez, 1988; Criado Boado &amp; Grajal, 1981; Criado Boado, 1984: 9-10; Catela, 2020: 91;), natural passageways (Criado Boado, Vaquero Lastres, 1991; García Sanjuán et al.&nbsp;2009; Cabras, 2018; Murrieta-Flores, 2012, 2014, Llobera, 2000; Carrero Pazos, 2017: 137; Rodríguez Rellán &amp; Fábregas Valcarce 2019), proximity to water bodies (Tilley, 1994: 67, 123; O’Sullivan, 2011: 65) and to arable lands (Criado Boado &amp; Grajal, 1981: 23; Bello Diéguez et al.&nbsp;1982), to which we can add the (inter)visibility and topographic prominence (Criado Boado, 1984: 14, 1988: 669; Cabrero González <em>et al.</em> 2020).</p>
<p>Based on this research background, in this case study we use some of the variables that best account for the location of the megalithic sites, such as altitude, slope, cumulative viewshed, distance to rocky outcrops and the main landscape features, the hydrographic basins and natural pathways.&nbsp;Given the strict relation their construction seems to have with the territory throughout the centuries, a spatial statistical analysis seems the best fit to deal with the lack of information from direct interventions.</p>
</section>
<section id="methods-and-analyses" class="level2">
<h2 class="anchored" data-anchor-id="methods-and-analyses"><strong>2. Methods and analyses</strong></h2>
<section id="spatial-statistics" class="level3">
<h3 class="anchored" data-anchor-id="spatial-statistics">2.1. Spatial Statistics</h3>
<p>The potential of statistical methods and GIS in archaeology has been extensively explored and documented thus far. This is particularly noteworthy, given the advancements in digital tools and technological improvements that have characterized the last two decades (see e.g.&nbsp;Mehrer &amp; Wescott, 2006; Carlson, 2017; Verhagen, 2018;Gillings, Hacigüzeller &amp; Lock, 2020). Archaeologists have eagerly embraced new techniques to assist in establishing methods for interpreting records and organizing data. Similarly, the application of practical and digital methods has surged, in line with new theoretical hypotheses (Hu, 2011; Gillings, 2012).</p>
<p>The ones highlighted in this text arise amidst the tumular phenomenon debate and regard those main territorial attributes or elements from a (tumular) landscape, <em>i.e.</em>, a study on a regional scale of a set of monuments in a mountain environment. As most of the monuments have no information from excavations, the study focuses essentially on direct and observable territorial attributes of the relation between the megalith’s setting and their surroundings.</p>
<p>Studies on landscape archaeology based on Spatial Statistics are not new in the Iberian Peninsula (see e.g.&nbsp;Parcero Oubiña &amp; Fábrega Álvarez, 2006; Yubero-Gómez et al., 2015; Berrocal-Rangel et al., 2018; Rubio Campillo et al.&nbsp;2022; Carrero-Pazos, Bevan &amp; Lake, 2019; Díaz Rodríguez &amp; Fábregas Valcarce, 2022), and the potential they pose proves to be of great utility especially when confronted with case studies that lack formal and direct evidences. However, their application on tumular landscapes is still somewhat incipient, with greater incidence in the Iberian Northwest (Llobera, 2015; Carrero-Pazos et al., 2020; Higginbottom et al., 2022; Berganzo-Besga et al., 2021; Rodríguez del Cueto &amp; Carrero-Pazos, 2021) and the South (Murrieta-Flores, 2012, 2014). &nbsp;Despite the variety of methods used in these analyses and the observation of point distributions and spatial interactions between them, several courses of action may be considered based on the specificities of the study area and the questions to be answered.</p>
<p>We know that behind these monuments rests a multitude of different behaviours extended over large periods of time. From previous readings, be them before or after the introduction of computational approaches, we can also positively assume some <em>de facto</em> aspects: (i) the monuments may occur in the landscape in clusters or isolated, and (ii) may represent distinct chronologies, therefore, we can also positively assume that (iii) the existence of previous monuments is a factor of influence for the construction of new structures in later periods (Carrero-Pazos et al.&nbsp;2019). Consider, for example, Outeiro de Gregos in Serra da Aboboreira (Portugal), a cluster of five monuments ranging from the beginning of 4<sup>th</sup> millennium BCE, to the 2<sup>nd</sup> millennium BCE (Jorge, 1981), or even the Necropolis of Lafões in Viseu (Portugal), a cluster of circa 114 monuments also ranging from the beginning of the 4<sup>th</sup> millennium until the XII-VII century BCE (Carvalho &amp; Carvalho, 2018: 41).</p>
</section>
<section id="archaeological-data.-ground-truthing-through-lidar-data" class="level3">
<h3 class="anchored" data-anchor-id="archaeological-data.-ground-truthing-through-lidar-data">2.2. Archaeological data. Ground truthing through LiDAR data</h3>
<p>The study area is in the frontier territories over Ourense province (Galicia, Spain) and the Melgaço municipality (district of Viana do Castelo, north of Portugal). The archaeological data used in this work is the result of several fieldwork campaigns that some of the authors did in the past (e.g., Vilas Estévez, 2015) and current revisions from AI approaches (Canedo et al.&nbsp;2023, 2024).</p>
<p>For this work, we decided to carry out a ground truthing initial phase based on LiDAR data to check the reliability of the spatial coordinates of the sites. As such, the generation of the DEM and its pretreatment is the first unavoidable step for the entire analytical process and through which all the other variables will be modelled from (see Berganzo-Besga et al., 2022). For this, we used the available LiDAR data for Spain (Geographical National Institute, IGN - <a href="https://pnoa.ign.es/pnoa-lidar/presentacion" class="uri">https://pnoa.ign.es/pnoa-lidar/presentacion</a>), and for Portugal the LiDAR data was obtained from the Comunidade Intermunicipal do Alto Minho (CIM Alto Minho), under the collaboration by one of the authors of this paper (JF).</p>
<p>The provided LiDAR data has a point cloud density of 2 points per square meter for the Portuguese part. For the Spanish (Galician) part, the LiDAR data has a point cloud density of 0.5-2 points per square meter (see <a href="https://pnoa.ign.es/web/portal/pnoa-lidar/especificaciones-tecnicas" class="uri">https://pnoa.ign.es/web/portal/pnoa-lidar/especificaciones-tecnicas</a>).</p>
<p>&nbsp;The DEM was created using <em>LAStools</em>, keeping only the bare ground points with the plug-in <em>lasground</em>. The resulting point clouds were merged in <em>SAGA- GIS 8.5.0</em>, and the resulting raster was interpolated through Angular Distance Weighting (ADW) (Shepard, 1968). We decided to use ADW instead of the more common Inverse Distance Weighting (IDW), in this case, for the sake of computer efficiency. The interpolation resulted in a DEM with a 1m resolution.</p>
<p>This cleaning process permits for the better observation of the terrain with no other categories but the terrain itself, which makes easy the visual identification of the megalithic mounds (Opitz &amp; Cowley, 2013). The ground truthing step required for the terrain observation and confirmation of the tumular occurrences, involved the generation of a Hillshade from the DEM and other raster visualization techniques (see Berganzo-Besga et al., 2021; Berganzo-Besga et al., 2022). In this way, we used the Relief Visualization Toolbox (RVT) (Zakšek, Oštir &amp; Kokalj, 2011;&nbsp;Kokalj &amp; Somrak, 2019) to create other convenient visualization outputs, such as the sky-view factor or a local relief model (Kokalj &amp; Hesse, 2017). We also used the <em>Resampling filter</em> from SAGA GIS, creating additional images with distinct categories in colour and shading that, when compared against the generated hillshade, helped us with the site’s identification. The ground truthing process took into consideration an initial database of 269 points corresponding to monuments identified in field surveys, either from previous prospections or more recent ones (Eguileta Franco 1999; Sousa, 2012; Vilas Estévez 2015). The database we are providing comprises the name of the monument and the UTM coordinates – easting and northing.</p>
<p>To carry out the ground truthing we used ArcGIS where a point shapefile was created and used against the generated raster images. The points typically contrast with the shapes seen in the images aiming to confirm the correct georeferentiation of the monuments during the fieldwork, confirming both a correct identification and a remote LiDAR successful detection. This second step on the process generated a total of 178 points, meaning that 91 monuments were excluded from the ground truthing process according to the chosen parameters: 46 duplicated points from previous databases with monuments registered under two distinct identifications, and 45 points whose remote identification as mounds is dubious and the in-site recognition is not known.</p>
</section>
<section id="gis-modelling.-covariable-set-up" class="level3">
<h3 class="anchored" data-anchor-id="gis-modelling.-covariable-set-up">2.3. GIS modelling. Covariable set up</h3>
<p>The main landscape features previously mentioned are those that have been addressed by different authors as possible predictive variables of the megalithic mounds in Galicia and other regions (see the introduction chapter). Thus, in the case of this research, a data-driven model (Verhagen, 2018) reflects more accurately the factors we have at hand: altitude, slope, distance to main geomorphological features and water sources, etc.</p>
<p>Therefore, several digital models were created from the DEM, according to the variables previously discussed: Slope, Cumulative Horizon, Cumulative Viewshed, Distance to Ridges, Distance to Water Edges, Distance to Rocky Outcrops, Least Cost Paths and Topographic Prominence. Distinct programs were used to create and define the raster covariates: ArcGIS 10.4, SAGA- GIS 8.5.0, Grass GIS 7.8, GIS 3.28 Firenze, and R Studio v. 4.3.0.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 78%">
</colgroup>
<tbody>
<tr class="odd">
<td><ul>
<li>Slope</li>
</ul></td>
<td><ul>
<li><em>ArcMap</em>, using the Surface in Spatial Analyst Tool</li>
</ul></td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 76%">
</colgroup>
<tbody>
<tr class="odd">
<td><ul>
<li>Cumulative horizon</li>
</ul></td>
<td><ul>
<li><em>QGIS 3.28 Firenze</em> through the Visibility Analysis plugin (Čučković, 2016)</li>
</ul></td>
</tr>
</tbody>
</table>
<p>The intent was to model the horizon of the landscape, meaning the outer edges of a viewshed. 1,000 viewpoints where regularly generated and evenly distributed beforehand alongside the entire study area to cover the total landscape under analysis.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 87%">
</colgroup>
<tbody>
<tr class="odd">
<td>Cumulative viewshed</td>
<td><ul>
<li>QGIS 3.28 Firenze. Similarly to the previous variable, we used the visibility index analysis from the Viewshed Analysis plugin (Čučković, 2016)</li>
</ul></td>
</tr>
</tbody>
</table>
<p>1,000 viewpoints were generated across the entirety of the study area, a radius of analysis of 3,000 meters and an observer height of 1.60 meters. The Visibility Index considers the proportion of a given area that is visible from a given observer location, attributing different values to raster cells considering the higher or lower degree of visibility, useful when the objective is the identification of areas in the landscape with the best visibility index.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 86%">
</colgroup>
<tbody>
<tr class="odd">
<td>Distance to ridges</td>
<td><em>GRASS GIS</em> with <em>r.geomorphon</em>. It allows to calculate, classify and map the terrain elements from a DEM (Jasiewicz &amp; Stepinski, 2013).</td>
</tr>
</tbody>
</table>
<p>The objective was to identify the main terrestrial landforms in the study area through the generation of geomorphometric maps and extract the ones that appeared to be of significance to our analysis. To identify the main terrestrial landforms, several maps were generated according to different scales and radius. Five scales were tested:</p>
<ul>
<li><p>Outer radius = 20, inner radius = 5</p></li>
<li><p>Outer radius = 15, inner radius = 5</p></li>
<li><p>Outer radius = 35, inner radius = 0</p></li>
<li><p>Outer radius = 32, inner radius = 0</p></li>
<li><p>Outer radius = 64, inner radius = 5</p></li>
</ul>
<p>It is important to emphasize that the primary goal in defining the main landforms in the study area is closely related to identifying distinct shapes in the geomorphology, meaning, the main scenery cut against the horizon and the sky – things that can be easily recognized while traversing the landscape. Based on this, the critical visual analysis of the results determined that a radius of 64 units captured the key points in the landscape, enabling a faster identification of the main landforms. Therefore, among the 10 categories defined in <em>r.geomorphon</em>, ridges, shoulders and spurs (categories2, 3, and 4 respectively) showed to be the most promising. The raster calculator (<em>r.mapcalc</em>)allowed for the extraction of these specific landforms, so the final result was a raster file with information that regarded solely to landform categories 2, 3 and 4. Lastly, and because we want to ponder on the distance between specific points in the landscape, we applied used <em>r.grow.distance</em> todetermine the distance between the features in the landscape.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 69%">
</colgroup>
<tbody>
<tr class="odd">
<td><ul>
<li>Distance to watershed edges</li>
</ul></td>
<td><ul>
<li><em>GRASS GIS</em> with <em>r.watershed</em> (original version by Ehlschlaeger, 1989).</li>
</ul></td>
</tr>
</tbody>
</table>
<p>To calculate the watershed edges we used hydrological modelling, which calculates flows and basins in a DEM by generating a series of maps according to different parameters: flow accumulation, drainage direction, location of streams, watershed basins. Our variable, however, considers only watershed basins. As it requires a minimum size of the exterior watershed to be set, we tested two sizes: a threshold of 50000 units and 25000 units. A visual analysis concluded that a threshold of 25000 showed more detailed results, outlining specific watershed basins. <em>R.grow.distance</em> was then used to calculate the distance from the watershed edges to the rest of the study area.</p>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td><ul>
<li>Distance to rocky outcrops</li>
</ul></td>
<td><ul>
<li>ArcMap, with the creation of a shapefile and drawing polygons against the satellite images for Spain (Plan Nacional de Ortofotografía Aérea (PNOA) <a href="https://pnoa.ign.es/)" class="uri">https://pnoa.ign.es/)</a> - and Portugal (Direção Geral do Território - DGT, Ortofotos 25cm – Portugal Continental - 2018)</li>
</ul></td>
</tr>
</tbody>
</table>
<p>This variable required a bit more elaboration, as currently there is not any vector cartography that we can use. The raster geological maps available from the Spanish and Portuguese Geographic National Institutes were too general to be used. Thus, the creation of the variable implied a vectorization of all the rocky outcrops visible in aerial imaging though a Web Map Service. Again, <em>r.grow.distance</em> was applied to determine the distance between the rocky outcrops and the rest of the terrain.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 89%">
</colgroup>
<tbody>
<tr class="odd">
<td>Topographic prominence</td>
<td>A TPI Based Landform Classification from SAGA GIS (based on Conrad, 2011, 2016) was first applied to measure slope positions and automate the landform classifications, with a small scale of 500 and large scale of 1,000</td>
</tr>
</tbody>
</table>
<p>It follows the assumption that the topography of the terrain where the monuments were built is of a major influence. One of the algorithms widely used for this purpose is usually the <em>Topographic Position Index</em> (TPI) from <em>SAGA GIS</em> (e.g.&nbsp;Bustelo Abuín et al.&nbsp;2017), which takes into consideration the relative topographic prominence of a feature in the landscape at different scales and integrates it into a single grid. As the output is highly dependable on scales (Weiss, 2001), the characteristic of the landscape needs to be considered not only counting the landscape under analysis, but also the objectives under scrutiny. So, we must model this variable considering this landscape’s characteristics, which in this case is mainly constituted by open slopes and plains.</p>
<p>As different landscapes have different geomorphological features, some digital models should be generated in accordance with said features. This is particularly true for this variable that considers topographic prominence, as it is scale dependent. Thus, we used the Multiresolution Index of Valley Bottom Flatness (MRVBF) and the complementary Multiresolution Index of the Ridge Top Flatness (MRRTF) to define valley bottoms as areas which were flat and low relative to their surroundings (Gallant &amp; Dowling, 2003: 9). As both open slopes and plains are characterized by flat terrain and low to gradual slope angles, we determined a value of 18 for the <em>Initial Threshold for Slope</em>, a <em>Shape Parameter of Slope</em> of 2, and a <em>Shape Parameter for Elevation Percentile</em> of 1, leaving the remaining parameters with their default setting. Then, the determination of the surface and flat areas was determined by the initial threshold: the higher the value, the flatter the surface.</p>
<p>We include some of the modelled covariates in the <strong>figure 3</strong>.</p>
<div class="cell">
<div class="code-with-filename">
<details class="code-fold">
<summary>Code</summary>
<div class="code-with-filename-file">
<pre><strong>Figure 3.R</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the directory path (modify according to your directory)</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>dir_path <span class="ot">&lt;-</span> <span class="st">"/Users/miguelpazoscarrero/Desktop/Laboreiro/grid/"</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Load rasters</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>rast_A <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="fu">paste0</span>(dir_path, <span class="st">"cum_viewshed.tif"</span>))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>rast_B <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="fu">paste0</span>(dir_path, <span class="st">"dist_to_ridges.tif"</span>))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>rast_C <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="fu">paste0</span>(dir_path, <span class="st">"cum_horizon.tif"</span>))</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>rast_D <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="fu">paste0</span>(dir_path, <span class="st">"dist_to_wat_edges.tif"</span>))</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a custom palette for plot C (Cumulative horizon)</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>create_transparent_palette <span class="ot">&lt;-</span> <span class="cf">function</span>(colors, alpha_values) {</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  rgb_values <span class="ot">&lt;-</span> <span class="fu">col2rgb</span>(colors) <span class="sc">/</span> <span class="dv">255</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(rgb_values, <span class="dv">2</span>, <span class="cf">function</span>(col) {</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rgb</span>(col[<span class="dv">1</span>], col[<span class="dv">2</span>], col[<span class="dv">3</span>], <span class="at">alpha =</span> alpha_values)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a terrain-like color palette with transparency</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>n_colors <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>terrain_colors <span class="ot">&lt;-</span> <span class="fu">terrain.colors</span>(n_colors)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>alpha_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="at">length.out =</span> n_colors)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>transparent_palette <span class="ot">&lt;-</span> <span class="fu">create_transparent_palette</span>(terrain_colors, </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>                                                  alpha_values)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 2x2 plotting layout</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rast_A, <span class="at">main =</span> <span class="st">"A - Cumulative Viewshed"</span>, </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">magma</span>(<span class="dv">100</span>))</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rast_B, <span class="at">main =</span> <span class="st">"B - Distance to Ridges"</span>, </span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">terrain.colors</span>(<span class="dv">100</span>))</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rast_C, <span class="at">main =</span> <span class="st">"C - Cumulative Horizon"</span>, </span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> transparent_palette)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rast_D, <span class="at">main =</span> <span class="st">"D - Distance to Water"</span>, </span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> blues9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="quarto_project_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 3. Some of the variables modelled in a GIS environment for this work.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="descriptive-approaches-to-the-distribution-of-sites" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-approaches-to-the-distribution-of-sites"><strong>3. Descriptive approaches to the distribution of sites</strong></h2>
<p>The study of barrow landscapes considers looking into patterns that could refer to similarities in the dimensions of the mound and/or chamber, existence/absence of corridor, type(s) of material culture or presence/absence of remains, or even megalithic art. These similarities could be then compared between 1) the geomorphological and topographical features, and 2) the characteristics of the structure’s implantation in the terrain – both at a macro and micro scale<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. But of course, this can only be done when we have access to data referring the structures themselves, and their respective material cultural, stratigraphy, and not just their spatial context.</p>
<p>On the existence of a pattern, we could be dealing with a certain type of human group or observing a certain behaviour that could, in turn, be chronologically (or even socially) narrowed. Cases where this can be done are not so common (see, for example, Esquivel et al., 2021, 2025, stressing the tumular landscape alongside the Gor River, Granada), as one would need a landscape fully excavated, without the general absence in artefactual evidence, as well as chronometric data.</p>
<p>Another important constriction is that we lack knowledge on some factors of social and cultural order in prehistoric times (especially when we confront the data for 5<sup>th</sup> and/or 4<sup>th</sup> millennium with the data for the 3<sup>rd</sup> and end of 2<sup>nd</sup> millennium), such as demographic growth, territorial disposition, and organization, etc. So, it becomes even more difficult when we try to conduct a study based solely on a point distribution.</p>
<p>It becomes important to clearly define what we can observe from it considering these unknowns – which, in the context of the present text, has to start and end strictly with a spatial and very much digital and bibliographical approach.</p>
<p>As an example on how some obstacles can be accounted for, let´s, for instance, consider Tobler’s First Law of Geography which states that nearby elements tend to have stronger relationships than those farther apart. In terms of this paper’s main objective – long-term human-landscape behaviour through the analysis of a non-random, clustered distribution of points - this means we can analyse it from two perspectives (and similarly to how G. Čučković forwarded it (Čučković 2024: 234, table 15.1.)):</p>
<ol type="1">
<li><p>On a large scale, that is, looking at how natural landscape features influence human movement within an environment.</p></li>
<li><p>On a small scale, that is, observing how individual monuments, our points, interact with each other.</p></li>
</ol>
<p>Essentially, this allows us to move from broad spatial relationships to more localized ones. These reflect two levels of influence considering we’re essentially dealing with human behaviour strictly from a spatial point of view: the landscape, while perceived and shaped by humans, is also subjecting humans to its geomorphological constraints, so there will always be a limit to how we can use a territory. Consequently, there’s a limit on how we can quantify these several strategies implemented by people over the long diachrony.</p>
<p>Several approaches can be used to quantify these relations, such as Moran’s I Method, or the application of nonparametric estimations (<em>rho-hat</em> function, see Kempf, Günther, 2022). In this case we will opt for the widely used comparative approach between the site locations and a sample of the background terrain, based on multiple Monte Carlo Simulations, with the implementation of a Mann-Whitney test to formally test whether the site locations were likely a random sample of locations drawn from the study area or not (see Connolly, Lake 2006; Bevan et al.&nbsp;2013; Bevan, 2020). This can be done in <em>R Statistics</em> by using the <em>rbias</em> package (Kempf, Günther, 2022), with implementations from K. Bocinsky (2017), by calculating and graphing a Monte Carlo sub-sampled kernel density estimates for random locations over which we can include the sites specific trends (<strong>Figure 4</strong>).</p>
<div class="cell">
<div class="code-with-filename">
<details class="code-fold">
<summary>Code</summary>
<div class="code-with-filename-file">
<pre><strong>Figure 4.R</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>spatpack <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sf"</span>, <span class="st">"terra"</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"spatstat"</span>, <span class="st">"plotly"</span>, </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">"foreach"</span>, <span class="st">"dplyr"</span>, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">"progress"</span>, <span class="st">"purrr"</span>, </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">"reshape2"</span>, <span class="st">"broom"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(spatpack, require, <span class="at">character.only=</span><span class="cn">TRUE</span>))</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Define working directories</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"grid"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>shp <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"shp"</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the coordinate reference system (CRS)</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>crs <span class="ot">&lt;-</span> <span class="st">"+proj=utm +zone=29 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Read sites and study area</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">invisible</span>(<span class="fu">suppressMessages</span>(<span class="fu">st_read</span>(<span class="fu">file.path</span>(shp_path, <span class="st">"sites_lab.shp"</span>), <span class="at">quiet =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="dv">4326</span>)))</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Read covariates using terra</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>dem <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">"grid/dtm.tif"</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>slope <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">"grid/slope.tif"</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>cum_horizon <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">"grid/cum_horizon.tif"</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>cum_viewshed <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">"grid/cum_viewshed.tif"</span>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>dist_to_ridges <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">"grid/dist_to_ridges.tif"</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>dist_to_rocks <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">"grid/dist_to_rocks.tif"</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>dist_to_watedges <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">"grid/dist_to_wat_edges.tif"</span>)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>tpi <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">"grid/tpi.tif"</span>)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Part 1: Calculate and plot kernel density estimates with Monte Carlo subsampling</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare the sites with the covariates</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">'r_functions/rbias_sitesVSbackground.R'</span>)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">'r_functions/rbias_simulationresults.R'</span>)</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function to iterate the simulation process</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>perform_simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(covariate, covariate_name) {</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>  simulation_result <span class="ot">&lt;-</span> <span class="fu">sites_vs_background</span>(<span class="at">covariate =</span> covariate,</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">sites =</span> sites,</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">nsim =</span> <span class="dv">999</span>,</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">covariate_name =</span> covariate_name)</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(simulation_result)</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a list of covariates and their corresponding names</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>covariates <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">dem =</span> <span class="st">"Altitude mASL"</span>, </span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">slope =</span> <span class="st">"Slope %"</span>,</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">cum_viewshed =</span> <span class="st">"Cumulative Viewshed"</span>,</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">dist_to_ridges =</span> <span class="st">"Distance to Ridges"</span>,</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">dist_to_watedges =</span> <span class="st">"Distance to Water Edges"</span>,</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">tpi =</span> <span class="st">"Topographic Position Index (TPI)"</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the simulation function to each covariate</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>simulation_results <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">names</span>(covariates), </span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>                             <span class="cf">function</span>(covariate) {</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">perform_simulation</span>(<span class="fu">get</span>(covariate), </span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>                     covariates[[covariate]])</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(simulation_results)) {</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>  simulation_result <span class="ot">&lt;-</span> simulation_results[[i]]</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(simulation_result)) {</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the plot using simulation_results_plot()</span></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">simulation_results_plot</span>(simulation_result, <span class="at">show_title =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="quarto_project_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 4. Site trends versus the terrain background. The solid line in the graphs represents the sites; The dashed line corresponds to the median of the random points; The shaded area is the confidence intervals (5%, 95%) based upon 999 Monte Carlo Simulations placed over the study area (based on Kempf, Günther, 2022; Bocinsky, 2017).</figcaption>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Part 2 Compute two-sample Wilcoxon tests (Mann-Whitney U tests)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate random background samples for each covariate</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>random_samples <span class="ot">&lt;-</span> <span class="fu">lapply</span>(simulation_results, <span class="cf">function</span>(simulation_result) {</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(simulation_result)) <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  ras_samples <span class="ot">&lt;-</span> simulation_result<span class="sc">$</span>ras_samples</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(ras_samples, <span class="cf">function</span>(ras_sample) {</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(ras_sample, </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">length</span>(simulation_result<span class="sc">$</span>sites_densities<span class="sc">$</span>Covariate), </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a progress bar</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>pb <span class="ot">&lt;-</span> progress_bar<span class="sc">$</span><span class="fu">new</span>(<span class="at">total =</span> <span class="fu">length</span>(simulation_results), </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">format =</span> <span class="st">"[:bar] :percent :eta"</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Wilcoxon test for each covariate</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>wilcoxon_results <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(simulation_results), <span class="cf">function</span>(i) {</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  simulation_result <span class="ot">&lt;-</span> simulation_results[[i]]</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  background_samples <span class="ot">&lt;-</span> random_samples[[i]]</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(simulation_result) <span class="sc">||</span> <span class="fu">is.null</span>(background_samples)) {</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update progress bar</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>  pb<span class="sc">$</span><span class="fu">tick</span>()</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform Wilcoxon test for each background sample</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>  wilcoxon_test_results <span class="ot">&lt;-</span> <span class="fu">lapply</span>(background_samples, <span class="cf">function</span>(background_sample) {</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(background_sample) <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">||</span> </span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">length</span>(simulation_result<span class="sc">$</span>sites_densities<span class="sc">$</span>Covariate) <span class="sc">&lt;</span> <span class="dv">2</span>) {</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">statistic =</span> <span class="cn">NA</span>, <span class="at">p.value =</span> <span class="cn">NA</span>))</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(simulation_result<span class="sc">$</span>sites_densities<span class="sc">$</span>Covariate, </span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>                          background_sample, </span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>                          <span class="at">alternative =</span> <span class="st">"greater"</span>, </span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>                          <span class="at">exact =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    broom<span class="sc">::</span><span class="fu">tidy</span>(result) <span class="sc">%&gt;%</span> <span class="fu">select</span>(statistic, p.value)</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the results</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>  wilcoxon_test_results <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(wilcoxon_test_results)</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the median test statistic and 95% confidence interval</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>  wilcoxon_summary <span class="ot">&lt;-</span> foreach<span class="sc">::</span><span class="fu">foreach</span>(<span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span>), <span class="at">.combine =</span> rbind) <span class="sc">%do%</span> {</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>    wilcoxon_test_results <span class="sc">%&gt;%</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">summarise_all</span>(quantile, <span class="at">probs =</span> prob)</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>  } <span class="sc">%&gt;%</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>    magrittr<span class="sc">::</span><span class="fu">set_colnames</span>(<span class="fu">c</span>(<span class="st">"Lower CI"</span>, <span class="st">"Median"</span>, <span class="st">"Upper CI"</span>))</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame for the covariate and add covariate_name</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>  covariate_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">covariate =</span> <span class="fu">names</span>(covariates)[i])</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>  wilcoxon_summary <span class="ot">&lt;-</span> <span class="fu">cbind</span>(covariate_summary, wilcoxon_summary)</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(wilcoxon_summary)</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the results for all covariates</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>wilcoxon_results <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, wilcoxon_results)</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>wilcoxon_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  covariate     Lower CI       Median     Upper CI
statistic               dem 6.618283e+05 1.212201e+06 1.212201e+06
p.value                 dem 0.000000e+00 0.000000e+00 2.112362e-01
statistic1            slope 6.315913e+05 7.916150e+05 8.827785e+05
p.value1              slope 2.892370e-55 1.096042e-21 1.288998e-01
statistic2     cum_viewshed 6.333180e+05 1.212201e+06 1.212201e+06
p.value2       cum_viewshed 0.000000e+00 0.000000e+00 8.388789e-01
statistic3   dist_to_ridges 6.503479e+05 1.207892e+06 1.209204e+06
p.value3     dist_to_ridges 0.000000e+00 0.000000e+00 4.852560e-01
statistic4 dist_to_watedges 6.585931e+05 1.210482e+06 1.210758e+06
p.value4   dist_to_watedges 0.000000e+00 0.000000e+00 2.790192e-01
statistic5              tpi 3.148769e+05 5.473035e+05 6.120632e+05
p.value5                tpi 3.460408e-01 7.964273e-01 1.000000e+00</code></pre>
</div>
</div>
<p>The Mann-Whitney test, commonly referred to as Wilcoxon rank-sum test, is a non-parametric test used to observe and compare two independent groups, assessing if there is or not a statistically significant difference between the distribution of a variable in said independent groups. In this case, this translates to whether there is a statistically significant difference between the points distribution – the tumular structures – and the geomorphological constraints that were modelled, tested against a set of randomly generated points alongside the study area via 999 Monte Carlo simulations (Conolly &amp; Lake, 2006: 127; Kvamme, 2020: 218; Günther, et al.&nbsp;2022; Bocinsky, 2017).</p>
<p>The usefulness in using this method relies on the fact that it is not dependent on previous assumptions about the underlying data distribution. Our chosen confidence level was defined at 95%, with a <em>p</em>-value below 0.05. A value under that threshold represents a statistically significant difference between the real sample and random sample. We also include the U Statistic, a confidence interval which allows us to quantify the difference in ranks between the archaeological sample and a random one, that mean in our case, the ranks of the covariate values at site locations versus those at random background locations. The results are provided in the supplementary material (under csv folder).</p>
<p>We can forward that, of all the 8 variables that were modelled – Altitude, Slope, Cumulative Horizon, Cumulative viewshed, Distance to Ridges, Distance to Water Edges, Distance to Rock Outcrops, Topographic Prominence – only Altitude seems to possess a considerate level of significance for Laboreiro’s distribution.</p>
</section>
<section id="laboreiros-spatial-structure-based-on-the-monuments" class="level2">
<h2 class="anchored" data-anchor-id="laboreiros-spatial-structure-based-on-the-monuments"><strong>4. Laboreiro’s spatial structure based on the monuments</strong></h2>
<p>We’ve established that these points — whether in clusters or isolated — might be representing distinct (social)landscapes at different times. But, by analysing them together with these digital methods we end up merging different landscapes into one, and we overlook the true diversity and dynamism of this territory. Our main challenge, then, becomes: how do we account for the fact that these methods and tests inherently treat a landscape that has evolved over time as if it were static and unchanging?</p>
<p>So, it comes with no surprise that, at least one variable – altitude – stands out as the most important one statistically. This can be translated to “altitude prevailed as a variable of transversal importance for many centuries in association with this phenomenon”.</p>
<p>The glimpses of other human choices lie in the other slightly less statistically relevant variables, perhaps precisely in response to the already established relation with altitude and mountain environments and the many adaptations said relations took throughout the centuries.</p>
<p>It is important to separate the two: what the statistical results say in opposition to what it means in terms of human interpretation of the terrain. And here lies the basis in understanding Laboreiro’s true spatial structure. So, even though the variable representing altitude was revealed to be the most important one, there are, indeed, points of significance denoted by the variables of cumulative horizon, distance to ridges, rock outcrops and watershed edges, and these appear to be the ones showcasing the main spatial tendency and/or the main geomorphological features these several people had to <em>play</em> and compromise with.</p>
<p>The placement of these monuments was a choice as cultural, social, or symbolic, in as much it was a response to geomorphological constraints, which ultimately shaped the way the landscape was socially constructed – a truly quasi-symbiotic relation with space and natural shapes.</p>
<p>So, with the altitude variable, we are observing a concentration of monuments that were implanted from 800mASL up until 1200mASL, thence, this is the variable that defines the pattern within these heights <em>for the totality of the study area initially proposed</em>. But we can also see that there’s also a significant mark between the 400-600mASL.</p>
<p>Visibility will also always remain an important and unavoidable aspect when crossing any territory. The results of those two variables (Cumulative Viewshed and Horizon) might not have been as promising as expected due to this high level of structural heterogeneity that couldn’t be modelled (out of lack of formal data). So, if the altitude is being deemed as the main feature for this distribution, it becomes understandable why the horizon and the ridges are diverting some attention as well. Lines in the horizon will always be visible elements, and they can articulate how a territory can be perceived, manipulated and managed (and even how to socially and culturally limit it). The same goes for drainage divides or even the distance to sources of raw materials.</p>
<p>In terms of point distribution — specifically the placement of monuments — it is reasonable to assume that some monuments, perhaps the earliest ones, played a defining role in shaping how the landscape was later organized. These initial structures may have influenced and constrained how subsequent communities engaged with the territory, whether by reinforcing existing spatial patterns or deliberately rejecting them. In this way, monument placement not only reflected but also actively shaped the way people perceived, used, and interacted with the landscape over time.</p>
<p>And we started noticing that only a portion of the chosen study area, and only a portion of those 178 points is truly demarcating these aspects. We tested this hypothesis by conducting a simple test considering the entirety of the study area and all the points against the Cumulative Horizon raster variable (<strong>Fig. 5</strong>), by using a simple Intervisibility Network Analysis in QGIS v. 3.28 (see Čučković, 2024: 230-247).</p>
<div class="cell">
<div class="code-with-filename">
<details class="code-fold">
<summary>Code</summary>
<div class="code-with-filename-file">
<pre><strong>Figure 5.R</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>spatpack<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"terra"</span>,<span class="st">"viridis"</span>, <span class="st">"sf"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(spatpack, require, <span class="at">character.only=</span><span class="cn">TRUE</span>))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set working directory</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"~/Desktop/Laboreiro/"</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>shp_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"shp"</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Load rasters</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>rast <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="fu">paste0</span>(<span class="st">"/Users/miguelpazoscarrero/Desktop/Laboreiro/grid/"</span>,<span class="st">"cum_horizon.tif"</span>))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Load shapefiles</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>sites_lab <span class="ot">&lt;-</span> <span class="fu">invisible</span>(<span class="fu">suppressMessages</span>(<span class="fu">st_read</span>(<span class="fu">file.path</span>(shp_path, <span class="st">"sites_lab.shp"</span>), <span class="at">quiet =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>sites_all <span class="ot">&lt;-</span><span class="fu">invisible</span>(<span class="fu">suppressMessages</span>(<span class="fu">st_read</span>(<span class="fu">file.path</span>(shp_path, <span class="st">"sites_all.shp"</span>), <span class="at">quiet =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>intervisibility <span class="ot">&lt;-</span> <span class="fu">invisible</span>(<span class="fu">suppressMessages</span>(<span class="fu">st_read</span>(<span class="st">"/Users/miguelpazoscarrero/Desktop/Laboreiro/shp/intervisibility_sites.shp"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a terrain-like color palette with transparency</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>create_transparent_palette <span class="ot">&lt;-</span> <span class="cf">function</span>(colors, alpha_values) {</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  rgb_values <span class="ot">&lt;-</span> <span class="fu">col2rgb</span>(colors) <span class="sc">/</span> <span class="dv">255</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(rgb_values, <span class="dv">2</span>, <span class="cf">function</span>(col) {</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rgb</span>(col[<span class="dv">1</span>], col[<span class="dv">2</span>], col[<span class="dv">3</span>], <span class="at">alpha =</span> alpha_values)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>n_colors <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>terrain_colors <span class="ot">&lt;-</span> <span class="fu">terrain.colors</span>(n_colors)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>alpha_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="at">length.out =</span> n_colors)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>transparent_palette <span class="ot">&lt;-</span> <span class="fu">create_transparent_palette</span>(terrain_colors, alpha_values)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot figure 5      </span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rast, <span class="at">main =</span> <span class="st">"A"</span>, </span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> transparent_palette)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(intervisibility<span class="sc">$</span>geometry, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="fl">0.3</span>)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sites_lab<span class="sc">$</span>geometry, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rast, <span class="at">main =</span> <span class="st">"B"</span>, </span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> transparent_palette)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sites_all<span class="sc">$</span>geometry, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="quarto_project_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 5. Visual networks over the mounds in Laboreiro region, now with 138 points (A), created with the visibility analysis plugin from QGIS (Čučković, 2016), and our hypothesis on this being the main geomorphological spatial constraint for the tumular landscape of Laboreiro (B).</figcaption>
</figure>
</div>
</div>
</div>
<p>This was an exercise to try and determine or directly observe if there is a network structure based on visibility form the monuments’ implantation. In Figure 5A, we noticed the existence of areas almost devoid of visibility relations, or, at least, with very specific and/or more local ones – perhaps the ones that might be causing discrepancies in our statistical analysis. This made us reduce our area of analysis to one that would better help us understand the previously stated hypothesis (Figure 5B): <em>there are monuments that ended up dictating how this landscape could be arranged considering the main geomorphological features and how people might’ve committed with them.</em></p>
<p>From a direct observation perspective, we can see that the monuments tend to align with key landscape features highlighted by the Cumulative Horizon raster variable. At the same time, a distinct portion of the landscape stands out due to the clustering of monuments, suggesting an emphasis on a specific territorial organization. Out of the initial 178 points, we refined our sample to 138 monuments that appear to strongly represent the primary territorial layout of Laboreiro (Fig. 5a).<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<p>What this could entail is that the megalithic sites are not creating a visual network of the landscape, but demarcating one that already existed, only now materialized with these constructions as social markers of the living territories.</p>
<p>In the end, these variables end up determining the main perceived shapes of a given territory – from lines on the horizon, to true physical landmarks against them.</p>
<p>To formally address this idea, we can use a logistic regression approach combined with the creation of three spatial point process models which allow us to deeply understand the characteristics of the spatial distribution of the mounds (see Carrero-Pazos, Bevan &amp; Lake 2019 for the original approach we are using here).</p>
<p>The logistic regression map was built using the selected covariates in this research (elevation, cumulative horizon, slope and a raster variable resulting from the sum of precisely those&nbsp; main geomorphological features: rock outcrops, ridges and watershed edges), allowing us to understand to what extent the selected environmental variables are influencing the placement of the mounds (<strong>Figure 6b</strong>), and what could be the relation of the 138 sites between themselves (<strong>Figure 6c</strong>). All those analyses were built in <em>R Statistics</em> using the <em>Spatstat</em> package (Baddeley et al.&nbsp;2016).</p>
<div class="cell">
<div class="code-with-filename">
<details class="code-fold">
<summary>Code</summary>
<div class="code-with-filename-file">
<pre><strong>Figure 6.R</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load R Packages</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>spatpack<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"raster"</span>,<span class="st">"spatstat"</span>, <span class="st">"sp"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(spatpack, require, <span class="at">character.only=</span><span class="cn">TRUE</span>))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load raster covariates</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>elevation <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">"grid/dtm.tif"</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>cumulative_horizon <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">"grid/cum_horizon.tif"</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>geomorph <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">"grid/sum_structure.tif"</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>slope <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">"grid/slope.tif"</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>cumulative_viewshed <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">"grid/cum_viewshed.tif"</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Load sites</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">invisible</span>(<span class="fu">suppressMessages</span>(<span class="fu">st_read</span>(<span class="fu">file.path</span>(shp_path, <span class="st">"sites_lab.shp"</span>), <span class="at">quiet =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="dv">4326</span>)))</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create spatial point pattern process</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>study_area <span class="ot">&lt;-</span> <span class="fu">invisible</span>(<span class="fu">suppressMessages</span>(<span class="fu">st_read</span>(<span class="fu">file.path</span>(shp_path, <span class="st">"mask.shp"</span>), <span class="at">quiet =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>area <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(study_area)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>sppp <span class="ot">&lt;-</span> <span class="fu">ppp</span>(<span class="at">x=</span>sites<span class="sc">$</span>X, <span class="at">y=</span>sites<span class="sc">$</span>Y, <span class="at">window=</span>area)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert raster to image</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Elevation</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Get the matrix of values from the raster</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>elev_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(elevation)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Get the coordinates for the raster, ensuring they match the matrix dimensions</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>x_coords_elev <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">xmin</span>(elevation), <span class="fu">xmax</span>(elevation), <span class="at">length.out =</span> <span class="fu">ncol</span>(elev_matrix))</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>y_coords_elev <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">ymin</span>(elevation), <span class="fu">ymax</span>(elevation), <span class="at">length.out =</span> <span class="fu">nrow</span>(elev_matrix))</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Create the im object using the matrix and coordinates</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>elev_im <span class="ot">&lt;-</span> spatstat.geom<span class="sc">::</span><span class="fu">as.im</span>(<span class="at">X =</span> elev_matrix, <span class="at">xcol =</span> x_coords_elev, <span class="at">yrow =</span> y_coords_elev)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Cumulative Horizon</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Get the matrix of values from the raster</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>horizon_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(cumulative_horizon)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Get the coordinates for the raster, ensuring they match the matrix dimensions</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>x_coords_hrz <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">xmin</span>(cumulative_horizon), <span class="fu">xmax</span>(cumulative_horizon), <span class="at">length.out =</span> <span class="fu">ncol</span>(horizon_matrix))</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>y_coords_hrz <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">ymin</span>(cumulative_horizon), <span class="fu">ymax</span>(cumulative_horizon), <span class="at">length.out =</span> <span class="fu">nrow</span>(horizon_matrix))</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="do">## Create the im object using the matrix and coordinates</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>horizon_im <span class="ot">&lt;-</span> spatstat.geom<span class="sc">::</span><span class="fu">as.im</span>(<span class="at">X =</span> horizon_matrix, <span class="at">xcol =</span> x_coords_hrz, <span class="at">yrow =</span> y_coords_hrz)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Geomorphons (sum)</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Get the matrix of values from the raster</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>geomorph_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(geomorph)</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="do">## Get the coordinates for the raster, ensuring they match the matrix dimensions</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>x_coords_gmph <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">xmin</span>(geomorph), <span class="fu">xmax</span>(geomorph), <span class="at">length.out =</span> <span class="fu">ncol</span>(geomorph_matrix))</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>y_coords_gmph <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">ymin</span>(geomorph), <span class="fu">ymax</span>(geomorph), <span class="at">length.out =</span> <span class="fu">nrow</span>(geomorph_matrix))</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="do">## Create the im object using the matrix and coordinates</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>geomorph_im <span class="ot">&lt;-</span> spatstat.geom<span class="sc">::</span><span class="fu">as.im</span>(<span class="at">X =</span> geomorph_matrix, <span class="at">xcol =</span> x_coords_gmph, <span class="at">yrow =</span> y_coords_gmph)</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Slope</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a><span class="do">## Get the matrix of values from the raster</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>slope_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(slope)</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="do">## Get the coordinates for the raster, ensuring they match the matrix dimensions</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>x_coords_slp <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">xmin</span>(slope), <span class="fu">xmax</span>(slope), <span class="at">length.out =</span> <span class="fu">ncol</span>(slope_matrix))</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>y_coords_slp <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">ymin</span>(slope), <span class="fu">ymax</span>(slope), <span class="at">length.out =</span> <span class="fu">nrow</span>(slope_matrix))</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a><span class="do">## Create the im object using the matrix and coordinates</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>slope_im <span class="ot">&lt;-</span> spatstat.geom<span class="sc">::</span><span class="fu">as.im</span>(<span class="at">X =</span> slope_matrix, <span class="at">xcol =</span> x_coords_slp, <span class="at">yrow =</span> y_coords_slp)</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Cumulative viewshed</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="do">## Get the matrix of values from the raster</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>cum_view_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(cumulative_viewshed)</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a><span class="do">## Get the coordinates for the raster, ensuring they match the matrix dimensions</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>x_coords_cview <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">xmin</span>(cumulative_viewshed), <span class="fu">xmax</span>(cumulative_viewshed), <span class="at">length.out =</span> <span class="fu">ncol</span>(cum_view_matrix))</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>y_coords_cview <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">ymin</span>(cumulative_viewshed), <span class="fu">ymax</span>(cumulative_viewshed), <span class="at">length.out =</span> <span class="fu">nrow</span>(cum_view_matrix))</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a><span class="do">## Create the im object using the matrix and coordinates</span></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>cumview_im <span class="ot">&lt;-</span> spatstat.geom<span class="sc">::</span><span class="fu">as.im</span>(<span class="at">X =</span> cum_view_matrix, <span class="at">xcol =</span> x_coords_cview, <span class="at">yrow =</span> y_coords_cview)</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Point Process Model to Data</span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>covlist <span class="ot">&lt;-</span> <span class="fu">list</span>(elev_im, horizon_im, geomorph_im, slope_im)</span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(covlist) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"elev_im"</span>, <span class="st">"horizon_im"</span>, <span class="st">"geomorph_im"</span>, <span class="st">"slope_im"</span>)</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>fotrend <span class="ot">&lt;-</span> <span class="er">~</span> elev_im <span class="sc">+</span> horizon_im <span class="sc">+</span> geomorph_im <span class="sc">+</span> slope_im</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">step</span>(<span class="fu">ppm</span>(sppp, </span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trend=</span>fotrend, </span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>                 <span class="at">interaction=</span><span class="cn">NULL</span>, </span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>                 <span class="at">covariates=</span>covlist, </span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method=</span><span class="st">"logi"</span>),</span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>             <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=4018.92
~elev_im + horizon_im + geomorph_im + slope_im

              Df    AIC
- geomorph_im  1 4014.2
- horizon_im   1 4018.8
&lt;none&gt;           4018.9
- slope_im     1 4022.9
- elev_im      1 4070.5

Step:  AIC=4020.89
~elev_im + horizon_im + slope_im</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a logistic regression surface</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>logodds <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">22.3439702866</span><span class="sc">+</span>(elev_im<span class="sc">*</span><span class="fl">6.897505e-03</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Point process models</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>numSims <span class="ot">&lt;-</span> <span class="dv">999</span> <span class="co"># Define the number of Monte Carlo Simulations to run</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># A. Null model</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>mod0 <span class="ot">&lt;-</span> <span class="fu">ppm</span>(sppp, <span class="sc">~</span><span class="dv">1</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>Pcfinhom_mod0 <span class="ot">&lt;-</span> <span class="fu">envelope</span>(mod0, </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fun=</span>pcfinhom, </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">correction=</span><span class="st">"best"</span>, </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">nsim=</span>numSims,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># B. First order interaction (using the covariates)</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>Pcfinhom_mod1 <span class="ot">&lt;-</span> <span class="fu">envelope</span>(mod1, </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fun=</span>pcfinhom, </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>                          <span class="at">correction=</span><span class="st">"best"</span>, </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">nsim=</span>numSims,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>                          <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co"># C. Second order interaction (using the covariates and creating an area of interaction between points)</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">step</span>(<span class="fu">ppm</span>(sppp, <span class="at">trend =</span> fotrend, </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">interaction =</span> <span class="fu">AreaInter</span>(<span class="dv">150</span>), </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">covariates =</span> covlist, </span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"logi"</span>),</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">trace =</span> <span class="dv">0</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>Pcfinhom_mod2 <span class="ot">&lt;-</span> <span class="fu">envelope</span>(mod2, </span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fun=</span>pcfinhom, </span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>                          <span class="at">correction=</span><span class="st">"best"</span>, </span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">nsim=</span>numSims,</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>                          <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot figure</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up a 2x2 plotting layout</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Logistic Regression Map</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(logodds, </span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Logistic Regression Map"</span>)</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sites<span class="sc">$</span>geometry, <span class="at">add=</span>T, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">cex=</span> <span class="dv">1</span>)</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Random model</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Pcfinhom_mod0, </span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2000</span>), </span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>), </span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>     <span class="at">legend =</span> <span class="cn">FALSE</span>, </span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"a. Random model"</span>, </span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Distance in metres"</span>)</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, </span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Megalithic sites"</span>, <span class="st">"CSR"</span>, <span class="st">"999 random simulations"</span>),</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"grey"</span>),</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>), </span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>), </span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>, </span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 3: First-order model</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Pcfinhom_mod1, </span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2000</span>), </span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>), </span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>     <span class="at">legend =</span> <span class="cn">FALSE</span>, </span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"b. First-order model"</span>, </span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Distance in metres"</span>)</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, </span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Megalithic sites"</span>, <span class="st">"CSR"</span>, <span class="st">"999 random simulations"</span>),</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"grey"</span>),</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>), </span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>), </span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>, </span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 4: Second-order model</span></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Pcfinhom_mod2, </span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2000</span>), </span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>), </span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>     <span class="at">legend =</span> <span class="cn">FALSE</span>, </span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"c. Second-order model</span><span class="sc">\n</span><span class="st">(AreaInter = 150)"</span>, </span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Distance in metres"</span>)</span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, </span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Megalithic sites"</span>, <span class="st">"CSR"</span>, <span class="st">"999 random simulations"</span>),</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"grey"</span>),</span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>), </span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>), </span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>, </span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="quarto_project_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 6. Spatial statistical models to understand the role between the mounds and their surrounding environment. a) purely random model; b) 999 random simulations based on the covariates -first-order surface-; c) 999 random simulations based on the first-order surface and an area interaction model for each point.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results"><strong>5. Results</strong></h2>
<p>Of all the variables that were modelled – Altitude, Slope, Cumulative Horizon, Cumulative viewshed, Distance to Ridges, Distance to Water Edges, Distance to Rock Outcrops, Topographic Prominence – the covariates with significant median p-values are the Altitude, Slope, Cumulative horizon and Cumulative viewshed, indicating that these environmental variables are likely important in determining the site locations. Other covariates, such as the Topographic Prominence Index contains non-significant median p-values, suggesting that this variable might not be playing a strong role on the influence of site locations. This is complemented by the U-statistic (~551,263 (median)) with a p-value of 0.62, suggesting that there is not a significance difference in TPI values between site and background locations.</p>
<p>A cross reading from the results indicate that sites are likely located at higher altitudes than expected by chance, and on specific slopes compared to the surrounding landscape. This might relate with other factors, such as the proximity to water sources, or the visibility. The latter could be the case, as the analysis of the cumulative horizon and the cumulative viewshed indicates that the sites might have been intentionally placed in areas with specific viewsheds or horizon properties. The high visibility may have been a key factor in the placing of the megalithic sites, likely for communication, controlling of the surrounding landscape or a symbolic dominance, perhaps even a preexisting one.</p>
<p>The distance to watershed edges approaches the threshold of significance. This suggests that watersheds played a role in the site placement, maybe at a general scale, but its importance might vary across the study area. Taking that this variable was modelled to consider the travel cost from slope, this could mean that there’s a significant portion of this landscape that allows for travel between monuments without encountering relevant obstacles – we emphasize yet again that portion might be represented by those 138 points. This could imply that, in terms of both monument implantation, and movement across this landscape, it may be that the main travel/access points are influenced by the territory’s topography. However, this can be interpreted as tacit knowledge - <em>i. e.,</em> visibility, access to water and natural pathways for circulation remain important to access a territory and remain important features of influence for, say, a settlement of any kind.</p>
<p>Although only one variable can truly capture the overall influence of geomorphological constraints on these communities’ reactions towards this landscape, the analysis suggests that local features of the terrain, such as topography, seem to have a stronger influence on the specific locations chosen.</p>
<p>Some things started to become clearer, and even though the results are promising, they rely on a certain level of inconsistency precisely representing the fact that the distribution rests on the aspect that these landscapes have a diachronic background, with distinct uses. We could even forward the debated “<em>satellitization</em>”, meaning newer monuments being built next to old ones – acting as “satellites” (Carvalho &amp; Carvalho, 2018: 46; Carrero-Pazos et al.&nbsp;2019), something partly visible in the statistical models created in figure 6.</p>
<p>We discussed in the beginning how ambitious it can become to not only access the life <em>tempo</em> of these monuments - individually - but how challenging it is to truly study a landscape that was constructed and deconstructed over centuries. Hence the main critics behind the use of digital tools: they cannot truly access the diachronic aspects of these landscapes.</p>
<p>So, what are we to do? Should we consider the totality of the sample with the initial 178 points and deal with Laboreiro as a territorial unity for the sake of statistical analysis and variable refinement, being Altitude more than enough to explain this distribution? Or do we find ourselves in the position of defending that the sample with 138 points is the one truly representative of Laboreiro’s true spatial structure, with a complex relation between altitude, slopes and horizons?</p>
<p>In the beginning of this text, we mentioned Serra da Aboboreira (Porto, Portugal). There are nucleus of monuments that were built throughout the centuries, from the beginning of the 4<sup>th</sup> millennium AC to Final Bronze and the most iconic one is the already mentioned “<em>Núcleo de Outeiro de Gregos”</em><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>which serves as a good example of this “<em>satellitization</em>”. At the same time, we have monuments that were built in the same period, but in complete isolation<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>, or others that, being isolated, were built in places that are the opposite of what one would expect of these monuments. So, contrary to Outeiro de Gregos, we have Mina do Simão (Jorge, 1984), a closed dolmen, also in Aboboreira, that was built at the bottom of a small hill, facing what would’ve been a stream. None of the variables suggested here would apply: Mina do Simão has no viewshed (being at the bottom of said hill) and was implanted on a slope with no topographic prominence<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>.</p>
<p>To continue discussing this aspect, as an example we can consider the stratigraphy observed in some monuments: it has been forwarded that the terrain for their implantation was treated and cleaned, sometimes using fire and burning an entire patch of land (this is usually seen in a layer rich in charcoal or ash, just like in Outeiro de Gregos 1, Chã de Santinhos 1, or Mamoa da Igrejinha (all from Serra da Aboboreira, Porto, Portugal (Jorge, 1980: 16; Jorge, 1989: 387; Cleto &amp; Faro, 1988: 50, respectively). Recent micromorphological analysis to undisturbed sections of Anta 1 do Vale da Laje (Tomar, Portugal) have also shown that it’s possible to observe the existence of both several human activities and sedimentary processes that occurred in different phases: before, during and after the monument’s construction. The analysis conducted indicated 1) the existence of cleaning activities through fire in an area covered with vegetation, 2) a perturbation context due to the observance of scratching of large surfaces around the monument (possibly a construction event), 3) a later forest regrowth (indicating abandonment) and 4) its subsequent cleaning (indicating a reuse), etc. (Adewumi, 2018-2019: 14, 39-40). It is in these small aspects that we can observe that level of inconsistency - not in the data, nor in the methods - but in how heterogeneous these landscapes are, hence our need in scrutinizing our sample even more, despite the primal results shown by the Wilcoxon test.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion"><strong>6. Conclusion</strong></h2>
<p>This research has contributed to the debate of the complex interplay between the role that some environmental variables could have in the explanation of the spatial patterns of the mounds and megaliths of Serra do Laboreiro. Our research has shown that some variables, such as the altitude, slope, cumulative horizon and cumulative viewshed might have influenced the spatial location of the monuments, suggesting that the topographic positioning might have played a crucial role in monument placing. The prominence of those factors might be supporting the hypothesis that the mounds and megaliths in this region could have been strategically located to optimize their viewsheds, potentially related to communication, territorial control or symbolic purposes. This adds new data for current debates in the megalithic phenomenon of Northwestern Iberia and other European regions (see e.g.&nbsp;Higginbottom et al.&nbsp;2025).</p>
<p>Also, the spatial patterns modelled in this work reflect a diachronic use of the landscape, where different occupation strategies might be employed over time. The concept of “satellitization”, wherein newer monuments were built near older ones, appears to be supported by our statistical work, a similar approach done in other regions (see Carrero-Pazos et al.&nbsp;2019).</p>
<p>Despite these promising insights gained through computational and quantitative modelling, our study also acknowledges the inherent limitations of those tools in capturing the full complexity of a landscape in continuous transformation. The archaeological evidence, including micromorphological analyses, could reveal in this area that the site selection would involve some works such as land preparation or controlled burning, further emphasizing the role of human agency on shaping the landscapes (see e.g.&nbsp;Rodríguez del Cueto et al.&nbsp;2023).</p>
<p>Ultimately, our research helps reinforcing the idea that while environmental factors could significantly have influenced the site placement, the general spatial distribution cannot be reduced to a single deterministic model. Instead, research like this one reflect a dynamic interaction between human cultural practices, environmental affordances and long-term social landscape transformations. Future research should try to integrate additional qualitative data and diachronic analyses to refine our understanding of settlement strategies, megalithic and mound placing, and the process of formation of those complex monumental landscapes.</p>
</section>
<section id="reproducibility-statement" class="level2">
<h2 class="anchored" data-anchor-id="reproducibility-statement"><strong>7. Reproducibility statement</strong></h2>
<p>The research contained in this paper was carried out comprising current standards for open access and reproducible frameworks in archaeology, by using a scripting statistical language such as R Statistics and sharing the research data and results in collaborative ways. The data and scripts are available under a Zenodo repository (<a href="https://zenodo.org/records/15480087" class="uri">https://zenodo.org/records/15480087</a>), and Github for collaborative work (<a href="https://github.com/MCarreroPazos/MegalithsLaboreiro" class="uri">https://github.com/MCarreroPazos/MegalithsLaboreiro</a>). R scripts are released under MIT license and archaeological and data results are shared under CC-BY4.0</p>
<p>R Statistics package citation is done using the <a href="https://pakillo.github.io/grateful/index.html">grateful package</a>, with a summary file included in the root directory of the project (see Github page).</p>
<div class="cell">
<div class="cell-output-display">
<p>We used R version 4.3.2 <span class="citation" data-cites="base">[@base]</span> and the following R packages: foreach v. 1.5.2 <span class="citation" data-cites="foreach">[@foreach]</span>, magick v. 2.8.6 <span class="citation" data-cites="magick">[@magick]</span>, nlme v. 3.1.163 <span class="citation" data-cites="nlme2000 nlme2023">[@nlme2000; @nlme2023]</span>, plotly v. 4.10.4 <span class="citation" data-cites="plotly">[@plotly]</span>, prettymapr v. 0.2.5 <span class="citation" data-cites="prettymapr">[@prettymapr]</span>, progress v. 1.2.3 <span class="citation" data-cites="progress">[@progress]</span>, raster v. 3.6.30 <span class="citation" data-cites="raster">[@raster]</span>, reshape2 v. 1.4.4 <span class="citation" data-cites="reshape2">[@reshape2]</span>, rnaturalearth v. 1.0.1 <span class="citation" data-cites="rnaturalearth">[@rnaturalearth]</span>, rpart v. 4.1.21 <span class="citation" data-cites="rpart">[@rpart]</span>, sf v. 1.0.16 <span class="citation" data-cites="sf2018 sf2023">[@sf2018; @sf2023]</span>, sp v. 2.1.4 <span class="citation" data-cites="sp2005 sp2013">[@sp2005; @sp2013]</span>, spatstat v. 3.0.8 <span class="citation" data-cites="spatstat2005 spatstat2013 spatstat2015">[@spatstat2005; @spatstat2013; @spatstat2015]</span>, spatstat.data v. 3.1.2 <span class="citation" data-cites="spatstatdata2005 spatstatdata2013 spatstatdata2015">[@spatstatdata2005; @spatstatdata2013; @spatstatdata2015]</span>, spatstat.explore v. 3.2.7 <span class="citation" data-cites="spatstatexplore2005 spatstatexplore2013 spatstatexplore2015">[@spatstatexplore2005; @spatstatexplore2013; @spatstatexplore2015]</span>, spatstat.geom v. 3.2.9 <span class="citation" data-cites="spatstatgeom2005 spatstatgeom2013 spatstatgeom2015">[@spatstatgeom2005; @spatstatgeom2013; @spatstatgeom2015]</span>, spatstat.linnet v. 3.1.5 <span class="citation" data-cites="spatstatlinnet2005 spatstatlinnet2013 spatstatlinnet2015">[@spatstatlinnet2005; @spatstatlinnet2013; @spatstatlinnet2015]</span>, spatstat.model v. 3.2.11 <span class="citation" data-cites="spatstatmodel2005 spatstatmodel2013 spatstatmodel2015">[@spatstatmodel2005; @spatstatmodel2013; @spatstatmodel2015]</span>, spatstat.random v. 3.2.3 <span class="citation" data-cites="spatstatrandom2005 spatstatrandom2013 spatstatrandom2015">[@spatstatrandom2005; @spatstatrandom2013; @spatstatrandom2015]</span>, terra v. 1.7.55 <span class="citation" data-cites="terra">[@terra]</span>, tidyverse v. 2.0.0 <span class="citation" data-cites="tidyverse">[@tidyverse]</span>, viridis v. 0.6.5 <span class="citation" data-cites="viridis">[@viridis]</span>, viridisLite v. 0.4.2 <span class="citation" data-cites="viridisLite">[@viridisLite]</span>.</p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 18%">
<col style="width: 8%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Package</th>
<th style="text-align: left;">Version</th>
<th style="text-align: left;">Citation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">base</td>
<td style="text-align: left;">4.3.2</td>
<td style="text-align: left;"><span class="citation" data-cites="base">@base</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">foreach</td>
<td style="text-align: left;">1.5.2</td>
<td style="text-align: left;"><span class="citation" data-cites="foreach">@foreach</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">magick</td>
<td style="text-align: left;">2.8.6</td>
<td style="text-align: left;"><span class="citation" data-cites="magick">@magick</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">nlme</td>
<td style="text-align: left;">3.1.163</td>
<td style="text-align: left;"><span class="citation" data-cites="nlme2000">@nlme2000</span>; <span class="citation" data-cites="nlme2023">@nlme2023</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">plotly</td>
<td style="text-align: left;">4.10.4</td>
<td style="text-align: left;"><span class="citation" data-cites="plotly">@plotly</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">prettymapr</td>
<td style="text-align: left;">0.2.5</td>
<td style="text-align: left;"><span class="citation" data-cites="prettymapr">@prettymapr</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">progress</td>
<td style="text-align: left;">1.2.3</td>
<td style="text-align: left;"><span class="citation" data-cites="progress">@progress</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">raster</td>
<td style="text-align: left;">3.6.30</td>
<td style="text-align: left;"><span class="citation" data-cites="raster">@raster</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">reshape2</td>
<td style="text-align: left;">1.4.4</td>
<td style="text-align: left;"><span class="citation" data-cites="reshape2">@reshape2</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">rnaturalearth</td>
<td style="text-align: left;">1.0.1</td>
<td style="text-align: left;"><span class="citation" data-cites="rnaturalearth">@rnaturalearth</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">rpart</td>
<td style="text-align: left;">4.1.21</td>
<td style="text-align: left;"><span class="citation" data-cites="rpart">@rpart</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">sf</td>
<td style="text-align: left;">1.0.16</td>
<td style="text-align: left;"><span class="citation" data-cites="sf2018">@sf2018</span>; <span class="citation" data-cites="sf2023">@sf2023</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">sp</td>
<td style="text-align: left;">2.1.4</td>
<td style="text-align: left;"><span class="citation" data-cites="sp2005">@sp2005</span>; <span class="citation" data-cites="sp2013">@sp2013</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">spatstat</td>
<td style="text-align: left;">3.0.8</td>
<td style="text-align: left;"><span class="citation" data-cites="spatstat2005">@spatstat2005</span>; <span class="citation" data-cites="spatstat2013">@spatstat2013</span>; <span class="citation" data-cites="spatstat2015">@spatstat2015</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatstat.data</td>
<td style="text-align: left;">3.1.2</td>
<td style="text-align: left;"><span class="citation" data-cites="spatstatdata2005">@spatstatdata2005</span>; <span class="citation" data-cites="spatstatdata2013">@spatstatdata2013</span>; <span class="citation" data-cites="spatstatdata2015">@spatstatdata2015</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">spatstat.explore</td>
<td style="text-align: left;">3.2.7</td>
<td style="text-align: left;"><span class="citation" data-cites="spatstatexplore2005">@spatstatexplore2005</span>; <span class="citation" data-cites="spatstatexplore2013">@spatstatexplore2013</span>; <span class="citation" data-cites="spatstatexplore2015">@spatstatexplore2015</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatstat.geom</td>
<td style="text-align: left;">3.2.9</td>
<td style="text-align: left;"><span class="citation" data-cites="spatstatgeom2005">@spatstatgeom2005</span>; <span class="citation" data-cites="spatstatgeom2013">@spatstatgeom2013</span>; <span class="citation" data-cites="spatstatgeom2015">@spatstatgeom2015</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">spatstat.linnet</td>
<td style="text-align: left;">3.1.5</td>
<td style="text-align: left;"><span class="citation" data-cites="spatstatlinnet2005">@spatstatlinnet2005</span>; <span class="citation" data-cites="spatstatlinnet2013">@spatstatlinnet2013</span>; <span class="citation" data-cites="spatstatlinnet2015">@spatstatlinnet2015</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatstat.model</td>
<td style="text-align: left;">3.2.11</td>
<td style="text-align: left;"><span class="citation" data-cites="spatstatmodel2005">@spatstatmodel2005</span>; <span class="citation" data-cites="spatstatmodel2013">@spatstatmodel2013</span>; <span class="citation" data-cites="spatstatmodel2015">@spatstatmodel2015</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">spatstat.random</td>
<td style="text-align: left;">3.2.3</td>
<td style="text-align: left;"><span class="citation" data-cites="spatstatrandom2005">@spatstatrandom2005</span>; <span class="citation" data-cites="spatstatrandom2013">@spatstatrandom2013</span>; <span class="citation" data-cites="spatstatrandom2015">@spatstatrandom2015</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">terra</td>
<td style="text-align: left;">1.7.55</td>
<td style="text-align: left;"><span class="citation" data-cites="terra">@terra</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">tidyverse</td>
<td style="text-align: left;">2.0.0</td>
<td style="text-align: left;"><span class="citation" data-cites="tidyverse">@tidyverse</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">viridis</td>
<td style="text-align: left;">0.6.5</td>
<td style="text-align: left;"><span class="citation" data-cites="viridis">@viridis</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">viridisLite</td>
<td style="text-align: left;">0.4.2</td>
<td style="text-align: left;"><span class="citation" data-cites="viridisLite">@viridisLite</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="acknowledgments" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgments"><strong>8. Acknowledgments</strong></h2>
<p>Denise Lima e Silva is funded by FCT <em>Foundation for Science and Technology</em> (FCT scholarship nº. 2020.04713.BD). This work was done under the European Union’s Horizon 2020 research and innovation programme (Marie Skłodowska-Curie Grant Agreements No.&nbsp;886793, PI: MCP; and No.&nbsp;794048 PI: JF). The authors want to thank the <em>Comunidade Intermunicipal do Alto Minho</em> (CIM Alto Minho) for providing the LiDAR data used in this work.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references"><strong>9. References</strong></h2>
<p>Adewumi, O. (2018-2019). Soil Micromorphology of the Sedimentary Samples from Anta 1 de Vale da Laje, Tomar, Portugal [unpublished master dissertation]. Tomar: Instituto Politécnico de Tomar (Department of Archaeology, Conservation, Restoration and Heritage).</p>
<p>Baddeley, A., Rubak, E. y Turner, R. (2016). Spatial Point Patterns. Methodology and Applications with R. Boca Raton: Chapman &amp; Hall/CRC.</p>
<p>Blas Cortina, M. Á. de (2010). Poder ancestral y territorio neolítico: en torno a Peña Tú y los túmulos de la costa oriental de Asturias. <em>Munibe</em>, 32, 94-118.</p>
<p>Bello Diéguez, J., Criado Boado, F., &amp; Vázquez Várela, J. (1982). Megalitismo y medio físico en el Noroeste de la Península Ibérica: Estado de la cuestión y perspectivas. <em>Zephyrus, 34-25</em>, 109-118.</p>
<p>Berganzo-Besga, I., Orengo, H., Canela, J., &amp; Belarte, M. (2022). Potential of Multitemporal Lidar for the Detection of Subtle Archaeological Features under Perennial Dense Forest. <em>Land</em>(11). doi:https://doi.org/10.3390/land11111964</p>
<p>Berganzo-Besga, I., Orengo, H., Lumbreras, F., Carrero-Pazos, M., Fonte, J., &amp; Vilas-Estévez, B. (2021). Hybrid MSRM-Based Deep Learning and Multitemporal Sentinel 2-Based Machine Learning Algorithm Detects Near 10k Archaeological Tumuli in North-Western Iberia. <em>Remote Sensing, 13</em>(20).</p>
<p>Berrocal-Rangel, L., García-Giménez, R., Manglano, G., &amp; Ruano, L. (2018). When archaeological context is lacking. Lithology and spatial analysis, new interpretations of the “verracos” Iron Age sculptures in Western Iberian Peninsula. <em>Journal of Archaeological Science: Reports, 22</em>, 344-358. doi:https://doi.org/10.1016/j.jasrep.2016.03.031.</p>
<p>Bettencourt, A., &amp; Vilas Boas, L. (2021). Monumentos Megalíticos do Alto-Minho: a modelação de uma paisagem milenar. Em <em>Património artístico e cultural do Alto Minho. Uma viagem no tempo</em> (pp.&nbsp;24-35). Comunidade Intermunicipal do Alto Minho.</p>
<p>Bevan, A. (2015). The data deluge. <em>Antiquity, 89</em>(348), 1473-1484.</p>
<p>Bevan, A. (2020). Spatial point pattern and processes. In Gillings, M., Hacigüzeller, P. &amp; G. Lock (eds), <em>Archaeological Spatial Analysis. A methodological Guide</em> (pp.&nbsp;60-76). New York: Routledge.</p>
<p>Bevan, A., Crema, E., Xiuzhen, L., Palmisano, A. (2013). Intensities, interactions and uncertainties: some new approaches to archaeological distributions. In Bevan, A. &amp; M. Lake (eds), <em>Computational Approaches to Archaeological Spaces</em> (pp.&nbsp;27-52). California: Left Coast Press.</p>
<p>Bocinsky, K. (2017). Landscape-based Hypothesis Testing in R. In Marwick, B. <em>How to do archaeological science using R</em>. Chapter 9. <a href="https://benmarwick.github.io/How-To-Do-Archaeological-Science-Using-R/landscape-based-hypothesis-testing-in-r.html#references-cited" class="uri">https://benmarwick.github.io/How-To-Do-Archaeological-Science-Using-R/landscape-based-hypothesis-testing-in-r.html#references-cited</a></p>
<p>Bueno Ramírez, P. (1988). <em>Los dólmenes de Valencia de Alcántara (Excavaciones arqueológicas en España, 155).</em> Madrid: Subdirección General de Bellas Artes y Arqueología.</p>
<p>Bustelo Abuín, J., Rodríguez Rellán, C., Fábregas Valcarce, R., Barbeito Pose, V. (2017). Alén da Serra. O fenómeno tumular na Península do Barbanza a través dos SIX e a estatística espacial.&nbsp;Gallaecia. Revista de Arqueoloxía e Ciencias da Antigüidade, 36: 53-72.</p>
<p>Cabras, M. (2018). <em>Patrones de Asentamiento de la Edad del Bronce en el monte Arci y Alta Marmilla, Cerdeña centro-occidental (Doctoral Thesis).</em> Granada: Universidad de Granada. Obtido de http://hdl.handle/10481/52511</p>
<p>Cabrero González, C., Cámara Serrano, J. A, &amp; Esquivel Guerrero, J. (2020). Patrones de distribución espacial en las necrópolis megalíticas de Majadillas y Hoyas del Conquín (Granada, España). Resultados preliminares. <em>Lucentum, XXXIX</em>, 73-85. doi:10.14198/LVCENTVM2020.39.04</p>
<p>Cabrero González, C., Cámara Serrano, J. A. &amp; Cerrillo Cuenca, E. (2025). A larger-scale study of the visual dominance at the Gor River megalithic landscape (Granada, Spain). <em>Journal of Archaeological Science: Reports</em> 61, 104912. <a href="https://doi.org/10.1016/j.jasrep.2024.104912" class="uri">https://doi.org/10.1016/j.jasrep.2024.104912</a></p>
<p>Canedo, D., Fonte, J., Seco, L., Vázquez, M., Dias, R., Pereiro, T., Hipólito, J., Menéndez-Marsh, F., Georgieva, P., Neves, A. J. R. (2023). Uncovering Archaeological Sites in Airborne LiDAR Data With Data-Centric Artificial Intelligence. <em>IEEE Access, 11</em>, 65608-65619. doi:10.1109/ACCESS.2023.3290305</p>
<p>Canedo, D., Hipólito, J., Fonte, J., Dias, R., do Pereiro, T., Georgieva, P., Gonçalves-Seco, K., Vázquez, M., Pires, N., Fábrega-Álvarez, P., Menéndez-Marsh, F., Neves, A. J. R. (2024). The Synergy between Artificial Intelligence, Remote Sensing, and Archaeological Fieldwork Validation. <em>Remote Sensing</em> 16(11): 1933. <a href="http://doi.org/10.3390/rs16111933" class="uri">http://doi.org/10.3390/rs16111933</a></p>
<p>Carlson, D. (2017). <em>Quantitative Methods in Archaeology Using R.</em> Cambridge University Press.</p>
<p>Carrero Pazos, M. (2017). <em>El fenómeno tumular y megalítico en Galicia. Aportaciones desde los Sistemas de Información Geográfica y la Estadística Espacial para el estudio de los patrones de localización [Unpublished thesis].</em> Santiago de Compostela: Universidade de Santiago de Compostela.</p>
<p>Carrero-Pazos, M., Bevan, A., &amp; Lake, M. (2019). The spatial structure of Galician megalithic landscapes (NW iberia): A case study from the Monte Penide region. <em>Journal of Archaeological Science, 108</em>, 1-12.</p>
<p>Carrero-Pazos, M., Bustelo-Abuín, J., Barbeito-Pose, V., &amp; Rodríguez-Rellán, C. (2020). Locational preferences and spatial arrangement in the barrowlandscape of Serra do Barbanza (North-western Iberia). <em>Journal of Archaeological Science: Reports, 31</em>. doi:https://doi.org/10.1016/j.jasrep.2020.102351</p>
<p>Carvalho, P., &amp; Carvalho, A. (2018). Para uma recuperação do megalitismo de Lafões (Viseu, Portugal). O concelho de Vouzela enquanto case-study. Em J. Senna-Martinez, M. Diniz , &amp; A. Carvalho (Ed.), <em>De Gibraltar aos Pirinéus - Megalitismo, Vida e Morte na Fachada Atlântica Peninsular</em> (pp.&nbsp;37-50). Fundação Lapa do Lobo.</p>
<p>Catela, J. (2020). Construction materials of the monuments of Los Llanetes group, El Pozuelo cemetery (Huelva, Spain). Selection, exploitation and provenance of stone blocks. Em R. Boaventura, R. Mataloto, &amp; A. Pereira (Edits.), <em>Megaliths and Geology. MEGA-TALKS 2 19-20 November 2015</em> (pp.&nbsp;87-134). Redondo, Portugal: Archaeopress Publishing Ltd.</p>
<p>Cleto, J., &amp; Faro, S. (1988). Escavação da Mamoa de Igrejinhas (Marco de Canaveses - Serra da Aboboreira). <em>Arqueologia</em>(17), 44-57.</p>
<p>Conolly, J., &amp; Lake, M. (2006). <em>Geographical Information Systems in Archaeology.</em> Cambridge University Press. doi:https://doi.org/10.1017/CBO9780511807459</p>
<p>Conrad, O. (2011). <em>Module TPI Based Landform Classification</em>. Retrieved 2 15, 2023, from SAGA-GIS Module Library Documentation (v2.2.1): https://saga-gis.sourceforge.io/saga_tool_doc/2.2.1/ta_morphometry_19.html</p>
<p>Conrad, O. (2016). <em>Tool Multi-Scale Topographic Position Index (TPI)</em>. Retrieved 2 15, 2023, from SAGA-GIS Tool Library Documentation (v7.0.0): https://saga-gis.sourceforge.io/saga_tool_doc/7.0.0/ta_morphometry_28.html</p>
<p>Cortell Nicolau, A., &amp; Pardo-Gordó, S. (2023). Modelizaciones computacionales para la comprensión de fenómenos históricos y sociales. <em>Vegueta. Anuário de la Facultad de Geografia e História, 23</em>(1), 9-14.</p>
<p>Criado Boado, F. (1988). Arqueología del Paisaje y Espacio Megalítico en Galicia. <em>Seminario sobre Arqueología</em>, 61-117.</p>
<p>Criado Boado, F., &amp; Villoch Vázquez, V. (2000). Monumentalizing landscape: from present perception to the past meaning of Galician Megalithism (north-west Iberian Peninsula). <em>European Journal of Archaeology, 3</em>(2), 188-216.</p>
<p>Criado Boado, F., &amp; Grajal Blanco, M. (1981). Relación entre la distribución de mámoas y el medio físico de la zona de Sobrado-Curtis. <em>Brigantium,</em>(2), 7-26.</p>
<p>Criado Boado, F., &amp; Valcarce, R. (1989). The megalithic phenomenon of northwest Spain: main trends. <em>Antiquity, 63</em>(241), 682-696.</p>
<p>Criado-Boado, F. (1984). El tercer factor o la lógica oculta del emplazamiento de los túmulos megalíticos. <em>Cuadernos de Estudios Gallegos, 35</em>, 7-18.</p>
<p>Cruz, D. J. (1980). Contribuição para o levantamento cartográfico do conjunto megalítico da Serra da Aboboreira (concelhos de Amarante e Baião). <em>Actas do Seminário de Arqueologia do Noroeste Peninsular.</em> <em>I</em>, pp.&nbsp;23-40. Guimarães: Sociedade Martins Sarmento.</p>
<p>Cruz, D. J. (1992). A Mamoa 1 de Chã de Carvalhal no Contexto Arqueológico da Serra da Aboboreira. Em <em>Conimbriga, Anexos</em> (Vol. I). Coimbra: Instituto de Arqueologia da Faculdade de Letras de Coimbra.</p>
<p>Cruz, D. J., &amp; Sanches, M. J. (1985). Escavação da Mamoa 4 de Outeiro de Gregos (Serra da Aboboreira - Baião). <em>Arqueologia</em>(11), 26-39.</p>
<p>Čučković, Z. (2016). Advanced viewshed analysis: a Quantum GIS plug-in for the analysis of visual landscapes. <em>Journal of Open Source Software, 1</em>(4), 32. doi:doi:10.21105/joss.00032</p>
<p>Díaz-Rodríguez, M., &amp; Fábregas-Valcarce, R. (2022). Evaluating the effectiveness of three spatial cluster analysis methods on Palaeolithic site location distributions in Galicia, NW Iberian Peninsula. <em>Journal of Archaeological Science: Reports, 41</em>. doi:https://doi.org/10.1016/j.jasrep.2021.103323</p>
<p>Diéz Castillo, A. (1996). Utilización de los recursos en la marina y montaña cantábricas: una prehistoria ecológica de los valles del deva y Nansa. <em>Illunzar</em>(3), 11-185.</p>
<p>Eguileta Franco , J. (1999). <em>A Baixa Limia na Prehistoria Recente. Arqueoloxía dunha Paisaxe na Galicia interior.</em> Ourense:: Excma. Diputación Provincial de Ourense.</p>
<p>Eguileta Franco, J. (1993-1994). As Mámoas dos concellos da Baixa Limia: Aportación al catálogo de monumentos tumulares de la comarca. <em>Cuadernos de Estudios Gallegos, 41</em>(106), 41-64.</p>
<p>Eguileta Franco, J. (1995). El volumen de los monumentos megalíticos: aportación a los patrones de emplazamiento en la comarca de A Baixa Limia (Ourense, Galicia). <em>Boletín del Seminario de Estudios de Arte y Arqueología de Valladolid, LXI</em>, 9-39.</p>
<p>Ehlschlaeger, C. (1989). Using the AT Search Algorithm to Develop Hydrologic Models from Digital Elevation Data. <em>International Geographic Information Systems (IGIS) Symposium ’89</em>, (pp.&nbsp;275-281). Baltimore, Maryland, USA.</p>
<p>Esquivel, F., Cabrero, C., Cámara, J., &amp; Esquivel, J. (2022). Statistical analysis on metric and geometric features of dolmens in the Gor river megalithic landscape (Granada, Andalusia, Spain). <em>Archaeometry</em>, 1-18. doi:10.1111/arcm.12750</p>
<p>Fábregas Valcarce, R. (1988). Cronología y periodización del megalitismo en Galicia y norte de Portugal. <em>Espacio, Tiempo y Forma, 1</em>(1), 279-291. doi:DOI: 10.5944/etfi.1.1988.4494</p>
<p>Fábregas Valcarce, R., &amp; Vilaseco Vásquez, X. (2000). El Neolítico y el Megalitismo en Galicia: problemas teórico-metodológicos y estado de la cuestión. (V. GONÇALVES, Ed.), <em>Trabalhos de Arqueologia</em>(25), 281-305.</p>
<p>Gallant, J.C., Dowling, T.I. (2003): A multiresolution index of valley bottom flatness for mapping depositional areas. <em>Water Resources Research</em>, 39/12, 1347-1359.</p>
<p>García Sanjuán, L. (2008). Grandes piedras en un mundo cambiante: la arqueología de los megalitos en su paisaje. <em>PH Boletín del Instituto Andaluz del Patrimonio Histórico</em>, 67, 24-33.</p>
<p>García Sanjuán, L., Wheatley, D., Murrieta-Flores, P., &amp; Márquez Pérez, J. (2009). Los SIG y el análisis espacial en arqueología. Aplicaciones en la prehistoria reciente del sur de España. Em M. Cau Ontiveros, &amp; F. Nieto Prieto (Edits.), <em>Arqueología náutica mediterránea</em> (pp.&nbsp;163-180). Girona: Centre d’Arqueologia Subacuàtica de Catalunya. Obtido de http://hdl.handle.net/11441/53295</p>
<p>Gillings, M. (2012). Landscape Phenomenology, GIS and the Role of Affordance. <em>Journal of Archaeological Method and Theory, 19</em>, 601–611. doi:DOI 10.1007/s10816-012-9137-4</p>
<p>Gillings, M., Hacigüzeller, P., &amp; Lock, G. (2020). <em>Archaeological Spatial Analysis: A Methodologial Guide.</em> Routledge.</p>
<p>Günther, G., Kempf, M., Knitter, D., 2022. <em>rbias</em> (Version R-package 0.1), <a href="https://zenodo.org/record/7071418" class="uri">https://zenodo.org/record/7071418</a></p>
<p>Higginbottom, G., Gonzalez-Garcia, A., Carrero-Pazos, M., Vilas-Estévez, B., &amp; López-López, V. (2022). Landscapes of the “Coast of Death”: dolmen topographies of NW Iberia. <em>STAR: Science &amp; Technology of Archaeological Research, 8</em>(1), 1-19. doi:10.1080/20548923.2022.2078029</p>
<p>Higginbottom, G., Verdonkschot, J., Scarre, C., González-García, C., Criado Boado, F. (2025). <em>Megalithic Societies: Old Questions, New Narratives</em>. Oxford: Archaeopress.</p>
<p>Hu, D. (2011). Advancing Theory? Landscape Archaeology and Geographical Information Systems. <em>PIA, 21</em>, 80-90. doi: 10.5334/pia.381</p>
<p>Jasiewicz, J., &amp; Stepinski, T. (2013). Geomorphons - a pattern recognition approach to classification and mapping of landforms. <em>Geomorphology</em>, 147-156. doi: 10.1016/j.geomorph.2012.11.005</p>
<p>Jorge, V. O. (1980a). A Mamoa 2 de Outeiro de Gregos - Serra da Aboboreira, Baião. <em>Revista de Guimarães</em>(90), 191-209.</p>
<p>Jorge, V. O. (1980b). Escavação das Mamoas 2 e 3 de Outeiro de Gregos (Serra da Aboboreira - Baião) - Notícia Preliminar. <em>IV Congresso Nacional de Arqueologia</em> (pp.&nbsp;251-267). Faro: Lisboa: Centro de Hist. das Universidades de Lisboa, [D.L. 1979].</p>
<p>Jorge, V. O. (1980c). Escavação da Mamoa 1 de Outeiro de Gregos. Serra da Aboboreira, Baião. <em>Portugália, nova série</em>(I), 9-28.</p>
<p>Jorge, V. (1980d). Sobre uma estrutura periférica situada na periferia da Mamoa 2 de Outeiro de Gregos (Serra da Aboboreira, Baião). <em>Arqueologia</em>(2), 19-24.</p>
<p>Jorge, V. O. (1980e). Nótula sobre a fossa aberta no saibro de Outeiro de Gregos (Serra da Aboboreira, Baião). <em>Arqueologia</em>(1), 19-24.</p>
<p>Jorge, V. (1982a). <em>Megalitismo do Norte de Portugal: o Distrito do Porto - Os Monumentos e a sua Problemática no Contexto Europeu.</em> (Vol. I). Porto: Dissertação de doutoramento apresentada à Faculdade de Letras da Universidade do Porto.</p>
<p>Jorge, V. O. (1982b). A Mamoa 5 de Outeiro de Gregos, um tumulus não Megalítico da Serra da Aboboreira. <em>Arqueologia</em>(6), 32-39.</p>
<p>Jorge, V. (1987). Megalitismo de Entre-Douro-e-Minho e de Trás-os-Montes (Norte de Portugal): conhecimentos actuais e linhas de pesquisa a desenvolver. <em>História: revista da Faculdade de Letras da Universidade do Porto</em>(4), 269-192.</p>
<p>Jorge, V. O. (1981). Importância do Núcleo Megalítico de Outeiro de Gregos. Serra da Aboboreira, Baião. <em>Arqueologia</em>(3), 29-35.</p>
<p>Jorge, V. O. (1983-84). O Megalitismo do Norte de Portugal: um novo balanço. <em>Portugália</em>(IV-V), 37-45.</p>
<p>Jorge, V. O. (1989). Les tumulus de Chã de Santinhos : (ensemble mégalíthique de Serra da Aboboreira, Nord du Portugal). Em P. I. Científica (Ed.), <em>Livro de homenagem a Jean Roche</em> (pp.&nbsp;381-413).</p>
<p>Jorge, V. O. (1992). As mamoas funerárias do norte de Portugal (do Neolítico à Idade do Bronze Antigo) como elementos indicadores de uma progressiva complexidade social. <em>Revista da Faculdade de Letras. Historia</em>(9), 463-480.</p>
<p>Kempf, M., Günther, G. (2022). Point pattern and spatial analyses using archaeological and environmental data – A case study from the Neolithic Carpathian Basin. Journal of Archaeological Science: Reports 47, 103747. https://doi.org/10.1016/j.jasrep.2022.103747</p>
<p>Kokalj, Ž., &amp; Hesse, R. (2017). <em>Airborne laser scanning raster data visualization: A Guide to Good Practice.</em> Ljubljana: Založba ZRC.</p>
<p>Kvamme, K. L. (2020). Analysing regional environmental relationships. In Gillings, M., Hacigüzeller, P., &amp; Lock, G. (2020). <em>Archaeological Spatial Analysis: A Methodologial Guide</em> (212-230)<em>.</em> London: Routledge.</p>
<p>L’helgouac’h, J. (1965). <em>Les sépultures mégalithiques en Armorique.</em> Rennes: Laboratoire d’Anthropologie Préhistorique de la Faculté des Sciences.</p>
<p>Llober, M. (2000). Understanding movement: a Pilot Model Towards the Sociology of Movement. In G. Lock (Ed.), <em>Beyond the Map: Archaeology and Spatial Technologies</em> (pp.&nbsp;66-84). Washington.: IOS Press.</p>
<p>Llobera, M. (2015). Working the Digital: Some thoughts from Landscape Archaeology. Em R. Chapman, &amp; A. Wylie (Edits.), <em>Material Evidence: Learning from Archaeological Practice</em> (pp.&nbsp;173-188). Abingdon: Routledge.</p>
<p>López Cuevillas, F. (1923). Os dólmenes do Monte das Motas en Lobeira. <em>Revista Nós, 18</em>, 18-21.</p>
<p>López Cuevillas, F. (1925a). La época megalítica en el Noroeste de la Península. <em>Boletín de la Real Academia Gallega, XV</em>, 25-39.</p>
<p>López Cuevillas, F. (1925b). As mámoas do Concello de Rairiz. <em>Boletín de la Real Academia Gallega, XV</em>, 235-245.</p>
<p>López Cuevillas, F. (1973). A edade megalítica. Em R. Otero Pedrayo (Ed.), <em>Historia de Galicia</em> (Vol. I, pp.&nbsp;43-122). Buenos Aires: Ediciones Galicia.</p>
<p>Mehrer, M., &amp; Wescott, K. (2006). <em>GIS and Archaeological Site Location Modeling.</em> Routledge.</p>
<p>Murrieta-Flores, P. (2012). Understanding human movement through spatial technologies. The role of natural areas of transit in the Late Prehistory of South-western Iberia. <em>Trabajos de Prehistoria, 69</em>(1), 103-122. doi:10.3989/tp.2012.12082</p>
<p>Murrieta-Flores, P. (2014). Developing computational approaches for the study of movement: assessing the role of visibility and landscape markers in terrestrial navigation during Iberian Late Prehistory. Em S. Polla, &amp; P. Verhagen (Edits.), <em>Computational Approaches to the Study of Movement in Archaeology. Theory, Practice and Interpretation of Factors and Effects of Long-Term Landscape Formation and Transformation</em> (Vol. 23, pp.&nbsp;74-99). Berlin, Boston: Walter de Gruyter.</p>
<p>Opitz, R. S., Cowley, D. C. (2013). <em>Interpreting Archaeological Topography: 3D Data, Visualisation and Observation</em>. Oxford: Oxbow Books.</p>
<p>O’Sullivan, M. (2011). Megalithic tombs and storied landscapes in Neolithic Ireland. Em M. Furholt, F. Lüth, &amp; J. Müller (Edits.), <em>Megaliths and identities: early monuments and Neolithic societies from the Atlantic to the Baltic</em> (Vol. 12, pp.&nbsp;53-66). Dr Rudolph Habelt GmbH.</p>
<p>Parcero Oubiña, C., &amp; Fábrega Álvarez, P. (2006). Diseño metodológico para el análisis locacional de asentamientos a través de un SIG de base raster. Em I. Grau Mira (Ed.), <em>La aplicación de los SIG en la Arqueología del Paisaje</em> (pp.&nbsp;69-91). Alicante: Servicio de Publicaciones Universidad de Alicante.</p>
<p>Renfrew, C. (1973). <em>The Explanation of Culture change: models in Prehistory.</em> Liverpool: Duckworth.</p>
<p>Renfrew, C. (1976). Megaliths, territories and populations. <em>Acculturation and Continuity in Atlantic Europe, mainly during the Neolithic period and the Bronze Age. Papers Presented at the IV Atlantic Colloquium</em> (pp.&nbsp;198-220). Ghent, Bruges: De Tempel.</p>
<p>Rodríguez Casal, A. (1979). O Megalitismo na Galiza. A sua problemática e o estado actual de investigación. Em <em>1ª Mesa-Redonda sobre o Neolítico e o Calcolitico em Portugal</em> (pp.&nbsp;103-115). Porto: Grupo de Estudos Arqueológicos do Porto.</p>
<p>Rodríguez del Cueto, F., &amp; Carrero-Pazos, M. (2021a). Contributions from LiDAR technology to the sites and monuments records: the prehistoric barrows of Salas Council (Asturias, Spain). <em>Veleia, 38</em>, 9-31.</p>
<p>Rodríguez del Cueto, F., &amp; Carrero-Pazos, M. (2021b). Límites y posibilidades de los análisis LiDAR aplicados al megalitismo asturiano. Revisión de cuatro conjuntos tumulares prehistóricos en el concejo de Salas (España). <em>Veleia, 38</em>(38), 9-31. doi:10.1387/veleia.21455</p>
<p>Rodríguez del Cueto, F., Busto Zapico, M. &amp; Lastra Alonso, E. (2023). El dolmen de la Cobertoria (Salas, Asturias): fases arquitectónicas y primeras aproximaciones al estudio arqueológico y documental del saqueo de las ruinas prehistóricas. En D. García Rivero, <em>Actas del VII Congreso sobre Neolítico en la península ibérica</em> (pp.&nbsp;551-565). Sevilla: Universidad de Sevilla.</p>
<p>Rodríguez-Rellán, C., &amp; Fábregas Valcarce, R. (2019). Monuments on the move. Assessing megaliths’ interaction with the North-Western Iberian landscapes. Em J. Müller, M. Hinz, &amp; M. Wunderlich (Ed.), <em>Proceedings of the international conference - Megaliths, Societies, Landscapes. Early monumentality and social differentiation in Neolithic Europe.</em> <em>2</em>, pp.&nbsp;621-639. Kiel: Frühe Monumentalität und soziale Differenzierung, 18.</p>
<p>Rubio-Campillo, X., Ble, E., Sala, R., &amp; Tamba, R. (2022). A Spatial Connectivity Approach to Landscapes of Conflict: Julius Caesar and the Assault to Puig Ciutat (NE Iberian Peninsula). <em>Journal of Archaeological Method and Theory, 29</em>, 1059-1089. doi:https://doi.org/10.1007/s10816-022-09549-7</p>
<p>Sanches, M., &amp; Nunes, S. (2005). Monumentos em pedra numa região de Trás-os-Montes - Nordeste de Portugal: Sua expressão na paisagem habitada durante o 4º e 3º milénio BC. <em>Revista da Faculdade de Letras, CIÊNCIAS E TÉCNICAS DO PATRIMÓNIO, IV</em>(I Série), 53-82.</p>
<p>Shepard, D. (1968). A two-dimensional interpolation function for irregularly-spaced data. <em>Proceedings of the 1968 23rd ACM National Conference</em>, (pp.&nbsp;517-524).</p>
<p>Silva, E. (2003). Novos dados sobre o Megalitismo do Norte de Portugal. Em V. Gonçalves (Ed.), <em>Muita gente, poucas antas? Origens, espaços e contextos do Megalitismo. Actas do II Colóquio Internacional sobre Megalitismo</em> (Vol. 25, pp.&nbsp;269-279). Trabalhos de Arqueologia.</p>
<p>Sousa, M. G. F. de (2012). O fenómeno tumular e megalítico na região galaico-portuguesa do Minho: tese doutoral. Universidade de Santiago de Compostela. Departamento de Historia I. <a href="http://hdl.handle.net/10347/7510" class="uri">http://hdl.handle.net/10347/7510</a></p>
<p>Tilley, C. (1994). <em>A Phenomenology of Landscape: Places, Paths and Monuments.</em> Oxford: Berg.</p>
<p>Verhagen, P. (2018). Predictive Modeling. Em S. López Varela (Ed.), <em>The Encyclopedia of Archaeological Sciences</em> (pp.&nbsp;1-3). JohnWiley &amp; Sons, Inc.&nbsp;doi:DOI: 10.1002/9781119188230.saseas0475</p>
<p>Vilas-Estévez, B. (2015). Estudio de las orientaciones y emplazamientos de los túmulos de la necrópolis de la Serra do Leboreiro en base a la Arqueología del Paisaje y la Arqueoastronomía. Santiago de Compostela: Universidade de Santiago de Compostela.</p>
<p>Villoch Vázquez, V. (1995). Monumentos y petroglifos: la construcción del espacio en las sociedades constructoras de túmulos del noroeste peninsular. <em>Trabajos de Prehistoria, 52</em>(1), 39-55.</p>
<p>Weiss, A. D. (2001). Topographic position and landforms analysis. Poster Presentation, ESRI Users Conference, San Diego, CA. <a href="https://env761.github.io/assets/files/tpi-poster-tnc_18x22.pdf" class="uri">https://env761.github.io/assets/files/tpi-poster-tnc_18x22.pdf</a></p>
<p>Yubero-Gómez, M., Rubio-Campillo, X., López-Cachero, F., &amp; Esteve-Gràcia, X. (2015). Mapping changes in late prehistoric landscapes: A case study in the Northeastern Iberian Peninsula. <em>Journal of Anthropological Archaeology, 40</em>, 123-134. doi: https://doi.org/10.1016/j.jaa.2015.07.002</p>
<p>Zakšek, K., Oštir, K., &amp; Kokalj, Ž. (2011). Sky-View Factor as a Relief Visualization Technique. <em>Remote Sensing, 3</em>(2), 398-415. doi: https://doi.org/10.3390/rs3020398</p>
<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The Northern Region of Portugal referenced here was previously under the responsibility of the Regional Directorate of Culture of the North (DRC Norte). This region is now being administered by the Regional Coordination and Development Commissions (CCDR), in this case CCDR Norte (henceforth referenced here as the North of Portugal). The North is, therefore, defined by the following territories: Alto Minho, Cávado, Ave, Área Metropolitana do Porto, Alto Tâmega, Tâmega e Sousa, Douro, Terras de Trás-os-Montes (<a href="https://www.ccdr-n.pt/pagina/regiao-norte/apresentacao" class="uri">https://www.ccdr-n.pt/pagina/regiao-norte/apresentacao</a>).<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Part of an ongoing PhD Project in Serra da Aboboreira (Lima e Silva, 2025. Unpublished. PhD Submitted. Pending PhD defence).<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Here, we distance ourselves from D. Fraser’s thesis where he debated whether a monument’s (inter)visibility (or lack thereof) serves as a confirmation of the existence of social power structures (see Brughmans &amp; Brandes (2017) on Fraser (1980)).<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>The Nucleus of Outeiro de Gregos is a group of five monuments: two dolmens built in the beginning of the 4<sup>th</sup> millennium, another in the end of the 4<sup>th</sup> millennium, one in a transitional phase to the 3<sup>rd</sup> (if not representing that timeline already), a megalithic cist build in the beginning of the 2<sup>nd</sup> millennium, and the fifth monument, a small <em>tumulus</em> devoid of chamber representing final Bronze Age. In this area, there was also found a small round lithic structure and pits opened in the bedrock (Jorge, 1980a, 1980b, 1980c, 1980d, 1980e, 1981, 1982a, 1982b; Cruz &amp; Sanches, 1985).<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>We will, here, distance ourselves from what this might comprise, as it may lay on profound cultural notions that are completely out of our reach or, at least, out of this paper’s objectives.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Despite extensive efforts within the current PhD project to relocate this monument, it could not be found. It appears to have been completely obliterated sometime between its original excavation and 2023).<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb11" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Spatial insights of the tumular phenomenon in Serra do Laboreiro region (NW Iberian Peninsula)"</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: "Denise Lima e Silva"</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliation: "University of Coimbra"</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">    email: "limadenisearch21@gmail.com"</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: "Miguel Carrero-Pazos"</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">    orcid: 0000-0001-9203-9954</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliation: "University of Santiago de Compostela / CISPAC"</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">    email: "miguel.carrero@usc.es"</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: "Francisco Lara-Piñera"</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliation: "National University of Distance Education"</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">    email: "flara@geo.uned.es"</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: "João Fonte"</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">    orcid: 0000-0003-0367-0598</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliation: "NOVA University Lisbon"</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">    email: "jfonte@fcsh.unl.pt"</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: "Benito Vilas-Estévez"</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliation: "Arbore Arqueoloxia"</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co">    email: "vilasbenito@gmail.com"</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> today</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 2</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="co">    fontsize: 1.1em</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="co">    linestretch: 1.7</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: github</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="co">    css: styles.css</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="an">code-fold:</span><span class="co"> true</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="fu">## Abstract</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>The region encompassing Planalto de Castro Laboreiro (Melgaço, Portugal), Baixa Limia (Ourense, Spain), and its surrounding areas is renowned for its significant concentration of tumular and megalithic sites. Despite the lack of formal excavations for most of the sites, this study employs a landscape archaeology approach supported by spatial statistics to identify possible spatial patterning behind the construction of the megalithic landscape. We tested multiple landscape features that have long been emphasized as having a significant influence on the placement of these monuments within the territory, and present how the geomorphology of the territory acts as both a constraint and social booster in the construction and deconstruction of these multiple spaces over time.</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a><span class="fu">## Keywords</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>Landscape archaeology, GeogrLandscape archaeology, Geographic Information Systems, Spatial Statistics, Megalithic Complex, Portugal, Spain.aphic Information Systems, Spatial Statistics, Megalithic Complex, Portugal, Spain</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a><span class="fu">## **1. Introduction: study area and the context of its megalithic landscape**</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>The regions circumscribing the Northwest of the Iberian Peninsula boast one of the highest concentrations of megalithic sites in Europe. Currently, there are over 10,000 registered *tumuli* and dolmens in this area (see Scarre, 2018). Amongst this area, Serra do Laboreiro and its surroundings stands out as the area with the most abundant concentrations, situated administratively between Portugal (Alto Minho, Viana do Castelo District) and Spain (Galicia) (**Figure 1**).</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a><span class="in">```{r filename="Figure 1.R"}</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Figure 1. The geographic positioning of the Serra do Laboreiro region within the Iberian Peninsula (above), and study area with the selected megalithic monuments (black dots)."</span></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a><span class="in"># Code for figure 1</span></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a><span class="in"># Libraries</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a><span class="in">library(sf)</span></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a><span class="in">library(rnaturalearth)</span></span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a><span class="in">library(terra)</span></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a><span class="in">library(prettymapr)</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a><span class="in"># Set working directory and paths</span></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a><span class="in">setwd("~/Desktop/Laboreiro/")</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a><span class="in">shp_path &lt;- file.path("shp")</span></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a><span class="in">grid_path &lt;- file.path("grid")</span></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a><span class="in"># Load spatial data</span></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a><span class="in">sites &lt;- invisible(suppressMessages(st_read(file.path(shp_path, "sites_lab.shp"), quiet = TRUE) %&gt;% st_transform(4326)))</span></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a><span class="in">study_area &lt;- invisible(suppressMessages(st_read(file.path(shp_path, "mask.shp"), quiet = TRUE) %&gt;% st_transform(4326)))</span></span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a><span class="in"># Load DEM</span></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a><span class="in">dem &lt;- suppressWarnings(terra::rast(file.path(grid_path, "dtm.tif")))</span></span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a><span class="in">dem &lt;- terra::project(dem, "EPSG:4326")</span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a><span class="in"># Load Iberia basemap</span></span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a><span class="in">iberia &lt;- ne_countries(country = c("spain", "portugal"), returnclass = "sf", scale = 10)</span></span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a><span class="in">iberia &lt;- st_cast(st_geometry(iberia), "POLYGON")</span></span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a><span class="in">iberia &lt;- iberia[st_coordinates(st_centroid(iberia))[,"X"] &gt; -10, ]</span></span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a><span class="in">iberia &lt;- st_union(iberia[st_area(iberia) &gt; units::set_units(50000000, "m^2")])</span></span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a><span class="in">iberia &lt;- st_transform(iberia, 4326)</span></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a><span class="in">franceandorra &lt;- st_cast(st_geometry(ne_countries(country = "france", returnclass = "sf", scale = 10)), "POLYGON")</span></span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a><span class="in">franceandorra &lt;- franceandorra[st_area(franceandorra) == units::set_units(max(st_area(franceandorra)), "m^2")]</span></span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a><span class="in">franceandorra &lt;- st_union(franceandorra, st_geometry(ne_countries(country = "andorra", returnclass = "sf", scale = 10)))</span></span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a><span class="in">franceandorra &lt;- st_transform(franceandorra, 4326)</span></span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a><span class="in">northafrica &lt;- ne_countries(country = c("morocco", "algeria"), returnclass = "sf", scale = 10)</span></span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a><span class="in">northafrica &lt;- st_cast(st_geometry(northafrica), "POLYGON")</span></span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a><span class="in">northafrica &lt;- st_union(northafrica[st_area(northafrica) &gt; units::set_units(50000000, "m^2")])</span></span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a><span class="in">northafrica &lt;- st_transform(northafrica, 4326)</span></span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a><span class="in">andorra &lt;- st_cast(st_geometry(ne_countries(country = "andorra", returnclass = "sf", scale = 10)), "POLYGON")</span></span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a><span class="in">andorra &lt;- st_transform(andorra, 4326)</span></span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a><span class="in">iberiaAndorra &lt;- st_union(iberia, andorra)</span></span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a><span class="in"># Panel 1 and Panel 2 in the first row, and Panel 3 in the second row spanning both columns</span></span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a><span class="in">layout_matrix &lt;- rbind(c(1, 2),</span></span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a><span class="in">                       c(3, 3))</span></span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a><span class="in"># Set the layout</span></span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a><span class="in">layout(layout_matrix)</span></span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a><span class="in"># Panel 1: Plot study area</span></span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a><span class="in">plot(iberiaAndorra, border = NA, col = "grey75",</span></span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a><span class="in">     main = "a. Study area in the Iberian Peninsula") </span></span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a><span class="in">plot(franceandorra, col = "grey90", border = NA, add = TRUE) </span></span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a><span class="in">plot(northafrica, col = "grey90", border = NA, add = TRUE) </span></span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a><span class="in"># Draw a solid rectangle to represent the zoom window</span></span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a><span class="in">rect(xleft = -8.4, xright = -7.85, </span></span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a><span class="in">     ybottom = 41.85, ytop = 42.25,</span></span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a><span class="in">     col = "black",</span></span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a><span class="in">     border = "black", lty = 1)</span></span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a><span class="in">addnortharrow(scale = 0.5)</span></span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a><span class="in">addscalebar(pos = "bottomright")</span></span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a><span class="in">box()</span></span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a><span class="in"># Panel 2. Study area in the Iberian Peninsula</span></span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a><span class="in">zoom_window &lt;- st_sfc(st_point(c(-8.9484, 41.7)), st_point(c(-7.7481, 42.2)), crs = 4326)</span></span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a><span class="in">window_coord_sf &lt;- st_coordinates(zoom_window)</span></span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a><span class="in">iberia_nw &lt;- ne_countries(country = c("spain", "portugal"), returnclass = "sf", scale = 10)</span></span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a><span class="in">iberia_nw &lt;- st_cast(st_geometry(iberia_nw), "POLYGON")</span></span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a><span class="in">iberia_nw &lt;- iberia_nw[st_coordinates(st_centroid(iberia_nw))[,"X"] &gt; -10, ]</span></span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a><span class="in">iberia_nw &lt;- st_transform(iberia_nw, 4326)</span></span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a><span class="in">## Set up the plot layout and margins</span></span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a><span class="in">par(mar = c(4, 4, 4, 4))</span></span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a><span class="in">## Plot Iberia map with bounding box (window coordinates)</span></span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a><span class="in">plot(st_geometry(iberia_nw), col = "lightgray", border = "black", main = "b. Serra do Laboreiro region", xlim = c(window_coord_sf[1, "X"], window_coord_sf[2, "X"]),</span></span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a><span class="in">     ylim = c(window_coord_sf[1, "Y"], window_coord_sf[2, "Y"]), </span></span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a><span class="in">     xlab = "Longitude", ylab = "Latitude", axes = FALSE)</span></span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a><span class="in">## Add custom axis labels for longitude and latitude</span></span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a><span class="in">axis(1, at = seq(-8.95, -7.75, by = 0.1), labels = TRUE)  # Longitude (x-axis)</span></span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a><span class="in">axis(2, at = seq(41.7, 42.2, by = 0.1), labels = TRUE)  # Latitude (y-axis)</span></span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a><span class="in">## Add labels for Spain and Portugal</span></span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true" tabindex="-1"></a><span class="in">text(x = c(-8.6, -8.59), y = c(42.13, 41.91), </span></span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true" tabindex="-1"></a><span class="in">     labels = c("Spain", "Portugal"), </span></span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a><span class="in">     col = "black", </span></span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true" tabindex="-1"></a><span class="in">     cex = 0.8, </span></span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true" tabindex="-1"></a><span class="in">     font = 2)</span></span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a><span class="in">## Draw the dashed rectangle to represent the zoom window</span></span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true" tabindex="-1"></a><span class="in">rect(xleft = -8.3015, xright = -7.9843, ybottom = 41.9483, ytop = 42.1125, </span></span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true" tabindex="-1"></a><span class="in">     border = "black", lty = 2,</span></span>
<span id="cb11-138"><a href="#cb11-138" aria-hidden="true" tabindex="-1"></a><span class="in">     cex=2)</span></span>
<span id="cb11-139"><a href="#cb11-139" aria-hidden="true" tabindex="-1"></a><span class="in">## Add the vertical text for "Atlantic Ocean"</span></span>
<span id="cb11-140"><a href="#cb11-140" aria-hidden="true" tabindex="-1"></a><span class="in">text(x = -8.99, y = 42.0, </span></span>
<span id="cb11-141"><a href="#cb11-141" aria-hidden="true" tabindex="-1"></a><span class="in">     labels = "Atlantic Ocean", </span></span>
<span id="cb11-142"><a href="#cb11-142" aria-hidden="true" tabindex="-1"></a><span class="in">     col = "black", </span></span>
<span id="cb11-143"><a href="#cb11-143" aria-hidden="true" tabindex="-1"></a><span class="in">     srt = 90, </span></span>
<span id="cb11-144"><a href="#cb11-144" aria-hidden="true" tabindex="-1"></a><span class="in">     cex = 0.8, </span></span>
<span id="cb11-145"><a href="#cb11-145" aria-hidden="true" tabindex="-1"></a><span class="in">     font = 2)</span></span>
<span id="cb11-146"><a href="#cb11-146" aria-hidden="true" tabindex="-1"></a><span class="in">addnortharrow(scale = 0.5)</span></span>
<span id="cb11-147"><a href="#cb11-147" aria-hidden="true" tabindex="-1"></a><span class="in">addscalebar(pos = "bottomright")</span></span>
<span id="cb11-148"><a href="#cb11-148" aria-hidden="true" tabindex="-1"></a><span class="in">box() # add bounding box</span></span>
<span id="cb11-149"><a href="#cb11-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-150"><a href="#cb11-150" aria-hidden="true" tabindex="-1"></a><span class="in"># Panel 3: DEM with site points</span></span>
<span id="cb11-151"><a href="#cb11-151" aria-hidden="true" tabindex="-1"></a><span class="in"># Plot DEM</span></span>
<span id="cb11-152"><a href="#cb11-152" aria-hidden="true" tabindex="-1"></a><span class="in">plot(dem, main = "c. Altitude (masl)")</span></span>
<span id="cb11-153"><a href="#cb11-153" aria-hidden="true" tabindex="-1"></a><span class="in"># Add site points</span></span>
<span id="cb11-154"><a href="#cb11-154" aria-hidden="true" tabindex="-1"></a><span class="in">plot(sites$geometry, add = TRUE, </span></span>
<span id="cb11-155"><a href="#cb11-155" aria-hidden="true" tabindex="-1"></a><span class="in">     pch = 21, </span></span>
<span id="cb11-156"><a href="#cb11-156" aria-hidden="true" tabindex="-1"></a><span class="in">     col = "white", </span></span>
<span id="cb11-157"><a href="#cb11-157" aria-hidden="true" tabindex="-1"></a><span class="in">     bg = "black")</span></span>
<span id="cb11-158"><a href="#cb11-158" aria-hidden="true" tabindex="-1"></a><span class="in"># Adjusted North Arrow Position (moved left)</span></span>
<span id="cb11-159"><a href="#cb11-159" aria-hidden="true" tabindex="-1"></a><span class="in"># North Arrow (top-left)</span></span>
<span id="cb11-160"><a href="#cb11-160" aria-hidden="true" tabindex="-1"></a><span class="in">arrows(x0 = -8.15, y0 = 42.085, </span></span>
<span id="cb11-161"><a href="#cb11-161" aria-hidden="true" tabindex="-1"></a><span class="in">       x1 = -8.15, y1 = 42.09, </span></span>
<span id="cb11-162"><a href="#cb11-162" aria-hidden="true" tabindex="-1"></a><span class="in">       length = 0.1, col = "black", lwd = 2)</span></span>
<span id="cb11-163"><a href="#cb11-163" aria-hidden="true" tabindex="-1"></a><span class="in"># Add the "N" label for North just above the arrow</span></span>
<span id="cb11-164"><a href="#cb11-164" aria-hidden="true" tabindex="-1"></a><span class="in">text(x = -8.15, y = 42.093, labels = "N", </span></span>
<span id="cb11-165"><a href="#cb11-165" aria-hidden="true" tabindex="-1"></a><span class="in">     cex = 0.8, font = 2)</span></span>
<span id="cb11-166"><a href="#cb11-166" aria-hidden="true" tabindex="-1"></a><span class="in"># Small Scale Bar (just below the arrow)</span></span>
<span id="cb11-167"><a href="#cb11-167" aria-hidden="true" tabindex="-1"></a><span class="in"># Define the start and end points for the scale bar</span></span>
<span id="cb11-168"><a href="#cb11-168" aria-hidden="true" tabindex="-1"></a><span class="in">scale_start_x &lt;- -8.154</span></span>
<span id="cb11-169"><a href="#cb11-169" aria-hidden="true" tabindex="-1"></a><span class="in">scale_end_x &lt;- -8.145</span></span>
<span id="cb11-170"><a href="#cb11-170" aria-hidden="true" tabindex="-1"></a><span class="in">scale_y &lt;- 42.082</span></span>
<span id="cb11-171"><a href="#cb11-171" aria-hidden="true" tabindex="-1"></a><span class="in"># Draw the scale bar with tick marks</span></span>
<span id="cb11-172"><a href="#cb11-172" aria-hidden="true" tabindex="-1"></a><span class="in">segments(x0 = scale_start_x, </span></span>
<span id="cb11-173"><a href="#cb11-173" aria-hidden="true" tabindex="-1"></a><span class="in">         y0 = scale_y, </span></span>
<span id="cb11-174"><a href="#cb11-174" aria-hidden="true" tabindex="-1"></a><span class="in">         x1 = scale_end_x, </span></span>
<span id="cb11-175"><a href="#cb11-175" aria-hidden="true" tabindex="-1"></a><span class="in">         y1 = scale_y, </span></span>
<span id="cb11-176"><a href="#cb11-176" aria-hidden="true" tabindex="-1"></a><span class="in">         col = "black", </span></span>
<span id="cb11-177"><a href="#cb11-177" aria-hidden="true" tabindex="-1"></a><span class="in">         lwd = 3)</span></span>
<span id="cb11-178"><a href="#cb11-178" aria-hidden="true" tabindex="-1"></a><span class="in"># Add scale text below the scale bar (e.g., "1 km")</span></span>
<span id="cb11-179"><a href="#cb11-179" aria-hidden="true" tabindex="-1"></a><span class="in">text(x = -8.1497, </span></span>
<span id="cb11-180"><a href="#cb11-180" aria-hidden="true" tabindex="-1"></a><span class="in">     y = 42.0789, </span></span>
<span id="cb11-181"><a href="#cb11-181" aria-hidden="true" tabindex="-1"></a><span class="in">     labels = "1km", </span></span>
<span id="cb11-182"><a href="#cb11-182" aria-hidden="true" tabindex="-1"></a><span class="in">     cex = 0.8, </span></span>
<span id="cb11-183"><a href="#cb11-183" aria-hidden="true" tabindex="-1"></a><span class="in">     font = 2, </span></span>
<span id="cb11-184"><a href="#cb11-184" aria-hidden="true" tabindex="-1"></a><span class="in">     col = "black")</span></span>
<span id="cb11-185"><a href="#cb11-185" aria-hidden="true" tabindex="-1"></a><span class="in"># Add a legend for the site points (centered on the plot)</span></span>
<span id="cb11-186"><a href="#cb11-186" aria-hidden="true" tabindex="-1"></a><span class="in">legend(x = -8, y = 42.03,  # Adjust x and y coordinates for the legend position</span></span>
<span id="cb11-187"><a href="#cb11-187" aria-hidden="true" tabindex="-1"></a><span class="in">       legend = "Sites", </span></span>
<span id="cb11-188"><a href="#cb11-188" aria-hidden="true" tabindex="-1"></a><span class="in">       pch = 21, </span></span>
<span id="cb11-189"><a href="#cb11-189" aria-hidden="true" tabindex="-1"></a><span class="in">       pt.bg = "black", </span></span>
<span id="cb11-190"><a href="#cb11-190" aria-hidden="true" tabindex="-1"></a><span class="in">       pt.cex = 1.2,  # Adjust point size if needed</span></span>
<span id="cb11-191"><a href="#cb11-191" aria-hidden="true" tabindex="-1"></a><span class="in">       col = "white", </span></span>
<span id="cb11-192"><a href="#cb11-192" aria-hidden="true" tabindex="-1"></a><span class="in">       bty = "n",     # No border around the legend</span></span>
<span id="cb11-193"><a href="#cb11-193" aria-hidden="true" tabindex="-1"></a><span class="in">       cex = 1)     # Adjust font size of the legend</span></span>
<span id="cb11-194"><a href="#cb11-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-195"><a href="#cb11-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-196"><a href="#cb11-196" aria-hidden="true" tabindex="-1"></a>Knowledge on the tumular phenomenon at the Portuguese-Galician frontier remains somewhat sparse even considering decades old continuous studies of some areas in the northwest of the Iberian Peninsula. Several efforts coming from Spanish and Portuguese universities, such as the University of Santiago de Compostela (e.g. Eguileta Franco, 1999), the Archaeological Unit of the University of Minho or the Group of Archaeological Studies of Porto (GEAP – Grupo de Estudos Arqueológicos do Porto), jointly with the efforts by the regional governments, such as Xunta de Galicia, were put forth in the decades between 1978 until circa 1992 to survey the territories in the north of Portugal and south of Galicia. Those works resulted in the creation of new site and monument records for the area.</span>
<span id="cb11-197"><a href="#cb11-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-198"><a href="#cb11-198" aria-hidden="true" tabindex="-1"></a>Amongst the most debated, surveyed and excavated megalithic group in the Iberian Northwest remains Serra da Aboboreira (Porto, Portugal) (Cruz, 1980, 1992; Jorge, 1982a, 1983-84, 1992), Trás-os-Montes and the entire region of Entre Douro e Minho (Portugal) (Jorge, 1987; Silva, 2003; Sanches &amp; Nunes, 2005; Bettencourt &amp; Vilas Boas, 2021), with Planalto de Castro Laboreiro (shared between Portugal and Galicia) (López Cuevillas, 1923, 1925a, 1925b; 1973), and the region of Baixa Limia (Ourense) (Eguileta Franco, 1993-94, 1995) with important concentration of prehistoric sites as early as the 5^th^ millennium BC. In Galicia, Costa da Morte appears to be one of the regions with the highest density of sites, as several researchers have pointed out (e.g. Carrero-Pazos Rodríguez Casal, 2019).</span>
<span id="cb11-199"><a href="#cb11-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-200"><a href="#cb11-200" aria-hidden="true" tabindex="-1"></a>In the case of Serra do Laboreiro, the continuous surveys and field prospections went from the identification of 64 monuments to circa 200 (Jorge, 1982: 421; Sousa, 2012; cfr: Canedo et al. 2023), reaching, today, a little bit over 1,000 registered monuments for the north of Portugal only<span class="ot">[^1]</span>. However, although there are, indeed, over 1,000 entries in the current national database – Geoportal de Arqueologia do Património Cultural, I.P. (<span class="ot">&lt;https://arqueologia.patrimoniocultural.pt/&gt;</span>)-, there is a need for an intensive revision, as some sites may have more than one entry under different identifications or names. In this aspect, a remote identification has its limits, something that is being constantly underlined, stating how indispensable conducting thorough fieldwork validation continues to be - and despite the refinement of AI algorithms (see Canedo et al. 2023, 2024).</span>
<span id="cb11-201"><a href="#cb11-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-202"><a href="#cb11-202" aria-hidden="true" tabindex="-1"></a><span class="ot">[^1]: </span>The Northern Region of Portugal referenced here was previously under the responsibility of the Regional Directorate of Culture of the North (DRC Norte). This region is now being administered by the Regional Coordination and Development Commissions (CCDR), in this case CCDR Norte (henceforth referenced here as the North of Portugal). The North is, therefore, defined by the following territories: Alto Minho, Cávado, Ave, Área Metropolitana do Porto, Alto Tâmega, Tâmega e Sousa, Douro, Terras de Trás-os-Montes (<span class="ot">&lt;https://www.ccdr-n.pt/pagina/regiao-norte/apresentacao&gt;</span>).</span>
<span id="cb11-203"><a href="#cb11-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-204"><a href="#cb11-204" aria-hidden="true" tabindex="-1"></a>Only Serra da Aboboreira and its neighbouring mountain, Serra do Castelo, were excavated, published, and studied to their maximum during the 1980s and beginning of the 21^st^ century, leaving us a layout for the study of these types of ancient social and territorial contexts. Despite this, the number of monuments is not enough to understand the phenomenon, some defending it even creates a somewhat fragmentary knowledge of it (Jorge, 1987: 270), specifically for the north of Portugal, as we rest mostly on the knowledge of one *necropolis.* That is not to say that the only source of knowledge for this type of contexts rests solely on one example, rather it is the only one where information can be derived out of one single landscape with approximately 40 (excavated) monuments instead of a small group of them. In fact, if there is something that Serra da Aboboreira underlined was that the tumular phenomenon/tumular landscapes is to be regarded as a heterogenous and polymorphic behaviour (see Jorge, 1981; Fábregas Valcarce, 1988: 280), whose background rests behind a multitude of social layouts and variables – most of which unknown or poorly understood – which stretch over a large chronological space.</span>
<span id="cb11-205"><a href="#cb11-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-206"><a href="#cb11-206" aria-hidden="true" tabindex="-1"></a>As previously mentioned, amongst the most well-known tumular landscapes rests Planalto de Castro Laboreiro and its surrounding areas, and the Galician region of Baixa Limia including Maus de Salas, with 269 identified barrow-like structures, some of which identified in the last decades of the 20^th^ century, others inedited and recently added to the database. The monuments are located at altitudes ranging from 1300 m.a.s.l. and 700 m.a.s.l. (**Figure 2**).</span>
<span id="cb11-207"><a href="#cb11-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-208"><a href="#cb11-208" aria-hidden="true" tabindex="-1"></a><span class="in">```{r filename="Figure 2.R"}</span></span>
<span id="cb11-209"><a href="#cb11-209" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Figure 2. Megalithic sites from Serra do Laboreiro. Photographs by Goreti Sousa (Sousa, 2012)."</span></span>
<span id="cb11-210"><a href="#cb11-210" aria-hidden="true" tabindex="-1"></a><span class="in"># Load library</span></span>
<span id="cb11-211"><a href="#cb11-211" aria-hidden="true" tabindex="-1"></a><span class="in">library(magick)</span></span>
<span id="cb11-212"><a href="#cb11-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-213"><a href="#cb11-213" aria-hidden="true" tabindex="-1"></a><span class="in"># Define directory path</span></span>
<span id="cb11-214"><a href="#cb11-214" aria-hidden="true" tabindex="-1"></a><span class="in">dir_path &lt;- "/Users/miguelpazoscarrero/Desktop/Laboreiro/images/"</span></span>
<span id="cb11-215"><a href="#cb11-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-216"><a href="#cb11-216" aria-hidden="true" tabindex="-1"></a><span class="in"># Load images</span></span>
<span id="cb11-217"><a href="#cb11-217" aria-hidden="true" tabindex="-1"></a><span class="in">img1 &lt;- image_read(paste0(dir_path, "OFeM1.JPG"))</span></span>
<span id="cb11-218"><a href="#cb11-218" aria-hidden="true" tabindex="-1"></a><span class="in">img2 &lt;- image_read(paste0(dir_path, "OFeM3_Dolmen.JPG"))</span></span>
<span id="cb11-219"><a href="#cb11-219" aria-hidden="true" tabindex="-1"></a><span class="in">img3 &lt;- image_read(paste0(dir_path, "Landscape.JPG"))</span></span>
<span id="cb11-220"><a href="#cb11-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-221"><a href="#cb11-221" aria-hidden="true" tabindex="-1"></a><span class="in"># Set the target width for the full composition</span></span>
<span id="cb11-222"><a href="#cb11-222" aria-hidden="true" tabindex="-1"></a><span class="in">target_width &lt;- 800  </span></span>
<span id="cb11-223"><a href="#cb11-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-224"><a href="#cb11-224" aria-hidden="true" tabindex="-1"></a><span class="in"># Resize the top images so that they add up to the target width</span></span>
<span id="cb11-225"><a href="#cb11-225" aria-hidden="true" tabindex="-1"></a><span class="in">img1 &lt;- image_resize(img1, paste0(target_width / 2, "x"))  </span></span>
<span id="cb11-226"><a href="#cb11-226" aria-hidden="true" tabindex="-1"></a><span class="in">img2 &lt;- image_resize(img2, paste0(target_width / 2, "x"))</span></span>
<span id="cb11-227"><a href="#cb11-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-228"><a href="#cb11-228" aria-hidden="true" tabindex="-1"></a><span class="in"># Resize the bottom image to match the target width</span></span>
<span id="cb11-229"><a href="#cb11-229" aria-hidden="true" tabindex="-1"></a><span class="in">img3 &lt;- image_resize(img3, paste0(target_width, "x"))</span></span>
<span id="cb11-230"><a href="#cb11-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-231"><a href="#cb11-231" aria-hidden="true" tabindex="-1"></a><span class="in"># Add labels "A", "B", and "C" correctly</span></span>
<span id="cb11-232"><a href="#cb11-232" aria-hidden="true" tabindex="-1"></a><span class="in">img1 &lt;- image_annotate(img1, "A", </span></span>
<span id="cb11-233"><a href="#cb11-233" aria-hidden="true" tabindex="-1"></a><span class="in">                       gravity = "northwest", </span></span>
<span id="cb11-234"><a href="#cb11-234" aria-hidden="true" tabindex="-1"></a><span class="in">                       location = "+10+10",</span></span>
<span id="cb11-235"><a href="#cb11-235" aria-hidden="true" tabindex="-1"></a><span class="in">                       size = 40,</span></span>
<span id="cb11-236"><a href="#cb11-236" aria-hidden="true" tabindex="-1"></a><span class="in">                       color = "black", </span></span>
<span id="cb11-237"><a href="#cb11-237" aria-hidden="true" tabindex="-1"></a><span class="in">                       strokecolor  = "black")</span></span>
<span id="cb11-238"><a href="#cb11-238" aria-hidden="true" tabindex="-1"></a><span class="in">img2 &lt;- image_annotate(img2, "B", </span></span>
<span id="cb11-239"><a href="#cb11-239" aria-hidden="true" tabindex="-1"></a><span class="in">                       gravity = "northeast",</span></span>
<span id="cb11-240"><a href="#cb11-240" aria-hidden="true" tabindex="-1"></a><span class="in">                       location = "+10+10",</span></span>
<span id="cb11-241"><a href="#cb11-241" aria-hidden="true" tabindex="-1"></a><span class="in">                       size = 40, </span></span>
<span id="cb11-242"><a href="#cb11-242" aria-hidden="true" tabindex="-1"></a><span class="in">                       color = "black", </span></span>
<span id="cb11-243"><a href="#cb11-243" aria-hidden="true" tabindex="-1"></a><span class="in">                       strokecolor = "black")</span></span>
<span id="cb11-244"><a href="#cb11-244" aria-hidden="true" tabindex="-1"></a><span class="in">img3 &lt;- image_annotate(img3, "C", </span></span>
<span id="cb11-245"><a href="#cb11-245" aria-hidden="true" tabindex="-1"></a><span class="in">                       gravity = "northwest",</span></span>
<span id="cb11-246"><a href="#cb11-246" aria-hidden="true" tabindex="-1"></a><span class="in">                       location = "+10+10",</span></span>
<span id="cb11-247"><a href="#cb11-247" aria-hidden="true" tabindex="-1"></a><span class="in">                       size = 40, </span></span>
<span id="cb11-248"><a href="#cb11-248" aria-hidden="true" tabindex="-1"></a><span class="in">                       color = "black", </span></span>
<span id="cb11-249"><a href="#cb11-249" aria-hidden="true" tabindex="-1"></a><span class="in">                       strokecolor = "black")</span></span>
<span id="cb11-250"><a href="#cb11-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-251"><a href="#cb11-251" aria-hidden="true" tabindex="-1"></a><span class="in"># Combine the first row (OFeM1 and OFeM3_Dolmen)</span></span>
<span id="cb11-252"><a href="#cb11-252" aria-hidden="true" tabindex="-1"></a><span class="in">top_row &lt;- image_append(c(img1, img2), stack = FALSE)</span></span>
<span id="cb11-253"><a href="#cb11-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-254"><a href="#cb11-254" aria-hidden="true" tabindex="-1"></a><span class="in"># Merge both rows vertically (top row + full-width bottom image)</span></span>
<span id="cb11-255"><a href="#cb11-255" aria-hidden="true" tabindex="-1"></a><span class="in">composition &lt;- image_append(c(top_row, img3), stack = TRUE)</span></span>
<span id="cb11-256"><a href="#cb11-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-257"><a href="#cb11-257" aria-hidden="true" tabindex="-1"></a><span class="in"># Display the final image</span></span>
<span id="cb11-258"><a href="#cb11-258" aria-hidden="true" tabindex="-1"></a><span class="in">plot(composition)</span></span>
<span id="cb11-259"><a href="#cb11-259" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-260"><a href="#cb11-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-261"><a href="#cb11-261" aria-hidden="true" tabindex="-1"></a>Most of these groups of tumular monuments remain to be excavated. The inner structures encased by the earthen barrows may refer to megalithic chambers like dolmens, or cists, each case referring to particular periods; the very own structural layout of some of the first ones (open dolmens, closed dolmens, dolmens with corridor, megalithic cists) (see Criado Boado &amp; Valcarce, 1989: 688, 692) seems to suggest different timelines not too distant chronologically, as some already suggested (López Cuevillas, 1973; Rodríguez Casal, 1979; Cruz, 1992: 69-72).</span>
<span id="cb11-262"><a href="#cb11-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-263"><a href="#cb11-263" aria-hidden="true" tabindex="-1"></a>The life *tempo* of some of these monuments – from their construction to abandonment and posterior reuse - stretches in time to such an extent that it becomes challenging to determine concrete phases of interaction with the monument when we want to go beyond the simple determination of a beginning and an end (which, in itself, is not “simple” regarding the invisibility of artefactual and material record and samples for dating). For most of these cases we can mostly consider their landscape framework, *i.e.*, since we are dealing with a space-related phenomenon, there are associations we can reflect upon, particularly the relationship between humans and their landscape.</span>
<span id="cb11-264"><a href="#cb11-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-265"><a href="#cb11-265" aria-hidden="true" tabindex="-1"></a>Given that this phenomenon brings the novelty of space demarcation through the construction of funerary structures (Renfrew, 1973, 1976; Díez Castillo 1996: 32; Murrieta-Flores, 2012), and since there are many aspects of their builders’ intentions and cultural backgrounds we cannot know for sure, there are common characteristics in terms of territorial display that allude to the criteria used for their construction (something also extensively studied in the Gor necropolis, in Granada; see e.g. Esquivel *et al.,* 2022; Cabrero González *et al.* 2025).</span>
<span id="cb11-266"><a href="#cb11-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-267"><a href="#cb11-267" aria-hidden="true" tabindex="-1"></a>Natural elements in the landscape as well as geomorphological features act as those criteria of choice (e.g. Villoch Vázquez 1995; Criado Boado, Villoch Vázquez 2000; García Sanjuán 2008; Blas Cortina 2010), some of which may even rest on aspects of a cultural basis or even a pragmatic nature. We take into consideration the timeline in which this phenomenon first appears and the socioeconomical implications associated with them, meaning, human groups still somewhat mobile, and the first indications of a producing lifestyle - in some places, still very much incipient - coupled with pastoralism and hunter-gatherer activities (Díez Castillo 1996; Fábregas Valcarce &amp; Vilaseco Vásquez, 2006: 2).</span>
<span id="cb11-268"><a href="#cb11-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-269"><a href="#cb11-269" aria-hidden="true" tabindex="-1"></a>The ways of assessing these elements come from a crescent improvement in digital tools from fields such as Geographical Information Systems, Artificial Intelligence and Spatial Statistics, as well as a renovated interest in their application in current archaeological science (Bevan, 2015; Cortell-Nicolau &amp; Pardo-Gordó, 2023). In fact, the importance space holds over humans did not go by unnoticed during earlier studies on these specific monuments (albeit the focus during field works remained towards the obvious parts of the structure – the chamber, corridor, etc.). The most obvious and debated elements relate to the structures’ closeness to rocky outcrops (e.g. &nbsp;L’ Helgouac’h, 1965; Bueno Ramírez, 1988; Criado Boado &amp; Grajal, 1981; Criado Boado, 1984: 9-10; Catela, 2020: 91;), natural passageways (Criado Boado, Vaquero Lastres, 1991; García Sanjuán et al. 2009; Cabras, 2018; Murrieta-Flores, 2012, 2014, Llobera, 2000; Carrero Pazos, 2017: 137; Rodríguez Rellán &amp; Fábregas Valcarce 2019), proximity to water bodies (Tilley, 1994: 67, 123; O’Sullivan, 2011: 65) and to arable lands (Criado Boado &amp; Grajal, 1981: 23; Bello Diéguez et al. 1982), to which we can add the (inter)visibility and topographic prominence (Criado Boado, 1984: 14, 1988: 669; Cabrero González *et al.* 2020).</span>
<span id="cb11-270"><a href="#cb11-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-271"><a href="#cb11-271" aria-hidden="true" tabindex="-1"></a>Based on this research background, in this case study we use some of the variables that best account for the location of the megalithic sites, such as altitude, slope, cumulative viewshed, distance to rocky outcrops and the main landscape features, the hydrographic basins and natural pathways.&nbsp;Given the strict relation their construction seems to have with the territory throughout the centuries, a spatial statistical analysis seems the best fit to deal with the lack of information from direct interventions.</span>
<span id="cb11-272"><a href="#cb11-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-273"><a href="#cb11-273" aria-hidden="true" tabindex="-1"></a><span class="fu">## **2. Methods and analyses**</span></span>
<span id="cb11-274"><a href="#cb11-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-275"><a href="#cb11-275" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.1. Spatial Statistics</span></span>
<span id="cb11-276"><a href="#cb11-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-277"><a href="#cb11-277" aria-hidden="true" tabindex="-1"></a>The potential of statistical methods and GIS in archaeology has been extensively explored and documented thus far. This is particularly noteworthy, given the advancements in digital tools and technological improvements that have characterized the last two decades (see e.g. Mehrer &amp; Wescott, 2006; Carlson, 2017; Verhagen, 2018;Gillings, Hacigüzeller &amp; Lock, 2020). Archaeologists have eagerly embraced new techniques to assist in establishing methods for interpreting records and organizing data. Similarly, the application of practical and digital methods has surged, in line with new theoretical hypotheses (Hu, 2011; Gillings, 2012).</span>
<span id="cb11-278"><a href="#cb11-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-279"><a href="#cb11-279" aria-hidden="true" tabindex="-1"></a>The ones highlighted in this text arise amidst the tumular phenomenon debate and regard those main territorial attributes or elements from a (tumular) landscape, *i.e.*, a study on a regional scale of a set of monuments in a mountain environment. As most of the monuments have no information from excavations, the study focuses essentially on direct and observable territorial attributes of the relation between the megalith’s setting and their surroundings.</span>
<span id="cb11-280"><a href="#cb11-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-281"><a href="#cb11-281" aria-hidden="true" tabindex="-1"></a>Studies on landscape archaeology based on Spatial Statistics are not new in the Iberian Peninsula (see e.g. Parcero Oubiña &amp; Fábrega Álvarez, 2006; Yubero-Gómez et al., 2015; Berrocal-Rangel et al., 2018; Rubio Campillo et al. 2022; Carrero-Pazos, Bevan &amp; Lake, 2019; Díaz Rodríguez &amp; Fábregas Valcarce, 2022), and the potential they pose proves to be of great utility especially when confronted with case studies that lack formal and direct evidences. However, their application on tumular landscapes is still somewhat incipient, with greater incidence in the Iberian Northwest (Llobera, 2015; Carrero-Pazos et al., 2020; Higginbottom et al., 2022; Berganzo-Besga et al., 2021; Rodríguez del Cueto &amp; Carrero-Pazos, 2021) and the South (Murrieta-Flores, 2012, 2014). &nbsp;Despite the variety of methods used in these analyses and the observation of point distributions and spatial interactions between them, several courses of action may be considered based on the specificities of the study area and the questions to be answered.</span>
<span id="cb11-282"><a href="#cb11-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-283"><a href="#cb11-283" aria-hidden="true" tabindex="-1"></a>We know that behind these monuments rests a multitude of different behaviours extended over large periods of time. From previous readings, be them before or after the introduction of computational approaches, we can also positively assume some *de facto* aspects: (i) the monuments may occur in the landscape in clusters or isolated, and (ii) may represent distinct chronologies, therefore, we can also positively assume that (iii) the existence of previous monuments is a factor of influence for the construction of new structures in later periods (Carrero-Pazos et al. 2019). Consider, for example, Outeiro de Gregos in Serra da Aboboreira (Portugal), a cluster of five monuments ranging from the beginning of 4^th^ millennium BCE, to the 2^nd^ millennium BCE (Jorge, 1981), or even the Necropolis of Lafões in Viseu (Portugal), a cluster of circa 114 monuments also ranging from the beginning of the 4^th^ millennium until the XII-VII century BCE (Carvalho &amp; Carvalho, 2018: 41).</span>
<span id="cb11-284"><a href="#cb11-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-285"><a href="#cb11-285" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.2. Archaeological data. Ground truthing through LiDAR data</span></span>
<span id="cb11-286"><a href="#cb11-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-287"><a href="#cb11-287" aria-hidden="true" tabindex="-1"></a>The study area is in the frontier territories over Ourense province (Galicia, Spain) and the Melgaço municipality (district of Viana do Castelo, north of Portugal). The archaeological data used in this work is the result of several fieldwork campaigns that some of the authors did in the past (e.g., Vilas Estévez, 2015) and current revisions from AI approaches (Canedo et al. 2023, 2024).</span>
<span id="cb11-288"><a href="#cb11-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-289"><a href="#cb11-289" aria-hidden="true" tabindex="-1"></a>For this work, we decided to carry out a ground truthing initial phase based on LiDAR data to check the reliability of the spatial coordinates of the sites. As such, the generation of the DEM and its pretreatment is the first unavoidable step for the entire analytical process and through which all the other variables will be modelled from (see Berganzo-Besga et al., 2022). For this, we used the available LiDAR data for Spain (Geographical National Institute, IGN - <span class="ot">&lt;https://pnoa.ign.es/pnoa-lidar/presentacion&gt;</span>), and for Portugal the LiDAR data was obtained from the Comunidade Intermunicipal do Alto Minho (CIM Alto Minho), under the collaboration by one of the authors of this paper (JF).</span>
<span id="cb11-290"><a href="#cb11-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-291"><a href="#cb11-291" aria-hidden="true" tabindex="-1"></a>The provided LiDAR data has a point cloud density of 2 points per square meter for the Portuguese part. For the Spanish (Galician) part, the LiDAR data has a point cloud density of 0.5-2 points per square meter (see <span class="ot">&lt;https://pnoa.ign.es/web/portal/pnoa-lidar/especificaciones-tecnicas&gt;</span>).</span>
<span id="cb11-292"><a href="#cb11-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-293"><a href="#cb11-293" aria-hidden="true" tabindex="-1"></a>&nbsp;The DEM was created using *LAStools*, keeping only the bare ground points with the plug-in *lasground*. The resulting point clouds were merged in *SAGA- GIS 8.5.0*, and the resulting raster was interpolated through Angular Distance Weighting (ADW) (Shepard, 1968). We decided to use ADW instead of the more common Inverse Distance Weighting (IDW), in this case, for the sake of computer efficiency. The interpolation resulted in a DEM with a 1m resolution.</span>
<span id="cb11-294"><a href="#cb11-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-295"><a href="#cb11-295" aria-hidden="true" tabindex="-1"></a>This cleaning process permits for the better observation of the terrain with no other categories but the terrain itself, which makes easy the visual identification of the megalithic mounds (Opitz &amp; Cowley, 2013). The ground truthing step required for the terrain observation and confirmation of the tumular occurrences, involved the generation of a Hillshade from the DEM and other raster visualization techniques (see Berganzo-Besga et al., 2021; Berganzo-Besga et al., 2022). In this way, we used the Relief Visualization Toolbox (RVT) (Zakšek, Oštir &amp; Kokalj, 2011;&nbsp;Kokalj &amp; Somrak, 2019) to create other convenient visualization outputs, such as the sky-view factor or a local relief model (Kokalj &amp; Hesse, 2017). We also used the *Resampling filter* from SAGA GIS, creating additional images with distinct categories in colour and shading that, when compared against the generated hillshade, helped us with the site’s identification. The ground truthing process took into consideration an initial database of 269 points corresponding to monuments identified in field surveys, either from previous prospections or more recent ones (Eguileta Franco 1999; Sousa, 2012; Vilas Estévez 2015). The database we are providing comprises the name of the monument and the UTM coordinates – easting and northing.</span>
<span id="cb11-296"><a href="#cb11-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-297"><a href="#cb11-297" aria-hidden="true" tabindex="-1"></a>To carry out the ground truthing we used ArcGIS where a point shapefile was created and used against the generated raster images. The points typically contrast with the shapes seen in the images aiming to confirm the correct georeferentiation of the monuments during the fieldwork, confirming both a correct identification and a remote LiDAR successful detection. This second step on the process generated a total of 178 points, meaning that 91 monuments were excluded from the ground truthing process according to the chosen parameters: 46 duplicated points from previous databases with monuments registered under two distinct identifications, and 45 points whose remote identification as mounds is dubious and the in-site recognition is not known.</span>
<span id="cb11-298"><a href="#cb11-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-299"><a href="#cb11-299" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.3. GIS modelling. Covariable set up</span></span>
<span id="cb11-300"><a href="#cb11-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-301"><a href="#cb11-301" aria-hidden="true" tabindex="-1"></a>The main landscape features previously mentioned are those that have been addressed by different authors as possible predictive variables of the megalithic mounds in Galicia and other regions (see the introduction chapter). Thus, in the case of this research, a data-driven model (Verhagen, 2018) reflects more accurately the factors we have at hand: altitude, slope, distance to main geomorphological features and water sources, etc.</span>
<span id="cb11-302"><a href="#cb11-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-303"><a href="#cb11-303" aria-hidden="true" tabindex="-1"></a>Therefore, several digital models were created from the DEM, according to the variables previously discussed: Slope, Cumulative Horizon, Cumulative Viewshed, Distance to Ridges, Distance to Water Edges, Distance to Rocky Outcrops, Least Cost Paths and Topographic Prominence. Distinct programs were used to create and define the raster covariates: ArcGIS 10.4, SAGA- GIS 8.5.0, Grass GIS 7.8, GIS 3.28 Firenze, and R Studio v. 4.3.0.</span>
<span id="cb11-304"><a href="#cb11-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-305"><a href="#cb11-305" aria-hidden="true" tabindex="-1"></a>+---------------+---------------------------------------------------------+</span>
<span id="cb11-306"><a href="#cb11-306" aria-hidden="true" tabindex="-1"></a>| -   Slope     | -   *ArcMap*, using the Surface in Spatial Analyst Tool |</span>
<span id="cb11-307"><a href="#cb11-307" aria-hidden="true" tabindex="-1"></a>+---------------+---------------------------------------------------------+</span>
<span id="cb11-308"><a href="#cb11-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-309"><a href="#cb11-309" aria-hidden="true" tabindex="-1"></a>+------------------------+---------------------------------------------------------------------------------+</span>
<span id="cb11-310"><a href="#cb11-310" aria-hidden="true" tabindex="-1"></a>| -   Cumulative horizon | -   *QGIS 3.28 Firenze* through the Visibility Analysis plugin (Čučković, 2016) |</span>
<span id="cb11-311"><a href="#cb11-311" aria-hidden="true" tabindex="-1"></a>+------------------------+---------------------------------------------------------------------------------+</span>
<span id="cb11-312"><a href="#cb11-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-313"><a href="#cb11-313" aria-hidden="true" tabindex="-1"></a>The intent was to model the horizon of the landscape, meaning the outer edges of a viewshed. 1,000 viewpoints where regularly generated and evenly distributed beforehand alongside the entire study area to cover the total landscape under analysis.</span>
<span id="cb11-314"><a href="#cb11-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-315"><a href="#cb11-315" aria-hidden="true" tabindex="-1"></a>+---------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb11-316"><a href="#cb11-316" aria-hidden="true" tabindex="-1"></a>| Cumulative viewshed | -   QGIS 3.28 Firenze. Similarly to the previous variable, we used the visibility index analysis from the Viewshed Analysis plugin (Čučković, 2016) |</span>
<span id="cb11-317"><a href="#cb11-317" aria-hidden="true" tabindex="-1"></a>+---------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb11-318"><a href="#cb11-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-319"><a href="#cb11-319" aria-hidden="true" tabindex="-1"></a>1,000 viewpoints were generated across the entirety of the study area, a radius of analysis of 3,000 meters and an observer height of 1.60 meters. The Visibility Index considers the proportion of a given area that is visible from a given observer location, attributing different values to raster cells considering the higher or lower degree of visibility, useful when the objective is the identification of areas in the landscape with the best visibility index.</span>
<span id="cb11-320"><a href="#cb11-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-321"><a href="#cb11-321" aria-hidden="true" tabindex="-1"></a>+--------------------+------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb11-322"><a href="#cb11-322" aria-hidden="true" tabindex="-1"></a>| Distance to ridges | *GRASS GIS* with *r.geomorphon*. It allows to calculate, classify and map the terrain elements from a DEM (Jasiewicz &amp; Stepinski, 2013). |</span>
<span id="cb11-323"><a href="#cb11-323" aria-hidden="true" tabindex="-1"></a>+--------------------+------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb11-324"><a href="#cb11-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-325"><a href="#cb11-325" aria-hidden="true" tabindex="-1"></a>The objective was to identify the main terrestrial landforms in the study area through the generation of geomorphometric maps and extract the ones that appeared to be of significance to our analysis. To identify the main terrestrial landforms, several maps were generated according to different scales and radius. Five scales were tested:</span>
<span id="cb11-326"><a href="#cb11-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-327"><a href="#cb11-327" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Outer radius = 20, inner radius = 5</span>
<span id="cb11-328"><a href="#cb11-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-329"><a href="#cb11-329" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Outer radius = 15, inner radius = 5</span>
<span id="cb11-330"><a href="#cb11-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-331"><a href="#cb11-331" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Outer radius = 35, inner radius = 0</span>
<span id="cb11-332"><a href="#cb11-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-333"><a href="#cb11-333" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Outer radius = 32, inner radius = 0</span>
<span id="cb11-334"><a href="#cb11-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-335"><a href="#cb11-335" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Outer radius = 64, inner radius = 5</span>
<span id="cb11-336"><a href="#cb11-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-337"><a href="#cb11-337" aria-hidden="true" tabindex="-1"></a>It is important to emphasize that the primary goal in defining the main landforms in the study area is closely related to identifying distinct shapes in the geomorphology, meaning, the main scenery cut against the horizon and the sky – things that can be easily recognized while traversing the landscape. Based on this, the critical visual analysis of the results determined that a radius of 64 units captured the key points in the landscape, enabling a faster identification of the main landforms. Therefore, among the 10 categories defined in *r.geomorphon*, ridges, shoulders and spurs (categories2, 3, and 4 respectively) showed to be the most promising. The raster calculator (*r.mapcalc*)allowed for the extraction of these specific landforms, so the final result was a raster file with information that regarded solely to landform categories 2, 3 and 4. Lastly, and because we want to ponder on the distance between specific points in the landscape, we applied used *r.grow.distance* todetermine the distance between the features in the landscape.</span>
<span id="cb11-338"><a href="#cb11-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-339"><a href="#cb11-339" aria-hidden="true" tabindex="-1"></a>+---------------------------------+------------------------------------------------------------------------------+</span>
<span id="cb11-340"><a href="#cb11-340" aria-hidden="true" tabindex="-1"></a>| -   Distance to watershed edges | -   *GRASS GIS* with *r.watershed* (original version by Ehlschlaeger, 1989). |</span>
<span id="cb11-341"><a href="#cb11-341" aria-hidden="true" tabindex="-1"></a>+---------------------------------+------------------------------------------------------------------------------+</span>
<span id="cb11-342"><a href="#cb11-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-343"><a href="#cb11-343" aria-hidden="true" tabindex="-1"></a>To calculate the watershed edges we used hydrological modelling, which calculates flows and basins in a DEM by generating a series of maps according to different parameters: flow accumulation, drainage direction, location of streams, watershed basins. Our variable, however, considers only watershed basins. As it requires a minimum size of the exterior watershed to be set, we tested two sizes: a threshold of 50000 units and 25000 units. A visual analysis concluded that a threshold of 25000 showed more detailed results, outlining specific watershed basins. *R.grow.distance* was then used to calculate the distance from the watershed edges to the rest of the study area.</span>
<span id="cb11-344"><a href="#cb11-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-345"><a href="#cb11-345" aria-hidden="true" tabindex="-1"></a>+--------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb11-346"><a href="#cb11-346" aria-hidden="true" tabindex="-1"></a>| -   Distance to rocky outcrops | -   ArcMap, with the creation of a shapefile and drawing polygons against the satellite images for Spain (Plan Nacional de Ortofotografía Aérea (PNOA) <span class="ot">&lt;https://pnoa.ign.es/)&gt;</span> - and Portugal (Direção Geral do Território - DGT, Ortofotos 25cm – Portugal Continental - 2018) |</span>
<span id="cb11-347"><a href="#cb11-347" aria-hidden="true" tabindex="-1"></a>+--------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb11-348"><a href="#cb11-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-349"><a href="#cb11-349" aria-hidden="true" tabindex="-1"></a>This variable required a bit more elaboration, as currently there is not any vector cartography that we can use. The raster geological maps available from the Spanish and Portuguese Geographic National Institutes were too general to be used. Thus, the creation of the variable implied a vectorization of all the rocky outcrops visible in aerial imaging though a Web Map Service. Again, *r.grow.distance* was applied to determine the distance between the rocky outcrops and the rest of the terrain.</span>
<span id="cb11-350"><a href="#cb11-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-351"><a href="#cb11-351" aria-hidden="true" tabindex="-1"></a>+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb11-352"><a href="#cb11-352" aria-hidden="true" tabindex="-1"></a>| Topographic prominence | A TPI Based Landform Classification from SAGA GIS (based on Conrad, 2011, 2016) was first applied to measure slope positions and automate the landform classifications, with a small scale of 500 and large scale of 1,000 |</span>
<span id="cb11-353"><a href="#cb11-353" aria-hidden="true" tabindex="-1"></a>+------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb11-354"><a href="#cb11-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-355"><a href="#cb11-355" aria-hidden="true" tabindex="-1"></a>It follows the assumption that the topography of the terrain where the monuments were built is of a major influence. One of the algorithms widely used for this purpose is usually the *Topographic Position Index* (TPI) from *SAGA GIS* (e.g. Bustelo Abuín et al. 2017), which takes into consideration the relative topographic prominence of a feature in the landscape at different scales and integrates it into a single grid. As the output is highly dependable on scales (Weiss, 2001), the characteristic of the landscape needs to be considered not only counting the landscape under analysis, but also the objectives under scrutiny. So, we must model this variable considering this landscape’s characteristics, which in this case is mainly constituted by open slopes and plains.</span>
<span id="cb11-356"><a href="#cb11-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-357"><a href="#cb11-357" aria-hidden="true" tabindex="-1"></a>As different landscapes have different geomorphological features, some digital models should be generated in accordance with said features. This is particularly true for this variable that considers topographic prominence, as it is scale dependent. Thus, we used the Multiresolution Index of Valley Bottom Flatness (MRVBF) and the complementary Multiresolution Index of the Ridge Top Flatness (MRRTF) to define valley bottoms as areas which were flat and low relative to their surroundings (Gallant &amp; Dowling, 2003: 9). As both open slopes and plains are characterized by flat terrain and low to gradual slope angles, we determined a value of 18 for the *Initial Threshold for Slope*, a *Shape Parameter of Slope* of 2, and a *Shape Parameter for Elevation Percentile* of 1, leaving the remaining parameters with their default setting. Then, the determination of the surface and flat areas was determined by the initial threshold: the higher the value, the flatter the surface.</span>
<span id="cb11-358"><a href="#cb11-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-359"><a href="#cb11-359" aria-hidden="true" tabindex="-1"></a>We include some of the modelled covariates in the **figure 3**.</span>
<span id="cb11-360"><a href="#cb11-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-361"><a href="#cb11-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r filename="Figure 3.R"}</span></span>
<span id="cb11-362"><a href="#cb11-362" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Figure 3. Some of the variables modelled in a GIS environment for this work."</span></span>
<span id="cb11-363"><a href="#cb11-363" aria-hidden="true" tabindex="-1"></a><span class="in"># Load required libraries</span></span>
<span id="cb11-364"><a href="#cb11-364" aria-hidden="true" tabindex="-1"></a><span class="in">library(terra)</span></span>
<span id="cb11-365"><a href="#cb11-365" aria-hidden="true" tabindex="-1"></a><span class="in">library(viridis)</span></span>
<span id="cb11-366"><a href="#cb11-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-367"><a href="#cb11-367" aria-hidden="true" tabindex="-1"></a><span class="in"># Define the directory path (modify according to your directory)</span></span>
<span id="cb11-368"><a href="#cb11-368" aria-hidden="true" tabindex="-1"></a><span class="in">dir_path &lt;- "/Users/miguelpazoscarrero/Desktop/Laboreiro/grid/"</span></span>
<span id="cb11-369"><a href="#cb11-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-370"><a href="#cb11-370" aria-hidden="true" tabindex="-1"></a><span class="in"># Load rasters</span></span>
<span id="cb11-371"><a href="#cb11-371" aria-hidden="true" tabindex="-1"></a><span class="in">rast_A &lt;- rast(paste0(dir_path, "cum_viewshed.tif"))</span></span>
<span id="cb11-372"><a href="#cb11-372" aria-hidden="true" tabindex="-1"></a><span class="in">rast_B &lt;- rast(paste0(dir_path, "dist_to_ridges.tif"))</span></span>
<span id="cb11-373"><a href="#cb11-373" aria-hidden="true" tabindex="-1"></a><span class="in">rast_C &lt;- rast(paste0(dir_path, "cum_horizon.tif"))</span></span>
<span id="cb11-374"><a href="#cb11-374" aria-hidden="true" tabindex="-1"></a><span class="in">rast_D &lt;- rast(paste0(dir_path, "dist_to_wat_edges.tif"))</span></span>
<span id="cb11-375"><a href="#cb11-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-376"><a href="#cb11-376" aria-hidden="true" tabindex="-1"></a><span class="in"># Create a custom palette for plot C (Cumulative horizon)</span></span>
<span id="cb11-377"><a href="#cb11-377" aria-hidden="true" tabindex="-1"></a><span class="in">create_transparent_palette &lt;- function(colors, alpha_values) {</span></span>
<span id="cb11-378"><a href="#cb11-378" aria-hidden="true" tabindex="-1"></a><span class="in">  rgb_values &lt;- col2rgb(colors) / 255</span></span>
<span id="cb11-379"><a href="#cb11-379" aria-hidden="true" tabindex="-1"></a><span class="in">  apply(rgb_values, 2, function(col) {</span></span>
<span id="cb11-380"><a href="#cb11-380" aria-hidden="true" tabindex="-1"></a><span class="in">    rgb(col[1], col[2], col[3], alpha = alpha_values)</span></span>
<span id="cb11-381"><a href="#cb11-381" aria-hidden="true" tabindex="-1"></a><span class="in">  })</span></span>
<span id="cb11-382"><a href="#cb11-382" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb11-383"><a href="#cb11-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-384"><a href="#cb11-384" aria-hidden="true" tabindex="-1"></a><span class="in"># Generate a terrain-like color palette with transparency</span></span>
<span id="cb11-385"><a href="#cb11-385" aria-hidden="true" tabindex="-1"></a><span class="in">n_colors &lt;- 100</span></span>
<span id="cb11-386"><a href="#cb11-386" aria-hidden="true" tabindex="-1"></a><span class="in">terrain_colors &lt;- terrain.colors(n_colors)</span></span>
<span id="cb11-387"><a href="#cb11-387" aria-hidden="true" tabindex="-1"></a><span class="in">alpha_values &lt;- seq(0.1, 1, length.out = n_colors)</span></span>
<span id="cb11-388"><a href="#cb11-388" aria-hidden="true" tabindex="-1"></a><span class="in">transparent_palette &lt;- create_transparent_palette(terrain_colors, </span></span>
<span id="cb11-389"><a href="#cb11-389" aria-hidden="true" tabindex="-1"></a><span class="in">                                                  alpha_values)</span></span>
<span id="cb11-390"><a href="#cb11-390" aria-hidden="true" tabindex="-1"></a><span class="in"># 2x2 plotting layout</span></span>
<span id="cb11-391"><a href="#cb11-391" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(2, 2), mar = c(4, 4, 2, 2))</span></span>
<span id="cb11-392"><a href="#cb11-392" aria-hidden="true" tabindex="-1"></a><span class="in">plot(rast_A, main = "A - Cumulative Viewshed", </span></span>
<span id="cb11-393"><a href="#cb11-393" aria-hidden="true" tabindex="-1"></a><span class="in">     col = magma(100))</span></span>
<span id="cb11-394"><a href="#cb11-394" aria-hidden="true" tabindex="-1"></a><span class="in">plot(rast_B, main = "B - Distance to Ridges", </span></span>
<span id="cb11-395"><a href="#cb11-395" aria-hidden="true" tabindex="-1"></a><span class="in">     col = terrain.colors(100))</span></span>
<span id="cb11-396"><a href="#cb11-396" aria-hidden="true" tabindex="-1"></a><span class="in">plot(rast_C, main = "C - Cumulative Horizon", </span></span>
<span id="cb11-397"><a href="#cb11-397" aria-hidden="true" tabindex="-1"></a><span class="in">     col = transparent_palette)</span></span>
<span id="cb11-398"><a href="#cb11-398" aria-hidden="true" tabindex="-1"></a><span class="in">plot(rast_D, main = "D - Distance to Water", </span></span>
<span id="cb11-399"><a href="#cb11-399" aria-hidden="true" tabindex="-1"></a><span class="in">     col = blues9)</span></span>
<span id="cb11-400"><a href="#cb11-400" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-401"><a href="#cb11-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-402"><a href="#cb11-402" aria-hidden="true" tabindex="-1"></a><span class="fu">## **3. Descriptive approaches to the distribution of sites**</span></span>
<span id="cb11-403"><a href="#cb11-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-404"><a href="#cb11-404" aria-hidden="true" tabindex="-1"></a>The study of barrow landscapes considers looking into patterns that could refer to similarities in the dimensions of the mound and/or chamber, existence/absence of corridor, type(s) of material culture or presence/absence of remains, or even megalithic art. These similarities could be then compared between 1) the geomorphological and topographical features, and 2) the characteristics of the structure’s implantation in the terrain – both at a macro and micro scale<span class="ot">[^2]</span>. But of course, this can only be done when we have access to data referring the structures themselves, and their respective material cultural, stratigraphy, and not just their spatial context.</span>
<span id="cb11-405"><a href="#cb11-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-406"><a href="#cb11-406" aria-hidden="true" tabindex="-1"></a><span class="ot">[^2]: </span>Part of an ongoing PhD Project in Serra da Aboboreira (Lima e Silva, 2025. Unpublished. PhD Submitted. Pending PhD defence).</span>
<span id="cb11-407"><a href="#cb11-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-408"><a href="#cb11-408" aria-hidden="true" tabindex="-1"></a>On the existence of a pattern, we could be dealing with a certain type of human group or observing a certain behaviour that could, in turn, be chronologically (or even socially) narrowed. Cases where this can be done are not so common (see, for example, Esquivel et al., 2021, 2025, stressing the tumular landscape alongside the Gor River, Granada), as one would need a landscape fully excavated, without the general absence in artefactual evidence, as well as chronometric data.</span>
<span id="cb11-409"><a href="#cb11-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-410"><a href="#cb11-410" aria-hidden="true" tabindex="-1"></a>Another important constriction is that we lack knowledge on some factors of social and cultural order in prehistoric times (especially when we confront the data for 5^th^ and/or 4^th^ millennium with the data for the 3^rd^ and end of 2^nd^ millennium), such as demographic growth, territorial disposition, and organization, etc. So, it becomes even more difficult when we try to conduct a study based solely on a point distribution.</span>
<span id="cb11-411"><a href="#cb11-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-412"><a href="#cb11-412" aria-hidden="true" tabindex="-1"></a>It becomes important to clearly define what we can observe from it considering these unknowns – which, in the context of the present text, has to start and end strictly with a spatial and very much digital and bibliographical approach.</span>
<span id="cb11-413"><a href="#cb11-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-414"><a href="#cb11-414" aria-hidden="true" tabindex="-1"></a>As an example on how some obstacles can be accounted for, let´s, for instance, consider Tobler’s First Law of Geography which states that nearby elements tend to have stronger relationships than those farther apart. In terms of this paper’s main objective – long-term human-landscape behaviour through the analysis of a non-random, clustered distribution of points - this means we can analyse it from two perspectives (and similarly to how G. Čučković forwarded it (Čučković 2024: 234, table 15.1.)):</span>
<span id="cb11-415"><a href="#cb11-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-416"><a href="#cb11-416" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>On a large scale, that is, looking at how natural landscape features influence human movement within an environment.</span>
<span id="cb11-417"><a href="#cb11-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-418"><a href="#cb11-418" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>On a small scale, that is, observing how individual monuments, our points, interact with each other.</span>
<span id="cb11-419"><a href="#cb11-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-420"><a href="#cb11-420" aria-hidden="true" tabindex="-1"></a>Essentially, this allows us to move from broad spatial relationships to more localized ones. These reflect two levels of influence considering we’re essentially dealing with human behaviour strictly from a spatial point of view: the landscape, while perceived and shaped by humans, is also subjecting humans to its geomorphological constraints, so there will always be a limit to how we can use a territory. Consequently, there’s a limit on how we can quantify these several strategies implemented by people over the long diachrony.</span>
<span id="cb11-421"><a href="#cb11-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-422"><a href="#cb11-422" aria-hidden="true" tabindex="-1"></a>Several approaches can be used to quantify these relations, such as Moran’s I Method, or the application of nonparametric estimations (*rho-hat* function, see Kempf, Günther, 2022). In this case we will opt for the widely used comparative approach between the site locations and a sample of the background terrain, based on multiple Monte Carlo Simulations, with the implementation of a Mann-Whitney test to formally test whether the site locations were likely a random sample of locations drawn from the study area or not (see Connolly, Lake 2006; Bevan et al. 2013; Bevan, 2020). This can be done in *R Statistics* by using the *rbias* package (Kempf, Günther, 2022), with implementations from K. Bocinsky (2017), by calculating and graphing a Monte Carlo sub-sampled kernel density estimates for random locations over which we can include the sites specific trends (**Figure 4**).</span>
<span id="cb11-423"><a href="#cb11-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-424"><a href="#cb11-424" aria-hidden="true" tabindex="-1"></a><span class="in">```{r filename="Figure 4.R"}</span></span>
<span id="cb11-425"><a href="#cb11-425" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Figure 4. Site trends versus the terrain background. The solid line in the graphs represents the sites; The dashed line corresponds to the median of the random points; The shaded area is the confidence intervals (5%, 95%) based upon 999 Monte Carlo Simulations placed over the study area (based on Kempf, Günther, 2022; Bocinsky, 2017)."</span></span>
<span id="cb11-426"><a href="#cb11-426" aria-hidden="true" tabindex="-1"></a><span class="in"># Load required packages</span></span>
<span id="cb11-427"><a href="#cb11-427" aria-hidden="true" tabindex="-1"></a><span class="in">spatpack &lt;- c("sf", "terra", </span></span>
<span id="cb11-428"><a href="#cb11-428" aria-hidden="true" tabindex="-1"></a><span class="in">              "spatstat", "plotly", </span></span>
<span id="cb11-429"><a href="#cb11-429" aria-hidden="true" tabindex="-1"></a><span class="in">              "foreach", "dplyr", </span></span>
<span id="cb11-430"><a href="#cb11-430" aria-hidden="true" tabindex="-1"></a><span class="in">              "progress", "purrr", </span></span>
<span id="cb11-431"><a href="#cb11-431" aria-hidden="true" tabindex="-1"></a><span class="in">              "reshape2", "broom")</span></span>
<span id="cb11-432"><a href="#cb11-432" aria-hidden="true" tabindex="-1"></a><span class="in">invisible(lapply(spatpack, require, character.only=TRUE))</span></span>
<span id="cb11-433"><a href="#cb11-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-434"><a href="#cb11-434" aria-hidden="true" tabindex="-1"></a><span class="in"># Define working directories</span></span>
<span id="cb11-435"><a href="#cb11-435" aria-hidden="true" tabindex="-1"></a><span class="in">grid &lt;- file.path("grid")</span></span>
<span id="cb11-436"><a href="#cb11-436" aria-hidden="true" tabindex="-1"></a><span class="in">shp &lt;- file.path("shp")</span></span>
<span id="cb11-437"><a href="#cb11-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-438"><a href="#cb11-438" aria-hidden="true" tabindex="-1"></a><span class="in"># Define the coordinate reference system (CRS)</span></span>
<span id="cb11-439"><a href="#cb11-439" aria-hidden="true" tabindex="-1"></a><span class="in">crs &lt;- "+proj=utm +zone=29 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"</span></span>
<span id="cb11-440"><a href="#cb11-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-441"><a href="#cb11-441" aria-hidden="true" tabindex="-1"></a><span class="in"># Read sites and study area</span></span>
<span id="cb11-442"><a href="#cb11-442" aria-hidden="true" tabindex="-1"></a><span class="in">sites &lt;- invisible(suppressMessages(st_read(file.path(shp_path, "sites_lab.shp"), quiet = TRUE) %&gt;% st_transform(4326)))</span></span>
<span id="cb11-443"><a href="#cb11-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-444"><a href="#cb11-444" aria-hidden="true" tabindex="-1"></a><span class="in"># Read covariates using terra</span></span>
<span id="cb11-445"><a href="#cb11-445" aria-hidden="true" tabindex="-1"></a><span class="in">dem &lt;- terra::rast("grid/dtm.tif")</span></span>
<span id="cb11-446"><a href="#cb11-446" aria-hidden="true" tabindex="-1"></a><span class="in">slope &lt;- terra::rast("grid/slope.tif")</span></span>
<span id="cb11-447"><a href="#cb11-447" aria-hidden="true" tabindex="-1"></a><span class="in">cum_horizon &lt;- terra::rast("grid/cum_horizon.tif")</span></span>
<span id="cb11-448"><a href="#cb11-448" aria-hidden="true" tabindex="-1"></a><span class="in">cum_viewshed &lt;- terra::rast("grid/cum_viewshed.tif")</span></span>
<span id="cb11-449"><a href="#cb11-449" aria-hidden="true" tabindex="-1"></a><span class="in">dist_to_ridges &lt;- terra::rast("grid/dist_to_ridges.tif")</span></span>
<span id="cb11-450"><a href="#cb11-450" aria-hidden="true" tabindex="-1"></a><span class="in">dist_to_rocks &lt;- terra::rast("grid/dist_to_rocks.tif")</span></span>
<span id="cb11-451"><a href="#cb11-451" aria-hidden="true" tabindex="-1"></a><span class="in">dist_to_watedges &lt;- terra::rast("grid/dist_to_wat_edges.tif")</span></span>
<span id="cb11-452"><a href="#cb11-452" aria-hidden="true" tabindex="-1"></a><span class="in">tpi &lt;- terra::rast("grid/tpi.tif")</span></span>
<span id="cb11-453"><a href="#cb11-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-454"><a href="#cb11-454" aria-hidden="true" tabindex="-1"></a><span class="in"># Part 1: Calculate and plot kernel density estimates with Monte Carlo subsampling</span></span>
<span id="cb11-455"><a href="#cb11-455" aria-hidden="true" tabindex="-1"></a><span class="in"># Compare the sites with the covariates</span></span>
<span id="cb11-456"><a href="#cb11-456" aria-hidden="true" tabindex="-1"></a><span class="in">source('r_functions/rbias_sitesVSbackground.R')</span></span>
<span id="cb11-457"><a href="#cb11-457" aria-hidden="true" tabindex="-1"></a><span class="in">source('r_functions/rbias_simulationresults.R')</span></span>
<span id="cb11-458"><a href="#cb11-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-459"><a href="#cb11-459" aria-hidden="true" tabindex="-1"></a><span class="in"># Create a function to iterate the simulation process</span></span>
<span id="cb11-460"><a href="#cb11-460" aria-hidden="true" tabindex="-1"></a><span class="in">perform_simulation &lt;- function(covariate, covariate_name) {</span></span>
<span id="cb11-461"><a href="#cb11-461" aria-hidden="true" tabindex="-1"></a><span class="in">  simulation_result &lt;- sites_vs_background(covariate = covariate,</span></span>
<span id="cb11-462"><a href="#cb11-462" aria-hidden="true" tabindex="-1"></a><span class="in">                                           sites = sites,</span></span>
<span id="cb11-463"><a href="#cb11-463" aria-hidden="true" tabindex="-1"></a><span class="in">                                           nsim = 999,</span></span>
<span id="cb11-464"><a href="#cb11-464" aria-hidden="true" tabindex="-1"></a><span class="in">                                           covariate_name = covariate_name)</span></span>
<span id="cb11-465"><a href="#cb11-465" aria-hidden="true" tabindex="-1"></a><span class="in">  return(simulation_result)</span></span>
<span id="cb11-466"><a href="#cb11-466" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb11-467"><a href="#cb11-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-468"><a href="#cb11-468" aria-hidden="true" tabindex="-1"></a><span class="in"># Define a list of covariates and their corresponding names</span></span>
<span id="cb11-469"><a href="#cb11-469" aria-hidden="true" tabindex="-1"></a><span class="in">covariates &lt;- list(</span></span>
<span id="cb11-470"><a href="#cb11-470" aria-hidden="true" tabindex="-1"></a><span class="in">  dem = "Altitude mASL", </span></span>
<span id="cb11-471"><a href="#cb11-471" aria-hidden="true" tabindex="-1"></a><span class="in">  slope = "Slope %",</span></span>
<span id="cb11-472"><a href="#cb11-472" aria-hidden="true" tabindex="-1"></a><span class="in">  cum_viewshed = "Cumulative Viewshed",</span></span>
<span id="cb11-473"><a href="#cb11-473" aria-hidden="true" tabindex="-1"></a><span class="in">  dist_to_ridges = "Distance to Ridges",</span></span>
<span id="cb11-474"><a href="#cb11-474" aria-hidden="true" tabindex="-1"></a><span class="in">  dist_to_watedges = "Distance to Water Edges",</span></span>
<span id="cb11-475"><a href="#cb11-475" aria-hidden="true" tabindex="-1"></a><span class="in">  tpi = "Topographic Position Index (TPI)"</span></span>
<span id="cb11-476"><a href="#cb11-476" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb11-477"><a href="#cb11-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-478"><a href="#cb11-478" aria-hidden="true" tabindex="-1"></a><span class="in"># Apply the simulation function to each covariate</span></span>
<span id="cb11-479"><a href="#cb11-479" aria-hidden="true" tabindex="-1"></a><span class="in">simulation_results &lt;- lapply(names(covariates), </span></span>
<span id="cb11-480"><a href="#cb11-480" aria-hidden="true" tabindex="-1"></a><span class="in">                             function(covariate) {</span></span>
<span id="cb11-481"><a href="#cb11-481" aria-hidden="true" tabindex="-1"></a><span class="in">  perform_simulation(get(covariate), </span></span>
<span id="cb11-482"><a href="#cb11-482" aria-hidden="true" tabindex="-1"></a><span class="in">                     covariates[[covariate]])</span></span>
<span id="cb11-483"><a href="#cb11-483" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb11-484"><a href="#cb11-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-485"><a href="#cb11-485" aria-hidden="true" tabindex="-1"></a><span class="in"># Plot</span></span>
<span id="cb11-486"><a href="#cb11-486" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(2, 3), mar = c(5, 5, 2, 3))</span></span>
<span id="cb11-487"><a href="#cb11-487" aria-hidden="true" tabindex="-1"></a><span class="in">for (i in seq_along(simulation_results)) {</span></span>
<span id="cb11-488"><a href="#cb11-488" aria-hidden="true" tabindex="-1"></a><span class="in">  simulation_result &lt;- simulation_results[[i]]</span></span>
<span id="cb11-489"><a href="#cb11-489" aria-hidden="true" tabindex="-1"></a><span class="in">  if (!is.null(simulation_result)) {</span></span>
<span id="cb11-490"><a href="#cb11-490" aria-hidden="true" tabindex="-1"></a><span class="in">    # Create the plot using simulation_results_plot()</span></span>
<span id="cb11-491"><a href="#cb11-491" aria-hidden="true" tabindex="-1"></a><span class="in">    simulation_results_plot(simulation_result, show_title = FALSE)</span></span>
<span id="cb11-492"><a href="#cb11-492" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb11-493"><a href="#cb11-493" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb11-494"><a href="#cb11-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-495"><a href="#cb11-495" aria-hidden="true" tabindex="-1"></a><span class="in"># Part 2 Compute two-sample Wilcoxon tests (Mann-Whitney U tests)</span></span>
<span id="cb11-496"><a href="#cb11-496" aria-hidden="true" tabindex="-1"></a><span class="in"># Generate random background samples for each covariate</span></span>
<span id="cb11-497"><a href="#cb11-497" aria-hidden="true" tabindex="-1"></a><span class="in">random_samples &lt;- lapply(simulation_results, function(simulation_result) {</span></span>
<span id="cb11-498"><a href="#cb11-498" aria-hidden="true" tabindex="-1"></a><span class="in">  if (is.null(simulation_result)) return(NULL)</span></span>
<span id="cb11-499"><a href="#cb11-499" aria-hidden="true" tabindex="-1"></a><span class="in">  ras_samples &lt;- simulation_result$ras_samples</span></span>
<span id="cb11-500"><a href="#cb11-500" aria-hidden="true" tabindex="-1"></a><span class="in">  lapply(ras_samples, function(ras_sample) {</span></span>
<span id="cb11-501"><a href="#cb11-501" aria-hidden="true" tabindex="-1"></a><span class="in">    sample(ras_sample, </span></span>
<span id="cb11-502"><a href="#cb11-502" aria-hidden="true" tabindex="-1"></a><span class="in">           length(simulation_result$sites_densities$Covariate), </span></span>
<span id="cb11-503"><a href="#cb11-503" aria-hidden="true" tabindex="-1"></a><span class="in">           replace = TRUE)</span></span>
<span id="cb11-504"><a href="#cb11-504" aria-hidden="true" tabindex="-1"></a><span class="in">  })</span></span>
<span id="cb11-505"><a href="#cb11-505" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb11-506"><a href="#cb11-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-507"><a href="#cb11-507" aria-hidden="true" tabindex="-1"></a><span class="in"># Create a progress bar</span></span>
<span id="cb11-508"><a href="#cb11-508" aria-hidden="true" tabindex="-1"></a><span class="in">pb &lt;- progress_bar$new(total = length(simulation_results), </span></span>
<span id="cb11-509"><a href="#cb11-509" aria-hidden="true" tabindex="-1"></a><span class="in">                       format = "[:bar] :percent :eta")</span></span>
<span id="cb11-510"><a href="#cb11-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-511"><a href="#cb11-511" aria-hidden="true" tabindex="-1"></a><span class="in"># Perform Wilcoxon test for each covariate</span></span>
<span id="cb11-512"><a href="#cb11-512" aria-hidden="true" tabindex="-1"></a><span class="in">wilcoxon_results &lt;- lapply(seq_along(simulation_results), function(i) {</span></span>
<span id="cb11-513"><a href="#cb11-513" aria-hidden="true" tabindex="-1"></a><span class="in">  simulation_result &lt;- simulation_results[[i]]</span></span>
<span id="cb11-514"><a href="#cb11-514" aria-hidden="true" tabindex="-1"></a><span class="in">  background_samples &lt;- random_samples[[i]]</span></span>
<span id="cb11-515"><a href="#cb11-515" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb11-516"><a href="#cb11-516" aria-hidden="true" tabindex="-1"></a><span class="in">  if (is.null(simulation_result) || is.null(background_samples)) {</span></span>
<span id="cb11-517"><a href="#cb11-517" aria-hidden="true" tabindex="-1"></a><span class="in">    return(NULL)</span></span>
<span id="cb11-518"><a href="#cb11-518" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb11-519"><a href="#cb11-519" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb11-520"><a href="#cb11-520" aria-hidden="true" tabindex="-1"></a><span class="in">  # Update progress bar</span></span>
<span id="cb11-521"><a href="#cb11-521" aria-hidden="true" tabindex="-1"></a><span class="in">  pb$tick()</span></span>
<span id="cb11-522"><a href="#cb11-522" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb11-523"><a href="#cb11-523" aria-hidden="true" tabindex="-1"></a><span class="in">  # Perform Wilcoxon test for each background sample</span></span>
<span id="cb11-524"><a href="#cb11-524" aria-hidden="true" tabindex="-1"></a><span class="in">  wilcoxon_test_results &lt;- lapply(background_samples, function(background_sample) {</span></span>
<span id="cb11-525"><a href="#cb11-525" aria-hidden="true" tabindex="-1"></a><span class="in">    if (length(background_sample) &lt; 2 || </span></span>
<span id="cb11-526"><a href="#cb11-526" aria-hidden="true" tabindex="-1"></a><span class="in">        length(simulation_result$sites_densities$Covariate) &lt; 2) {</span></span>
<span id="cb11-527"><a href="#cb11-527" aria-hidden="true" tabindex="-1"></a><span class="in">      return(data.frame(statistic = NA, p.value = NA))</span></span>
<span id="cb11-528"><a href="#cb11-528" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb11-529"><a href="#cb11-529" aria-hidden="true" tabindex="-1"></a><span class="in">    result &lt;- wilcox.test(simulation_result$sites_densities$Covariate, </span></span>
<span id="cb11-530"><a href="#cb11-530" aria-hidden="true" tabindex="-1"></a><span class="in">                          background_sample, </span></span>
<span id="cb11-531"><a href="#cb11-531" aria-hidden="true" tabindex="-1"></a><span class="in">                          alternative = "greater", </span></span>
<span id="cb11-532"><a href="#cb11-532" aria-hidden="true" tabindex="-1"></a><span class="in">                          exact = FALSE)</span></span>
<span id="cb11-533"><a href="#cb11-533" aria-hidden="true" tabindex="-1"></a><span class="in">    broom::tidy(result) %&gt;% select(statistic, p.value)</span></span>
<span id="cb11-534"><a href="#cb11-534" aria-hidden="true" tabindex="-1"></a><span class="in">  })</span></span>
<span id="cb11-535"><a href="#cb11-535" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb11-536"><a href="#cb11-536" aria-hidden="true" tabindex="-1"></a><span class="in">  # Combine the results</span></span>
<span id="cb11-537"><a href="#cb11-537" aria-hidden="true" tabindex="-1"></a><span class="in">  wilcoxon_test_results &lt;- bind_rows(wilcoxon_test_results)</span></span>
<span id="cb11-538"><a href="#cb11-538" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb11-539"><a href="#cb11-539" aria-hidden="true" tabindex="-1"></a><span class="in">  # Get the median test statistic and 95% confidence interval</span></span>
<span id="cb11-540"><a href="#cb11-540" aria-hidden="true" tabindex="-1"></a><span class="in">  wilcoxon_summary &lt;- foreach::foreach(prob = c(0.025, 0.5, 0.975), .combine = rbind) %do% {</span></span>
<span id="cb11-541"><a href="#cb11-541" aria-hidden="true" tabindex="-1"></a><span class="in">    wilcoxon_test_results %&gt;%</span></span>
<span id="cb11-542"><a href="#cb11-542" aria-hidden="true" tabindex="-1"></a><span class="in">      dplyr::summarise_all(quantile, probs = prob)</span></span>
<span id="cb11-543"><a href="#cb11-543" aria-hidden="true" tabindex="-1"></a><span class="in">  } %&gt;%</span></span>
<span id="cb11-544"><a href="#cb11-544" aria-hidden="true" tabindex="-1"></a><span class="in">    t() %&gt;%</span></span>
<span id="cb11-545"><a href="#cb11-545" aria-hidden="true" tabindex="-1"></a><span class="in">    magrittr::set_colnames(c("Lower CI", "Median", "Upper CI"))</span></span>
<span id="cb11-546"><a href="#cb11-546" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb11-547"><a href="#cb11-547" aria-hidden="true" tabindex="-1"></a><span class="in">  # Create a data frame for the covariate and add covariate_name</span></span>
<span id="cb11-548"><a href="#cb11-548" aria-hidden="true" tabindex="-1"></a><span class="in">  covariate_summary &lt;- data.frame(covariate = names(covariates)[i])</span></span>
<span id="cb11-549"><a href="#cb11-549" aria-hidden="true" tabindex="-1"></a><span class="in">  wilcoxon_summary &lt;- cbind(covariate_summary, wilcoxon_summary)</span></span>
<span id="cb11-550"><a href="#cb11-550" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb11-551"><a href="#cb11-551" aria-hidden="true" tabindex="-1"></a><span class="in">  return(wilcoxon_summary)</span></span>
<span id="cb11-552"><a href="#cb11-552" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb11-553"><a href="#cb11-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-554"><a href="#cb11-554" aria-hidden="true" tabindex="-1"></a><span class="in"># Combine the results for all covariates</span></span>
<span id="cb11-555"><a href="#cb11-555" aria-hidden="true" tabindex="-1"></a><span class="in">wilcoxon_results &lt;- do.call(rbind, wilcoxon_results)</span></span>
<span id="cb11-556"><a href="#cb11-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-557"><a href="#cb11-557" aria-hidden="true" tabindex="-1"></a><span class="in">wilcoxon_results</span></span>
<span id="cb11-558"><a href="#cb11-558" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-559"><a href="#cb11-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-560"><a href="#cb11-560" aria-hidden="true" tabindex="-1"></a>The Mann-Whitney test, commonly referred to as Wilcoxon rank-sum test, is a non-parametric test used to observe and compare two independent groups, assessing if there is or not a statistically significant difference between the distribution of a variable in said independent groups. In this case, this translates to whether there is a statistically significant difference between the points distribution – the tumular structures – and the geomorphological constraints that were modelled, tested against a set of randomly generated points alongside the study area via 999 Monte Carlo simulations (Conolly &amp; Lake, 2006: 127; Kvamme, 2020: 218; Günther, et al. 2022; Bocinsky, 2017).</span>
<span id="cb11-561"><a href="#cb11-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-562"><a href="#cb11-562" aria-hidden="true" tabindex="-1"></a>The usefulness in using this method relies on the fact that it is not dependent on previous assumptions about the underlying data distribution. Our chosen confidence level was defined at 95%, with a *p*-value below 0.05. A value under that threshold represents a statistically significant difference between the real sample and random sample. We also include the U Statistic, a confidence interval which allows us to quantify the difference in ranks between the archaeological sample and a random one, that mean in our case, the ranks of the covariate values at site locations versus those at random background locations. The results are provided in the supplementary material (under csv folder).</span>
<span id="cb11-563"><a href="#cb11-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-564"><a href="#cb11-564" aria-hidden="true" tabindex="-1"></a>We can forward that, of all the 8 variables that were modelled – Altitude, Slope, Cumulative Horizon, Cumulative viewshed, Distance to Ridges, Distance to Water Edges, Distance to Rock Outcrops, Topographic Prominence – only Altitude seems to possess a considerate level of significance for Laboreiro’s distribution.</span>
<span id="cb11-565"><a href="#cb11-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-566"><a href="#cb11-566" aria-hidden="true" tabindex="-1"></a><span class="fu">## **4. Laboreiro's spatial structure based on the monuments**</span></span>
<span id="cb11-567"><a href="#cb11-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-568"><a href="#cb11-568" aria-hidden="true" tabindex="-1"></a>We’ve established that these points — whether in clusters or isolated — might be representing distinct (social)landscapes at different times. But, by analysing them together with these digital methods we end up merging different landscapes into one, and we overlook the true diversity and dynamism of this territory. Our main challenge, then, becomes: how do we account for the fact that these methods and tests inherently treat a landscape that has evolved over time as if it were static and unchanging?</span>
<span id="cb11-569"><a href="#cb11-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-570"><a href="#cb11-570" aria-hidden="true" tabindex="-1"></a>So, it comes with no surprise that, at least one variable – altitude – stands out as the most important one statistically. This can be translated to “altitude prevailed as a variable of transversal importance for many centuries in association with this phenomenon”.</span>
<span id="cb11-571"><a href="#cb11-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-572"><a href="#cb11-572" aria-hidden="true" tabindex="-1"></a>The glimpses of other human choices lie in the other slightly less statistically relevant variables, perhaps precisely in response to the already established relation with altitude and mountain environments and the many adaptations said relations took throughout the centuries.</span>
<span id="cb11-573"><a href="#cb11-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-574"><a href="#cb11-574" aria-hidden="true" tabindex="-1"></a>It is important to separate the two: what the statistical results say in opposition to what it means in terms of human interpretation of the terrain. And here lies the basis in understanding Laboreiro’s true spatial structure. So, even though the variable representing altitude was revealed to be the most important one, there are, indeed, points of significance denoted by the variables of cumulative horizon, distance to ridges, rock outcrops and watershed edges, and these appear to be the ones showcasing the main spatial tendency and/or the main geomorphological features these several people had to *play* and compromise with.</span>
<span id="cb11-575"><a href="#cb11-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-576"><a href="#cb11-576" aria-hidden="true" tabindex="-1"></a>The placement of these monuments was a choice as cultural, social, or symbolic, in as much it was a response to geomorphological constraints, which ultimately shaped the way the landscape was socially constructed – a truly quasi-symbiotic relation with space and natural shapes.</span>
<span id="cb11-577"><a href="#cb11-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-578"><a href="#cb11-578" aria-hidden="true" tabindex="-1"></a>So, with the altitude variable, we are observing a concentration of monuments that were implanted from 800mASL up until 1200mASL, thence, this is the variable that defines the pattern within these heights *for the totality of the study area initially proposed*. But we can also see that there’s also a significant mark between the 400-600mASL.</span>
<span id="cb11-579"><a href="#cb11-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-580"><a href="#cb11-580" aria-hidden="true" tabindex="-1"></a>Visibility will also always remain an important and unavoidable aspect when crossing any territory. The results of those two variables (Cumulative Viewshed and Horizon) might not have been as promising as expected due to this high level of structural heterogeneity that couldn’t be modelled (out of lack of formal data). So, if the altitude is being deemed as the main feature for this distribution, it becomes understandable why the horizon and the ridges are diverting some attention as well. Lines in the horizon will always be visible elements, and they can articulate how a territory can be perceived, manipulated and managed (and even how to socially and culturally limit it). The same goes for drainage divides or even the distance to sources of raw materials.</span>
<span id="cb11-581"><a href="#cb11-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-582"><a href="#cb11-582" aria-hidden="true" tabindex="-1"></a>In terms of point distribution — specifically the placement of monuments — it is reasonable to assume that some monuments, perhaps the earliest ones, played a defining role in shaping how the landscape was later organized. These initial structures may have influenced and constrained how subsequent communities engaged with the territory, whether by reinforcing existing spatial patterns or deliberately rejecting them. In this way, monument placement not only reflected but also actively shaped the way people perceived, used, and interacted with the landscape over time.</span>
<span id="cb11-583"><a href="#cb11-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-584"><a href="#cb11-584" aria-hidden="true" tabindex="-1"></a>And we started noticing that only a portion of the chosen study area, and only a portion of those 178 points is truly demarcating these aspects. We tested this hypothesis by conducting a simple test considering the entirety of the study area and all the points against the Cumulative Horizon raster variable (**Fig. 5**), by using a simple Intervisibility Network Analysis in QGIS v. 3.28 (see Čučković, 2024: 230-247).</span>
<span id="cb11-585"><a href="#cb11-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-586"><a href="#cb11-586" aria-hidden="true" tabindex="-1"></a><span class="in">```{r filename="Figure 5.R", message = FALSE, warning = FALSE}</span></span>
<span id="cb11-587"><a href="#cb11-587" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Figure 5. Visual networks over the mounds in Laboreiro region, now with 138 points (A), created with the visibility analysis plugin from QGIS (Čučković, 2016), and our hypothesis on this being the main geomorphological spatial constraint for the tumular landscape of Laboreiro (B)."</span></span>
<span id="cb11-588"><a href="#cb11-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-589"><a href="#cb11-589" aria-hidden="true" tabindex="-1"></a><span class="in"># Load libraries</span></span>
<span id="cb11-590"><a href="#cb11-590" aria-hidden="true" tabindex="-1"></a><span class="in">spatpack&lt;-c("terra","viridis", "sf")</span></span>
<span id="cb11-591"><a href="#cb11-591" aria-hidden="true" tabindex="-1"></a><span class="in">invisible(lapply(spatpack, require, character.only=TRUE))</span></span>
<span id="cb11-592"><a href="#cb11-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-593"><a href="#cb11-593" aria-hidden="true" tabindex="-1"></a><span class="in"># Set working directory</span></span>
<span id="cb11-594"><a href="#cb11-594" aria-hidden="true" tabindex="-1"></a><span class="in">setwd("~/Desktop/Laboreiro/")</span></span>
<span id="cb11-595"><a href="#cb11-595" aria-hidden="true" tabindex="-1"></a><span class="in">shp_path &lt;- file.path("shp")</span></span>
<span id="cb11-596"><a href="#cb11-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-597"><a href="#cb11-597" aria-hidden="true" tabindex="-1"></a><span class="in"># Load rasters</span></span>
<span id="cb11-598"><a href="#cb11-598" aria-hidden="true" tabindex="-1"></a><span class="in">rast &lt;- rast(paste0("/Users/miguelpazoscarrero/Desktop/Laboreiro/grid/","cum_horizon.tif"))</span></span>
<span id="cb11-599"><a href="#cb11-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-600"><a href="#cb11-600" aria-hidden="true" tabindex="-1"></a><span class="in"># Load shapefiles</span></span>
<span id="cb11-601"><a href="#cb11-601" aria-hidden="true" tabindex="-1"></a><span class="in">sites_lab &lt;- invisible(suppressMessages(st_read(file.path(shp_path, "sites_lab.shp"), quiet = TRUE)))</span></span>
<span id="cb11-602"><a href="#cb11-602" aria-hidden="true" tabindex="-1"></a><span class="in">sites_all &lt;-invisible(suppressMessages(st_read(file.path(shp_path, "sites_all.shp"), quiet = TRUE)))</span></span>
<span id="cb11-603"><a href="#cb11-603" aria-hidden="true" tabindex="-1"></a><span class="in">intervisibility &lt;- invisible(suppressMessages(st_read("/Users/miguelpazoscarrero/Desktop/Laboreiro/shp/intervisibility_sites.shp", quiet = TRUE)))</span></span>
<span id="cb11-604"><a href="#cb11-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-605"><a href="#cb11-605" aria-hidden="true" tabindex="-1"></a><span class="in"># Generate a terrain-like color palette with transparency</span></span>
<span id="cb11-606"><a href="#cb11-606" aria-hidden="true" tabindex="-1"></a><span class="in">create_transparent_palette &lt;- function(colors, alpha_values) {</span></span>
<span id="cb11-607"><a href="#cb11-607" aria-hidden="true" tabindex="-1"></a><span class="in">  rgb_values &lt;- col2rgb(colors) / 255</span></span>
<span id="cb11-608"><a href="#cb11-608" aria-hidden="true" tabindex="-1"></a><span class="in">  apply(rgb_values, 2, function(col) {</span></span>
<span id="cb11-609"><a href="#cb11-609" aria-hidden="true" tabindex="-1"></a><span class="in">    rgb(col[1], col[2], col[3], alpha = alpha_values)</span></span>
<span id="cb11-610"><a href="#cb11-610" aria-hidden="true" tabindex="-1"></a><span class="in">  })</span></span>
<span id="cb11-611"><a href="#cb11-611" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb11-612"><a href="#cb11-612" aria-hidden="true" tabindex="-1"></a><span class="in">n_colors &lt;- 100</span></span>
<span id="cb11-613"><a href="#cb11-613" aria-hidden="true" tabindex="-1"></a><span class="in">terrain_colors &lt;- terrain.colors(n_colors)</span></span>
<span id="cb11-614"><a href="#cb11-614" aria-hidden="true" tabindex="-1"></a><span class="in">alpha_values &lt;- seq(0.1, 1, length.out = n_colors)</span></span>
<span id="cb11-615"><a href="#cb11-615" aria-hidden="true" tabindex="-1"></a><span class="in">transparent_palette &lt;- create_transparent_palette(terrain_colors, alpha_values)</span></span>
<span id="cb11-616"><a href="#cb11-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-617"><a href="#cb11-617" aria-hidden="true" tabindex="-1"></a><span class="in"># Plot figure 5      </span></span>
<span id="cb11-618"><a href="#cb11-618" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(1, 2))</span></span>
<span id="cb11-619"><a href="#cb11-619" aria-hidden="true" tabindex="-1"></a><span class="in">plot(rast, main = "A", </span></span>
<span id="cb11-620"><a href="#cb11-620" aria-hidden="true" tabindex="-1"></a><span class="in">     col = transparent_palette)</span></span>
<span id="cb11-621"><a href="#cb11-621" aria-hidden="true" tabindex="-1"></a><span class="in">plot(intervisibility$geometry, add = TRUE, lwd = 0.3)</span></span>
<span id="cb11-622"><a href="#cb11-622" aria-hidden="true" tabindex="-1"></a><span class="in">plot(sites_lab$geometry, add = TRUE, pch = 21, cex = 0.8)</span></span>
<span id="cb11-623"><a href="#cb11-623" aria-hidden="true" tabindex="-1"></a><span class="in">plot(rast, main = "B", </span></span>
<span id="cb11-624"><a href="#cb11-624" aria-hidden="true" tabindex="-1"></a><span class="in">     col = transparent_palette)</span></span>
<span id="cb11-625"><a href="#cb11-625" aria-hidden="true" tabindex="-1"></a><span class="in">plot(sites_all$geometry, add = TRUE, pch = 21, cex = 0.8)</span></span>
<span id="cb11-626"><a href="#cb11-626" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-627"><a href="#cb11-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-628"><a href="#cb11-628" aria-hidden="true" tabindex="-1"></a>This was an exercise to try and determine or directly observe if there is a network structure based on visibility form the monuments’ implantation. In Figure 5A, we noticed the existence of areas almost devoid of visibility relations, or, at least, with very specific and/or more local ones – perhaps the ones that might be causing discrepancies in our statistical analysis. This made us reduce our area of analysis to one that would better help us understand the previously stated hypothesis (Figure 5B): *there are monuments that ended up dictating how this landscape could be arranged considering the main geomorphological features and how people might’ve committed with them.*</span>
<span id="cb11-629"><a href="#cb11-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-630"><a href="#cb11-630" aria-hidden="true" tabindex="-1"></a>From a direct observation perspective, we can see that the monuments tend to align with key landscape features highlighted by the Cumulative Horizon raster variable. At the same time, a distinct portion of the landscape stands out due to the clustering of monuments, suggesting an emphasis on a specific territorial organization. Out of the initial 178 points, we refined our sample to 138 monuments that appear to strongly represent the primary territorial layout of Laboreiro (Fig. 5a).<span class="ot">[^3]</span></span>
<span id="cb11-631"><a href="#cb11-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-632"><a href="#cb11-632" aria-hidden="true" tabindex="-1"></a><span class="ot">[^3]: </span>Here, we distance ourselves from D. Fraser’s thesis where he debated whether a monument’s (inter)visibility (or lack thereof) serves as a confirmation of the existence of social power structures (see Brughmans &amp; Brandes (2017) on Fraser (1980)).</span>
<span id="cb11-633"><a href="#cb11-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-634"><a href="#cb11-634" aria-hidden="true" tabindex="-1"></a>What this could entail is that the megalithic sites are not creating a visual network of the landscape, but demarcating one that already existed, only now materialized with these constructions as social markers of the living territories.</span>
<span id="cb11-635"><a href="#cb11-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-636"><a href="#cb11-636" aria-hidden="true" tabindex="-1"></a>In the end, these variables end up determining the main perceived shapes of a given territory – from lines on the horizon, to true physical landmarks against them.</span>
<span id="cb11-637"><a href="#cb11-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-638"><a href="#cb11-638" aria-hidden="true" tabindex="-1"></a>To formally address this idea, we can use a logistic regression approach combined with the creation of three spatial point process models which allow us to deeply understand the characteristics of the spatial distribution of the mounds (see Carrero-Pazos, Bevan &amp; Lake 2019 for the original approach we are using here).</span>
<span id="cb11-639"><a href="#cb11-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-640"><a href="#cb11-640" aria-hidden="true" tabindex="-1"></a>The logistic regression map was built using the selected covariates in this research (elevation, cumulative horizon, slope and a raster variable resulting from the sum of precisely those&nbsp; main geomorphological features: rock outcrops, ridges and watershed edges), allowing us to understand to what extent the selected environmental variables are influencing the placement of the mounds (**Figure 6b**), and what could be the relation of the 138 sites between themselves (**Figure 6c**). All those analyses were built in *R Statistics* using the *Spatstat* package (Baddeley et al. 2016).</span>
<span id="cb11-641"><a href="#cb11-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-642"><a href="#cb11-642" aria-hidden="true" tabindex="-1"></a><span class="in">```{r filename="Figure 6.R", message = FALSE, warning = FALSE}</span></span>
<span id="cb11-643"><a href="#cb11-643" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Figure 6. Spatial statistical models to understand the role between the mounds and their surrounding environment. a) purely random model; b) 999 random simulations based on the covariates -first-order surface-; c) 999 random simulations based on the first-order surface and an area interaction model for each point."</span></span>
<span id="cb11-644"><a href="#cb11-644" aria-hidden="true" tabindex="-1"></a><span class="in"># Load R Packages</span></span>
<span id="cb11-645"><a href="#cb11-645" aria-hidden="true" tabindex="-1"></a><span class="in">spatpack&lt;-c("raster","spatstat", "sp")</span></span>
<span id="cb11-646"><a href="#cb11-646" aria-hidden="true" tabindex="-1"></a><span class="in">invisible(lapply(spatpack, require, character.only=TRUE))</span></span>
<span id="cb11-647"><a href="#cb11-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-648"><a href="#cb11-648" aria-hidden="true" tabindex="-1"></a><span class="in"># Load raster covariates</span></span>
<span id="cb11-649"><a href="#cb11-649" aria-hidden="true" tabindex="-1"></a><span class="in">elevation &lt;- raster("grid/dtm.tif")</span></span>
<span id="cb11-650"><a href="#cb11-650" aria-hidden="true" tabindex="-1"></a><span class="in">cumulative_horizon &lt;- raster("grid/cum_horizon.tif")</span></span>
<span id="cb11-651"><a href="#cb11-651" aria-hidden="true" tabindex="-1"></a><span class="in">geomorph &lt;- raster("grid/sum_structure.tif")</span></span>
<span id="cb11-652"><a href="#cb11-652" aria-hidden="true" tabindex="-1"></a><span class="in">slope &lt;- raster("grid/slope.tif")</span></span>
<span id="cb11-653"><a href="#cb11-653" aria-hidden="true" tabindex="-1"></a><span class="in">cumulative_viewshed &lt;- raster("grid/cum_viewshed.tif")</span></span>
<span id="cb11-654"><a href="#cb11-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-655"><a href="#cb11-655" aria-hidden="true" tabindex="-1"></a><span class="in"># Load sites</span></span>
<span id="cb11-656"><a href="#cb11-656" aria-hidden="true" tabindex="-1"></a><span class="in">sites &lt;- invisible(suppressMessages(st_read(file.path(shp_path, "sites_lab.shp"), quiet = TRUE) %&gt;% st_transform(4326)))</span></span>
<span id="cb11-657"><a href="#cb11-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-658"><a href="#cb11-658" aria-hidden="true" tabindex="-1"></a><span class="in"># Create spatial point pattern process</span></span>
<span id="cb11-659"><a href="#cb11-659" aria-hidden="true" tabindex="-1"></a><span class="in">study_area &lt;- invisible(suppressMessages(st_read(file.path(shp_path, "mask.shp"), quiet = TRUE)))</span></span>
<span id="cb11-660"><a href="#cb11-660" aria-hidden="true" tabindex="-1"></a><span class="in">area &lt;- as.owin(study_area)</span></span>
<span id="cb11-661"><a href="#cb11-661" aria-hidden="true" tabindex="-1"></a><span class="in">sppp &lt;- ppp(x=sites$X, y=sites$Y, window=area)</span></span>
<span id="cb11-662"><a href="#cb11-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-663"><a href="#cb11-663" aria-hidden="true" tabindex="-1"></a><span class="in"># Convert raster to image</span></span>
<span id="cb11-664"><a href="#cb11-664" aria-hidden="true" tabindex="-1"></a><span class="in"># Elevation</span></span>
<span id="cb11-665"><a href="#cb11-665" aria-hidden="true" tabindex="-1"></a><span class="in">## Get the matrix of values from the raster</span></span>
<span id="cb11-666"><a href="#cb11-666" aria-hidden="true" tabindex="-1"></a><span class="in">elev_matrix &lt;- as.matrix(elevation)</span></span>
<span id="cb11-667"><a href="#cb11-667" aria-hidden="true" tabindex="-1"></a><span class="in">## Get the coordinates for the raster, ensuring they match the matrix dimensions</span></span>
<span id="cb11-668"><a href="#cb11-668" aria-hidden="true" tabindex="-1"></a><span class="in">x_coords_elev &lt;- seq(xmin(elevation), xmax(elevation), length.out = ncol(elev_matrix))</span></span>
<span id="cb11-669"><a href="#cb11-669" aria-hidden="true" tabindex="-1"></a><span class="in">y_coords_elev &lt;- seq(ymin(elevation), ymax(elevation), length.out = nrow(elev_matrix))</span></span>
<span id="cb11-670"><a href="#cb11-670" aria-hidden="true" tabindex="-1"></a><span class="in">## Create the im object using the matrix and coordinates</span></span>
<span id="cb11-671"><a href="#cb11-671" aria-hidden="true" tabindex="-1"></a><span class="in">elev_im &lt;- spatstat.geom::as.im(X = elev_matrix, xcol = x_coords_elev, yrow = y_coords_elev)</span></span>
<span id="cb11-672"><a href="#cb11-672" aria-hidden="true" tabindex="-1"></a><span class="in"># Cumulative Horizon</span></span>
<span id="cb11-673"><a href="#cb11-673" aria-hidden="true" tabindex="-1"></a><span class="in">## Get the matrix of values from the raster</span></span>
<span id="cb11-674"><a href="#cb11-674" aria-hidden="true" tabindex="-1"></a><span class="in">horizon_matrix &lt;- as.matrix(cumulative_horizon)</span></span>
<span id="cb11-675"><a href="#cb11-675" aria-hidden="true" tabindex="-1"></a><span class="in">## Get the coordinates for the raster, ensuring they match the matrix dimensions</span></span>
<span id="cb11-676"><a href="#cb11-676" aria-hidden="true" tabindex="-1"></a><span class="in">x_coords_hrz &lt;- seq(xmin(cumulative_horizon), xmax(cumulative_horizon), length.out = ncol(horizon_matrix))</span></span>
<span id="cb11-677"><a href="#cb11-677" aria-hidden="true" tabindex="-1"></a><span class="in">y_coords_hrz &lt;- seq(ymin(cumulative_horizon), ymax(cumulative_horizon), length.out = nrow(horizon_matrix))</span></span>
<span id="cb11-678"><a href="#cb11-678" aria-hidden="true" tabindex="-1"></a><span class="in">## Create the im object using the matrix and coordinates</span></span>
<span id="cb11-679"><a href="#cb11-679" aria-hidden="true" tabindex="-1"></a><span class="in">horizon_im &lt;- spatstat.geom::as.im(X = horizon_matrix, xcol = x_coords_hrz, yrow = y_coords_hrz)</span></span>
<span id="cb11-680"><a href="#cb11-680" aria-hidden="true" tabindex="-1"></a><span class="in"># Geomorphons (sum)</span></span>
<span id="cb11-681"><a href="#cb11-681" aria-hidden="true" tabindex="-1"></a><span class="in">## Get the matrix of values from the raster</span></span>
<span id="cb11-682"><a href="#cb11-682" aria-hidden="true" tabindex="-1"></a><span class="in">geomorph_matrix &lt;- as.matrix(geomorph)</span></span>
<span id="cb11-683"><a href="#cb11-683" aria-hidden="true" tabindex="-1"></a><span class="in">## Get the coordinates for the raster, ensuring they match the matrix dimensions</span></span>
<span id="cb11-684"><a href="#cb11-684" aria-hidden="true" tabindex="-1"></a><span class="in">x_coords_gmph &lt;- seq(xmin(geomorph), xmax(geomorph), length.out = ncol(geomorph_matrix))</span></span>
<span id="cb11-685"><a href="#cb11-685" aria-hidden="true" tabindex="-1"></a><span class="in">y_coords_gmph &lt;- seq(ymin(geomorph), ymax(geomorph), length.out = nrow(geomorph_matrix))</span></span>
<span id="cb11-686"><a href="#cb11-686" aria-hidden="true" tabindex="-1"></a><span class="in">## Create the im object using the matrix and coordinates</span></span>
<span id="cb11-687"><a href="#cb11-687" aria-hidden="true" tabindex="-1"></a><span class="in">geomorph_im &lt;- spatstat.geom::as.im(X = geomorph_matrix, xcol = x_coords_gmph, yrow = y_coords_gmph)</span></span>
<span id="cb11-688"><a href="#cb11-688" aria-hidden="true" tabindex="-1"></a><span class="in"># Slope</span></span>
<span id="cb11-689"><a href="#cb11-689" aria-hidden="true" tabindex="-1"></a><span class="in">## Get the matrix of values from the raster</span></span>
<span id="cb11-690"><a href="#cb11-690" aria-hidden="true" tabindex="-1"></a><span class="in">slope_matrix &lt;- as.matrix(slope)</span></span>
<span id="cb11-691"><a href="#cb11-691" aria-hidden="true" tabindex="-1"></a><span class="in">## Get the coordinates for the raster, ensuring they match the matrix dimensions</span></span>
<span id="cb11-692"><a href="#cb11-692" aria-hidden="true" tabindex="-1"></a><span class="in">x_coords_slp &lt;- seq(xmin(slope), xmax(slope), length.out = ncol(slope_matrix))</span></span>
<span id="cb11-693"><a href="#cb11-693" aria-hidden="true" tabindex="-1"></a><span class="in">y_coords_slp &lt;- seq(ymin(slope), ymax(slope), length.out = nrow(slope_matrix))</span></span>
<span id="cb11-694"><a href="#cb11-694" aria-hidden="true" tabindex="-1"></a><span class="in">## Create the im object using the matrix and coordinates</span></span>
<span id="cb11-695"><a href="#cb11-695" aria-hidden="true" tabindex="-1"></a><span class="in">slope_im &lt;- spatstat.geom::as.im(X = slope_matrix, xcol = x_coords_slp, yrow = y_coords_slp)</span></span>
<span id="cb11-696"><a href="#cb11-696" aria-hidden="true" tabindex="-1"></a><span class="in"># Cumulative viewshed</span></span>
<span id="cb11-697"><a href="#cb11-697" aria-hidden="true" tabindex="-1"></a><span class="in">## Get the matrix of values from the raster</span></span>
<span id="cb11-698"><a href="#cb11-698" aria-hidden="true" tabindex="-1"></a><span class="in">cum_view_matrix &lt;- as.matrix(cumulative_viewshed)</span></span>
<span id="cb11-699"><a href="#cb11-699" aria-hidden="true" tabindex="-1"></a><span class="in">## Get the coordinates for the raster, ensuring they match the matrix dimensions</span></span>
<span id="cb11-700"><a href="#cb11-700" aria-hidden="true" tabindex="-1"></a><span class="in">x_coords_cview &lt;- seq(xmin(cumulative_viewshed), xmax(cumulative_viewshed), length.out = ncol(cum_view_matrix))</span></span>
<span id="cb11-701"><a href="#cb11-701" aria-hidden="true" tabindex="-1"></a><span class="in">y_coords_cview &lt;- seq(ymin(cumulative_viewshed), ymax(cumulative_viewshed), length.out = nrow(cum_view_matrix))</span></span>
<span id="cb11-702"><a href="#cb11-702" aria-hidden="true" tabindex="-1"></a><span class="in">## Create the im object using the matrix and coordinates</span></span>
<span id="cb11-703"><a href="#cb11-703" aria-hidden="true" tabindex="-1"></a><span class="in">cumview_im &lt;- spatstat.geom::as.im(X = cum_view_matrix, xcol = x_coords_cview, yrow = y_coords_cview)</span></span>
<span id="cb11-704"><a href="#cb11-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-705"><a href="#cb11-705" aria-hidden="true" tabindex="-1"></a><span class="in"># Fit Point Process Model to Data</span></span>
<span id="cb11-706"><a href="#cb11-706" aria-hidden="true" tabindex="-1"></a><span class="in">covlist &lt;- list(elev_im, horizon_im, geomorph_im, slope_im)</span></span>
<span id="cb11-707"><a href="#cb11-707" aria-hidden="true" tabindex="-1"></a><span class="in">names(covlist) &lt;- c("elev_im", "horizon_im", "geomorph_im", "slope_im")</span></span>
<span id="cb11-708"><a href="#cb11-708" aria-hidden="true" tabindex="-1"></a><span class="in">fotrend &lt;- ~ elev_im + horizon_im + geomorph_im + slope_im</span></span>
<span id="cb11-709"><a href="#cb11-709" aria-hidden="true" tabindex="-1"></a><span class="in">mod1 &lt;- step(ppm(sppp, </span></span>
<span id="cb11-710"><a href="#cb11-710" aria-hidden="true" tabindex="-1"></a><span class="in">                 trend=fotrend, </span></span>
<span id="cb11-711"><a href="#cb11-711" aria-hidden="true" tabindex="-1"></a><span class="in">                 interaction=NULL, </span></span>
<span id="cb11-712"><a href="#cb11-712" aria-hidden="true" tabindex="-1"></a><span class="in">                 covariates=covlist, </span></span>
<span id="cb11-713"><a href="#cb11-713" aria-hidden="true" tabindex="-1"></a><span class="in">                 method="logi"),</span></span>
<span id="cb11-714"><a href="#cb11-714" aria-hidden="true" tabindex="-1"></a><span class="in">             verbose = FALSE)</span></span>
<span id="cb11-715"><a href="#cb11-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-716"><a href="#cb11-716" aria-hidden="true" tabindex="-1"></a><span class="in"># Create a logistic regression surface</span></span>
<span id="cb11-717"><a href="#cb11-717" aria-hidden="true" tabindex="-1"></a><span class="in">logodds &lt;- -22.3439702866+(elev_im*6.897505e-03)</span></span>
<span id="cb11-718"><a href="#cb11-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-719"><a href="#cb11-719" aria-hidden="true" tabindex="-1"></a><span class="in"># Point process models</span></span>
<span id="cb11-720"><a href="#cb11-720" aria-hidden="true" tabindex="-1"></a><span class="in">numSims &lt;- 999 # Define the number of Monte Carlo Simulations to run</span></span>
<span id="cb11-721"><a href="#cb11-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-722"><a href="#cb11-722" aria-hidden="true" tabindex="-1"></a><span class="in"># A. Null model</span></span>
<span id="cb11-723"><a href="#cb11-723" aria-hidden="true" tabindex="-1"></a><span class="in">mod0 &lt;- ppm(sppp, ~1)</span></span>
<span id="cb11-724"><a href="#cb11-724" aria-hidden="true" tabindex="-1"></a><span class="in">Pcfinhom_mod0 &lt;- envelope(mod0, </span></span>
<span id="cb11-725"><a href="#cb11-725" aria-hidden="true" tabindex="-1"></a><span class="in">                          fun=pcfinhom, </span></span>
<span id="cb11-726"><a href="#cb11-726" aria-hidden="true" tabindex="-1"></a><span class="in">                          correction="best", </span></span>
<span id="cb11-727"><a href="#cb11-727" aria-hidden="true" tabindex="-1"></a><span class="in">                          nsim=numSims,</span></span>
<span id="cb11-728"><a href="#cb11-728" aria-hidden="true" tabindex="-1"></a><span class="in">                          verbose = FALSE)</span></span>
<span id="cb11-729"><a href="#cb11-729" aria-hidden="true" tabindex="-1"></a><span class="in"># B. First order interaction (using the covariates)</span></span>
<span id="cb11-730"><a href="#cb11-730" aria-hidden="true" tabindex="-1"></a><span class="in">Pcfinhom_mod1 &lt;- envelope(mod1, </span></span>
<span id="cb11-731"><a href="#cb11-731" aria-hidden="true" tabindex="-1"></a><span class="in">                          fun=pcfinhom, </span></span>
<span id="cb11-732"><a href="#cb11-732" aria-hidden="true" tabindex="-1"></a><span class="in">                          correction="best", </span></span>
<span id="cb11-733"><a href="#cb11-733" aria-hidden="true" tabindex="-1"></a><span class="in">                          nsim=numSims,</span></span>
<span id="cb11-734"><a href="#cb11-734" aria-hidden="true" tabindex="-1"></a><span class="in">                          verbose = FALSE)</span></span>
<span id="cb11-735"><a href="#cb11-735" aria-hidden="true" tabindex="-1"></a><span class="in"># C. Second order interaction (using the covariates and creating an area of interaction between points)</span></span>
<span id="cb11-736"><a href="#cb11-736" aria-hidden="true" tabindex="-1"></a><span class="in">mod2 &lt;- step(ppm(sppp, trend = fotrend, </span></span>
<span id="cb11-737"><a href="#cb11-737" aria-hidden="true" tabindex="-1"></a><span class="in">                 interaction = AreaInter(150), </span></span>
<span id="cb11-738"><a href="#cb11-738" aria-hidden="true" tabindex="-1"></a><span class="in">                 covariates = covlist, </span></span>
<span id="cb11-739"><a href="#cb11-739" aria-hidden="true" tabindex="-1"></a><span class="in">                 method = "logi"),</span></span>
<span id="cb11-740"><a href="#cb11-740" aria-hidden="true" tabindex="-1"></a><span class="in">             trace = 0)</span></span>
<span id="cb11-741"><a href="#cb11-741" aria-hidden="true" tabindex="-1"></a><span class="in">Pcfinhom_mod2 &lt;- envelope(mod2, </span></span>
<span id="cb11-742"><a href="#cb11-742" aria-hidden="true" tabindex="-1"></a><span class="in">                          fun=pcfinhom, </span></span>
<span id="cb11-743"><a href="#cb11-743" aria-hidden="true" tabindex="-1"></a><span class="in">                          correction="best", </span></span>
<span id="cb11-744"><a href="#cb11-744" aria-hidden="true" tabindex="-1"></a><span class="in">                          nsim=numSims,</span></span>
<span id="cb11-745"><a href="#cb11-745" aria-hidden="true" tabindex="-1"></a><span class="in">                          verbose = FALSE)</span></span>
<span id="cb11-746"><a href="#cb11-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-747"><a href="#cb11-747" aria-hidden="true" tabindex="-1"></a><span class="in"># Plot figure</span></span>
<span id="cb11-748"><a href="#cb11-748" aria-hidden="true" tabindex="-1"></a><span class="in"># Set up a 2x2 plotting layout</span></span>
<span id="cb11-749"><a href="#cb11-749" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(2, 2))</span></span>
<span id="cb11-750"><a href="#cb11-750" aria-hidden="true" tabindex="-1"></a><span class="in"># Plot 1: Logistic Regression Map</span></span>
<span id="cb11-751"><a href="#cb11-751" aria-hidden="true" tabindex="-1"></a><span class="in">plot(logodds, </span></span>
<span id="cb11-752"><a href="#cb11-752" aria-hidden="true" tabindex="-1"></a><span class="in">     main = "Logistic Regression Map")</span></span>
<span id="cb11-753"><a href="#cb11-753" aria-hidden="true" tabindex="-1"></a><span class="in">plot(sites$geometry, add=T, pch=21, cex= 1)</span></span>
<span id="cb11-754"><a href="#cb11-754" aria-hidden="true" tabindex="-1"></a><span class="in"># Plot 2: Random model</span></span>
<span id="cb11-755"><a href="#cb11-755" aria-hidden="true" tabindex="-1"></a><span class="in">plot(Pcfinhom_mod0, </span></span>
<span id="cb11-756"><a href="#cb11-756" aria-hidden="true" tabindex="-1"></a><span class="in">     xlim = c(0, 2000), </span></span>
<span id="cb11-757"><a href="#cb11-757" aria-hidden="true" tabindex="-1"></a><span class="in">     ylim = c(0, 20), </span></span>
<span id="cb11-758"><a href="#cb11-758" aria-hidden="true" tabindex="-1"></a><span class="in">     legend = FALSE, </span></span>
<span id="cb11-759"><a href="#cb11-759" aria-hidden="true" tabindex="-1"></a><span class="in">     main = "a. Random model", </span></span>
<span id="cb11-760"><a href="#cb11-760" aria-hidden="true" tabindex="-1"></a><span class="in">     xlab="Distance in metres")</span></span>
<span id="cb11-761"><a href="#cb11-761" aria-hidden="true" tabindex="-1"></a><span class="in">legend("topright", </span></span>
<span id="cb11-762"><a href="#cb11-762" aria-hidden="true" tabindex="-1"></a><span class="in">       legend = c("Megalithic sites", "CSR", "999 random simulations"),</span></span>
<span id="cb11-763"><a href="#cb11-763" aria-hidden="true" tabindex="-1"></a><span class="in">       col = c("black", "red", "grey"),</span></span>
<span id="cb11-764"><a href="#cb11-764" aria-hidden="true" tabindex="-1"></a><span class="in">       lty = c(1, 2, 1), </span></span>
<span id="cb11-765"><a href="#cb11-765" aria-hidden="true" tabindex="-1"></a><span class="in">       lwd = c(1, 1, 3), </span></span>
<span id="cb11-766"><a href="#cb11-766" aria-hidden="true" tabindex="-1"></a><span class="in">       cex = 0.8, </span></span>
<span id="cb11-767"><a href="#cb11-767" aria-hidden="true" tabindex="-1"></a><span class="in">       bty = "n")</span></span>
<span id="cb11-768"><a href="#cb11-768" aria-hidden="true" tabindex="-1"></a><span class="in"># Plot 3: First-order model</span></span>
<span id="cb11-769"><a href="#cb11-769" aria-hidden="true" tabindex="-1"></a><span class="in">plot(Pcfinhom_mod1, </span></span>
<span id="cb11-770"><a href="#cb11-770" aria-hidden="true" tabindex="-1"></a><span class="in">     xlim = c(0, 2000), </span></span>
<span id="cb11-771"><a href="#cb11-771" aria-hidden="true" tabindex="-1"></a><span class="in">     ylim = c(0, 20), </span></span>
<span id="cb11-772"><a href="#cb11-772" aria-hidden="true" tabindex="-1"></a><span class="in">     legend = FALSE, </span></span>
<span id="cb11-773"><a href="#cb11-773" aria-hidden="true" tabindex="-1"></a><span class="in">     main = "b. First-order model", </span></span>
<span id="cb11-774"><a href="#cb11-774" aria-hidden="true" tabindex="-1"></a><span class="in">     xlab="Distance in metres")</span></span>
<span id="cb11-775"><a href="#cb11-775" aria-hidden="true" tabindex="-1"></a><span class="in">legend("topright", </span></span>
<span id="cb11-776"><a href="#cb11-776" aria-hidden="true" tabindex="-1"></a><span class="in">       legend = c("Megalithic sites", "CSR", "999 random simulations"),</span></span>
<span id="cb11-777"><a href="#cb11-777" aria-hidden="true" tabindex="-1"></a><span class="in">       col = c("black", "red", "grey"),</span></span>
<span id="cb11-778"><a href="#cb11-778" aria-hidden="true" tabindex="-1"></a><span class="in">       lty = c(1, 2, 1), </span></span>
<span id="cb11-779"><a href="#cb11-779" aria-hidden="true" tabindex="-1"></a><span class="in">       lwd = c(1, 1, 3), </span></span>
<span id="cb11-780"><a href="#cb11-780" aria-hidden="true" tabindex="-1"></a><span class="in">       cex = 0.8, </span></span>
<span id="cb11-781"><a href="#cb11-781" aria-hidden="true" tabindex="-1"></a><span class="in">       bty = "n")</span></span>
<span id="cb11-782"><a href="#cb11-782" aria-hidden="true" tabindex="-1"></a><span class="in"># Plot 4: Second-order model</span></span>
<span id="cb11-783"><a href="#cb11-783" aria-hidden="true" tabindex="-1"></a><span class="in">plot(Pcfinhom_mod2, </span></span>
<span id="cb11-784"><a href="#cb11-784" aria-hidden="true" tabindex="-1"></a><span class="in">     xlim = c(0, 2000), </span></span>
<span id="cb11-785"><a href="#cb11-785" aria-hidden="true" tabindex="-1"></a><span class="in">     ylim = c(0, 20), </span></span>
<span id="cb11-786"><a href="#cb11-786" aria-hidden="true" tabindex="-1"></a><span class="in">     legend = FALSE, </span></span>
<span id="cb11-787"><a href="#cb11-787" aria-hidden="true" tabindex="-1"></a><span class="in">     main = "c. Second-order model\n(AreaInter = 150)", </span></span>
<span id="cb11-788"><a href="#cb11-788" aria-hidden="true" tabindex="-1"></a><span class="in">     xlab="Distance in metres")</span></span>
<span id="cb11-789"><a href="#cb11-789" aria-hidden="true" tabindex="-1"></a><span class="in">legend("topright", </span></span>
<span id="cb11-790"><a href="#cb11-790" aria-hidden="true" tabindex="-1"></a><span class="in">       legend = c("Megalithic sites", "CSR", "999 random simulations"),</span></span>
<span id="cb11-791"><a href="#cb11-791" aria-hidden="true" tabindex="-1"></a><span class="in">       col = c("black", "red", "grey"),</span></span>
<span id="cb11-792"><a href="#cb11-792" aria-hidden="true" tabindex="-1"></a><span class="in">       lty = c(1, 2, 1), </span></span>
<span id="cb11-793"><a href="#cb11-793" aria-hidden="true" tabindex="-1"></a><span class="in">       lwd = c(1, 1, 3), </span></span>
<span id="cb11-794"><a href="#cb11-794" aria-hidden="true" tabindex="-1"></a><span class="in">       cex = 0.8, </span></span>
<span id="cb11-795"><a href="#cb11-795" aria-hidden="true" tabindex="-1"></a><span class="in">       bty = "n")</span></span>
<span id="cb11-796"><a href="#cb11-796" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-797"><a href="#cb11-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-798"><a href="#cb11-798" aria-hidden="true" tabindex="-1"></a><span class="fu">## **5. Results**</span></span>
<span id="cb11-799"><a href="#cb11-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-800"><a href="#cb11-800" aria-hidden="true" tabindex="-1"></a>Of all the variables that were modelled – Altitude, Slope, Cumulative Horizon, Cumulative viewshed, Distance to Ridges, Distance to Water Edges, Distance to Rock Outcrops, Topographic Prominence – the covariates with significant median p-values are the Altitude, Slope, Cumulative horizon and Cumulative viewshed, indicating that these environmental variables are likely important in determining the site locations. Other covariates, such as the Topographic Prominence Index contains non-significant median p-values, suggesting that this variable might not be playing a strong role on the influence of site locations. This is complemented by the U-statistic (\~551,263 (median)) with a p-value of 0.62, suggesting that there is not a significance difference in TPI values between site and background locations.</span>
<span id="cb11-801"><a href="#cb11-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-802"><a href="#cb11-802" aria-hidden="true" tabindex="-1"></a>A cross reading from the results indicate that sites are likely located at higher altitudes than expected by chance, and on specific slopes compared to the surrounding landscape. This might relate with other factors, such as the proximity to water sources, or the visibility. The latter could be the case, as the analysis of the cumulative horizon and the cumulative viewshed indicates that the sites might have been intentionally placed in areas with specific viewsheds or horizon properties. The high visibility may have been a key factor in the placing of the megalithic sites, likely for communication, controlling of the surrounding landscape or a symbolic dominance, perhaps even a preexisting one.</span>
<span id="cb11-803"><a href="#cb11-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-804"><a href="#cb11-804" aria-hidden="true" tabindex="-1"></a>The distance to watershed edges approaches the threshold of significance. This suggests that watersheds played a role in the site placement, maybe at a general scale, but its importance might vary across the study area. Taking that this variable was modelled to consider the travel cost from slope, this could mean that there’s a significant portion of this landscape that allows for travel between monuments without encountering relevant obstacles – we emphasize yet again that portion might be represented by those 138 points. This could imply that, in terms of both monument implantation, and movement across this landscape, it may be that the main travel/access points are influenced by the territory’s topography. However, this can be interpreted as tacit knowledge - *i. e.,* visibility, access to water and natural pathways for circulation remain important to access a territory and remain important features of influence for, say, a settlement of any kind.</span>
<span id="cb11-805"><a href="#cb11-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-806"><a href="#cb11-806" aria-hidden="true" tabindex="-1"></a>Although only one variable can truly capture the overall influence of geomorphological constraints on these communities’ reactions towards this landscape, the analysis suggests that local features of the terrain, such as topography, seem to have a stronger influence on the specific locations chosen.</span>
<span id="cb11-807"><a href="#cb11-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-808"><a href="#cb11-808" aria-hidden="true" tabindex="-1"></a>Some things started to become clearer, and even though the results are promising, they rely on a certain level of inconsistency precisely representing the fact that the distribution rests on the aspect that these landscapes have a diachronic background, with distinct uses. We could even forward the debated “*satellitization*”, meaning newer monuments being built next to old ones – acting as “satellites” (Carvalho &amp; Carvalho, 2018: 46; Carrero-Pazos et al. 2019), something partly visible in the statistical models created in figure 6.</span>
<span id="cb11-809"><a href="#cb11-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-810"><a href="#cb11-810" aria-hidden="true" tabindex="-1"></a>We discussed in the beginning how ambitious it can become to not only access the life *tempo* of these monuments - individually - but how challenging it is to truly study a landscape that was constructed and deconstructed over centuries. Hence the main critics behind the use of digital tools: they cannot truly access the diachronic aspects of these landscapes.</span>
<span id="cb11-811"><a href="#cb11-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-812"><a href="#cb11-812" aria-hidden="true" tabindex="-1"></a>So, what are we to do? Should we consider the totality of the sample with the initial 178 points and deal with Laboreiro as a territorial unity for the sake of statistical analysis and variable refinement, being Altitude more than enough to explain this distribution? Or do we find ourselves in the position of defending that the sample with 138 points is the one truly representative of Laboreiro’s true spatial structure, with a complex relation between altitude, slopes and horizons?</span>
<span id="cb11-813"><a href="#cb11-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-814"><a href="#cb11-814" aria-hidden="true" tabindex="-1"></a>In the beginning of this text, we mentioned Serra da Aboboreira (Porto, Portugal). There are nucleus of monuments that were built throughout the centuries, from the beginning of the 4^th^ millennium AC to Final Bronze and the most iconic one is the already mentioned “*Núcleo de Outeiro de Gregos”*[^4]which serves as a good example of this “*satellitization*”. At the same time, we have monuments that were built in the same period, but in complete isolation<span class="ot">[^5]</span>, or others that, being isolated, were built in places that are the opposite of what one would expect of these monuments. So, contrary to Outeiro de Gregos, we have Mina do Simão (Jorge, 1984), a closed dolmen, also in Aboboreira, that was built at the bottom of a small hill, facing what would’ve been a stream. None of the variables suggested here would apply: Mina do Simão has no viewshed (being at the bottom of said hill) and was implanted on a slope with no topographic prominence<span class="ot">[^6]</span>.</span>
<span id="cb11-815"><a href="#cb11-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-816"><a href="#cb11-816" aria-hidden="true" tabindex="-1"></a><span class="ot">[^4]: </span>The Nucleus of Outeiro de Gregos is a group of five monuments: two dolmens built in the beginning of the 4^th^ millennium, another in the end of the 4^th^ millennium, one in a transitional phase to the 3^rd^ (if not representing that timeline already), a megalithic cist build in the beginning of the 2^nd^ millennium, and the fifth monument, a small *tumulus* devoid of chamber representing final Bronze Age. In this area, there was also found a small round lithic structure and pits opened in the bedrock (Jorge, 1980a, 1980b, 1980c, 1980d, 1980e, 1981, 1982a, 1982b; Cruz &amp; Sanches, 1985).</span>
<span id="cb11-817"><a href="#cb11-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-818"><a href="#cb11-818" aria-hidden="true" tabindex="-1"></a><span class="ot">[^5]: </span>We will, here, distance ourselves from what this might comprise, as it may lay on profound cultural notions that are completely out of our reach or, at least, out of this paper’s objectives.</span>
<span id="cb11-819"><a href="#cb11-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-820"><a href="#cb11-820" aria-hidden="true" tabindex="-1"></a><span class="ot">[^6]: </span>Despite extensive efforts within the current PhD project to relocate this monument, it could not be found. It appears to have been completely obliterated sometime between its original excavation and 2023).</span>
<span id="cb11-821"><a href="#cb11-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-822"><a href="#cb11-822" aria-hidden="true" tabindex="-1"></a>To continue discussing this aspect, as an example we can consider the stratigraphy observed in some monuments: it has been forwarded that the terrain for their implantation was treated and cleaned, sometimes using fire and burning an entire patch of land (this is usually seen in a layer rich in charcoal or ash, just like in Outeiro de Gregos 1, Chã de Santinhos 1, or Mamoa da Igrejinha (all from Serra da Aboboreira, Porto, Portugal (Jorge, 1980: 16; Jorge, 1989: 387; Cleto &amp; Faro, 1988: 50, respectively). Recent micromorphological analysis to undisturbed sections of Anta 1 do Vale da Laje (Tomar, Portugal) have also shown that it’s possible to observe the existence of both several human activities and sedimentary processes that occurred in different phases: before, during and after the monument’s construction. The analysis conducted indicated 1) the existence of cleaning activities through fire in an area covered with vegetation, 2) a perturbation context due to the observance of scratching of large surfaces around the monument (possibly a construction event), 3) a later forest regrowth (indicating abandonment) and 4) its subsequent cleaning (indicating a reuse), etc. (Adewumi, 2018-2019: 14, 39-40). It is in these small aspects that we can observe that level of inconsistency - not in the data, nor in the methods - but in how heterogeneous these landscapes are, hence our need in scrutinizing our sample even more, despite the primal results shown by the Wilcoxon test.</span>
<span id="cb11-823"><a href="#cb11-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-824"><a href="#cb11-824" aria-hidden="true" tabindex="-1"></a><span class="fu">## **6. Conclusion**</span></span>
<span id="cb11-825"><a href="#cb11-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-826"><a href="#cb11-826" aria-hidden="true" tabindex="-1"></a>This research has contributed to the debate of the complex interplay between the role that some environmental variables could have in the explanation of the spatial patterns of the mounds and megaliths of Serra do Laboreiro. Our research has shown that some variables, such as the altitude, slope, cumulative horizon and cumulative viewshed might have influenced the spatial location of the monuments, suggesting that the topographic positioning might have played a crucial role in monument placing. The prominence of those factors might be supporting the hypothesis that the mounds and megaliths in this region could have been strategically located to optimize their viewsheds, potentially related to communication, territorial control or symbolic purposes. This adds new data for current debates in the megalithic phenomenon of Northwestern Iberia and other European regions (see e.g. Higginbottom et al. 2025).</span>
<span id="cb11-827"><a href="#cb11-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-828"><a href="#cb11-828" aria-hidden="true" tabindex="-1"></a>Also, the spatial patterns modelled in this work reflect a diachronic use of the landscape, where different occupation strategies might be employed over time. The concept of “satellitization”, wherein newer monuments were built near older ones, appears to be supported by our statistical work, a similar approach done in other regions (see Carrero-Pazos et al. 2019).</span>
<span id="cb11-829"><a href="#cb11-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-830"><a href="#cb11-830" aria-hidden="true" tabindex="-1"></a>Despite these promising insights gained through computational and quantitative modelling, our study also acknowledges the inherent limitations of those tools in capturing the full complexity of a landscape in continuous transformation. The archaeological evidence, including micromorphological analyses, could reveal in this area that the site selection would involve some works such as land preparation or controlled burning, further emphasizing the role of human agency on shaping the landscapes (see e.g. Rodríguez del Cueto et al. 2023).</span>
<span id="cb11-831"><a href="#cb11-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-832"><a href="#cb11-832" aria-hidden="true" tabindex="-1"></a>Ultimately, our research helps reinforcing the idea that while environmental factors could significantly have influenced the site placement, the general spatial distribution cannot be reduced to a single deterministic model. Instead, research like this one reflect a dynamic interaction between human cultural practices, environmental affordances and long-term social landscape transformations. Future research should try to integrate additional qualitative data and diachronic analyses to refine our understanding of settlement strategies, megalithic and mound placing, and the process of formation of those complex monumental landscapes.</span>
<span id="cb11-833"><a href="#cb11-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-834"><a href="#cb11-834" aria-hidden="true" tabindex="-1"></a><span class="fu">## **7. Reproducibility statement**</span></span>
<span id="cb11-835"><a href="#cb11-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-836"><a href="#cb11-836" aria-hidden="true" tabindex="-1"></a>The research contained in this paper was carried out comprising current standards for open access and reproducible frameworks in archaeology, by using a scripting statistical language such as R Statistics and sharing the research data and results in collaborative ways. The data and scripts are available under a Zenodo repository (<span class="ot">&lt;https://zenodo.org/records/15480087&gt;</span>), and Github for collaborative work (<span class="ot">&lt;https://github.com/MCarreroPazos/MegalithsLaboreiro&gt;</span>). R scripts are released under MIT license and archaeological and data results are shared under CC-BY4.0</span>
<span id="cb11-837"><a href="#cb11-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-838"><a href="#cb11-838" aria-hidden="true" tabindex="-1"></a>R Statistics package citation is done using the <span class="co">[</span><span class="ot">grateful package</span><span class="co">](https://pakillo.github.io/grateful/index.html)</span>, with a summary file included in the root directory of the project (see Github page).</span>
<span id="cb11-839"><a href="#cb11-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-840"><a href="#cb11-840" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb11-841"><a href="#cb11-841" aria-hidden="true" tabindex="-1"></a><span class="in">grateful::cite_packages(output = "paragraph", pkgs = "Session", out.dir = ".")</span></span>
<span id="cb11-842"><a href="#cb11-842" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-843"><a href="#cb11-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-846"><a href="#cb11-846" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-847"><a href="#cb11-847" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb11-848"><a href="#cb11-848" aria-hidden="true" tabindex="-1"></a>pkgs <span class="ot">&lt;-</span> grateful<span class="sc">::</span><span class="fu">cite_packages</span>(<span class="at">output =</span> <span class="st">"table"</span>, <span class="at">pkgs =</span> <span class="st">"Session"</span>, <span class="at">out.dir =</span> <span class="st">"."</span>)</span>
<span id="cb11-849"><a href="#cb11-849" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(pkgs)</span>
<span id="cb11-850"><a href="#cb11-850" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-851"><a href="#cb11-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-852"><a href="#cb11-852" aria-hidden="true" tabindex="-1"></a><span class="fu">## **8. Acknowledgments**</span></span>
<span id="cb11-853"><a href="#cb11-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-854"><a href="#cb11-854" aria-hidden="true" tabindex="-1"></a>Denise Lima e Silva is funded by FCT *Foundation for Science and Technology* (FCT scholarship nº. 2020.04713.BD). This work was done under the European Union’s Horizon 2020 research and innovation programme (Marie Skłodowska-Curie Grant Agreements No. 886793, PI: MCP; and No. 794048 PI: JF). The authors want to thank the *Comunidade Intermunicipal do Alto Minho* (CIM Alto Minho) for providing the LiDAR data used in this work.</span>
<span id="cb11-855"><a href="#cb11-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-856"><a href="#cb11-856" aria-hidden="true" tabindex="-1"></a><span class="fu">## **9. References**</span></span>
<span id="cb11-857"><a href="#cb11-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-858"><a href="#cb11-858" aria-hidden="true" tabindex="-1"></a>Adewumi, O. (2018-2019). Soil Micromorphology of the Sedimentary Samples from Anta 1 de Vale da Laje, Tomar, Portugal <span class="sc">\[</span>unpublished master dissertation<span class="sc">\]</span>. Tomar: Instituto Politécnico de Tomar (Department of Archaeology, Conservation, Restoration and Heritage).</span>
<span id="cb11-859"><a href="#cb11-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-860"><a href="#cb11-860" aria-hidden="true" tabindex="-1"></a>Baddeley, A., Rubak, E. y Turner, R. (2016). Spatial Point Patterns. Methodology and Applications with R. Boca Raton: Chapman &amp; Hall/CRC.</span>
<span id="cb11-861"><a href="#cb11-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-862"><a href="#cb11-862" aria-hidden="true" tabindex="-1"></a>Blas Cortina, M. Á. de (2010). Poder ancestral y territorio neolítico: en torno a Peña Tú y los túmulos de la costa oriental de Asturias. *Munibe*, 32, 94-118.</span>
<span id="cb11-863"><a href="#cb11-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-864"><a href="#cb11-864" aria-hidden="true" tabindex="-1"></a>Bello Diéguez, J., Criado Boado, F., &amp; Vázquez Várela, J. (1982). Megalitismo y medio físico en el Noroeste de la Península Ibérica: Estado de la cuestión y perspectivas. *Zephyrus, 34-25*, 109-118.</span>
<span id="cb11-865"><a href="#cb11-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-866"><a href="#cb11-866" aria-hidden="true" tabindex="-1"></a>Berganzo-Besga, I., Orengo, H., Canela, J., &amp; Belarte, M. (2022). Potential of Multitemporal Lidar for the Detection of Subtle Archaeological Features under Perennial Dense Forest. *Land*(11). doi:https://doi.org/10.3390/land11111964</span>
<span id="cb11-867"><a href="#cb11-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-868"><a href="#cb11-868" aria-hidden="true" tabindex="-1"></a>Berganzo-Besga, I., Orengo, H., Lumbreras, F., Carrero-Pazos, M., Fonte, J., &amp; Vilas-Estévez, B. (2021). Hybrid MSRM-Based Deep Learning and Multitemporal Sentinel 2-Based Machine Learning Algorithm Detects Near 10k Archaeological Tumuli in North-Western Iberia. *Remote Sensing, 13*(20).</span>
<span id="cb11-869"><a href="#cb11-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-870"><a href="#cb11-870" aria-hidden="true" tabindex="-1"></a>Berrocal-Rangel, L., García-Giménez, R., Manglano, G., &amp; Ruano, L. (2018). When archaeological context is lacking. Lithology and spatial analysis, new interpretations of the “verracos” Iron Age sculptures in Western Iberian Peninsula. *Journal of Archaeological Science: Reports, 22*, 344-358. doi:https://doi.org/10.1016/j.jasrep.2016.03.031.</span>
<span id="cb11-871"><a href="#cb11-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-872"><a href="#cb11-872" aria-hidden="true" tabindex="-1"></a>Bettencourt, A., &amp; Vilas Boas, L. (2021). Monumentos Megalíticos do Alto-Minho: a modelação de uma paisagem milenar. Em *Património artístico e cultural do Alto Minho. Uma viagem no tempo* (pp. 24-35). Comunidade Intermunicipal do Alto Minho.</span>
<span id="cb11-873"><a href="#cb11-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-874"><a href="#cb11-874" aria-hidden="true" tabindex="-1"></a>Bevan, A. (2015). The data deluge. *Antiquity, 89*(348), 1473-1484.</span>
<span id="cb11-875"><a href="#cb11-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-876"><a href="#cb11-876" aria-hidden="true" tabindex="-1"></a>Bevan, A. (2020). Spatial point pattern and processes. In Gillings, M., Hacigüzeller, P. &amp; G. Lock (eds), *Archaeological Spatial Analysis. A methodological Guide* (pp. 60-76). New York: Routledge.</span>
<span id="cb11-877"><a href="#cb11-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-878"><a href="#cb11-878" aria-hidden="true" tabindex="-1"></a>Bevan, A., Crema, E., Xiuzhen, L., Palmisano, A. (2013). Intensities, interactions and uncertainties: some new approaches to archaeological distributions. In Bevan, A. &amp; M. Lake (eds), *Computational Approaches to Archaeological Spaces* (pp. 27-52). California: Left Coast Press.</span>
<span id="cb11-879"><a href="#cb11-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-880"><a href="#cb11-880" aria-hidden="true" tabindex="-1"></a>Bocinsky, K. (2017). Landscape-based Hypothesis Testing in R. In Marwick, B. *How to do archaeological science using R*. Chapter 9. <span class="ot">&lt;https://benmarwick.github.io/How-To-Do-Archaeological-Science-Using-R/landscape-based-hypothesis-testing-in-r.html#references-cited&gt;</span></span>
<span id="cb11-881"><a href="#cb11-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-882"><a href="#cb11-882" aria-hidden="true" tabindex="-1"></a>Bueno Ramírez, P. (1988). *Los dólmenes de Valencia de Alcántara (Excavaciones arqueológicas en España, 155).* Madrid: Subdirección General de Bellas Artes y Arqueología.</span>
<span id="cb11-883"><a href="#cb11-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-884"><a href="#cb11-884" aria-hidden="true" tabindex="-1"></a>Bustelo Abuín, J., Rodríguez Rellán, C., Fábregas Valcarce, R., Barbeito Pose, V. (2017). Alén da Serra. O fenómeno tumular na Península do Barbanza a través dos SIX e a estatística espacial.&nbsp;Gallaecia. Revista de Arqueoloxía e Ciencias da Antigüidade, 36: 53-72.</span>
<span id="cb11-885"><a href="#cb11-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-886"><a href="#cb11-886" aria-hidden="true" tabindex="-1"></a>Cabras, M. (2018). *Patrones de Asentamiento de la Edad del Bronce en el monte Arci y Alta Marmilla, Cerdeña centro-occidental (Doctoral Thesis).* Granada: Universidad de Granada. Obtido de http://hdl.handle/10481/52511</span>
<span id="cb11-887"><a href="#cb11-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-888"><a href="#cb11-888" aria-hidden="true" tabindex="-1"></a>Cabrero González, C., Cámara Serrano, J. A, &amp; Esquivel Guerrero, J. (2020). Patrones de distribución espacial en las necrópolis megalíticas de Majadillas y Hoyas del Conquín (Granada, España). Resultados preliminares. *Lucentum, XXXIX*, 73-85. doi:10.14198/LVCENTVM2020.39.04</span>
<span id="cb11-889"><a href="#cb11-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-890"><a href="#cb11-890" aria-hidden="true" tabindex="-1"></a>Cabrero González, C., Cámara Serrano, J. A. &amp; Cerrillo Cuenca, E. (2025). A larger-scale study of the visual dominance at the Gor River megalithic landscape (Granada, Spain). *Journal of Archaeological Science: Reports* 61, 104912. <span class="ot">&lt;https://doi.org/10.1016/j.jasrep.2024.104912&gt;</span></span>
<span id="cb11-891"><a href="#cb11-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-892"><a href="#cb11-892" aria-hidden="true" tabindex="-1"></a>Canedo, D., Fonte, J., Seco, L., Vázquez, M., Dias, R., Pereiro, T., Hipólito, J., Menéndez-Marsh, F., Georgieva, P., Neves, A. J. R. (2023). Uncovering Archaeological Sites in Airborne LiDAR Data With Data-Centric Artificial Intelligence. *IEEE Access, 11*, 65608-65619. doi:10.1109/ACCESS.2023.3290305</span>
<span id="cb11-893"><a href="#cb11-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-894"><a href="#cb11-894" aria-hidden="true" tabindex="-1"></a>Canedo, D., Hipólito, J., Fonte, J., Dias, R., do Pereiro, T., Georgieva, P., Gonçalves-Seco, K., Vázquez, M., Pires, N., Fábrega-Álvarez, P., Menéndez-Marsh, F., Neves, A. J. R. (2024). The Synergy between Artificial Intelligence, Remote Sensing, and Archaeological Fieldwork Validation. *Remote Sensing* 16(11): 1933. <span class="ot">&lt;http://doi.org/10.3390/rs16111933&gt;</span></span>
<span id="cb11-895"><a href="#cb11-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-896"><a href="#cb11-896" aria-hidden="true" tabindex="-1"></a>Carlson, D. (2017). *Quantitative Methods in Archaeology Using R.* Cambridge University Press.</span>
<span id="cb11-897"><a href="#cb11-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-898"><a href="#cb11-898" aria-hidden="true" tabindex="-1"></a>Carrero Pazos, M. (2017). *El fenómeno tumular y megalítico en Galicia. Aportaciones desde los Sistemas de Información Geográfica y la Estadística Espacial para el estudio de los patrones de localización \[Unpublished thesis\].* Santiago de Compostela: Universidade de Santiago de Compostela.</span>
<span id="cb11-899"><a href="#cb11-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-900"><a href="#cb11-900" aria-hidden="true" tabindex="-1"></a>Carrero-Pazos, M., Bevan, A., &amp; Lake, M. (2019). The spatial structure of Galician megalithic landscapes (NW iberia): A case study from the Monte Penide region. *Journal of Archaeological Science, 108*, 1-12.</span>
<span id="cb11-901"><a href="#cb11-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-902"><a href="#cb11-902" aria-hidden="true" tabindex="-1"></a>Carrero-Pazos, M., Bustelo-Abuín, J., Barbeito-Pose, V., &amp; Rodríguez-Rellán, C. (2020). Locational preferences and spatial arrangement in the barrowlandscape of Serra do Barbanza (North-western Iberia). *Journal of Archaeological Science: Reports, 31*. doi:https://doi.org/10.1016/j.jasrep.2020.102351</span>
<span id="cb11-903"><a href="#cb11-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-904"><a href="#cb11-904" aria-hidden="true" tabindex="-1"></a>Carvalho, P., &amp; Carvalho, A. (2018). Para uma recuperação do megalitismo de Lafões (Viseu, Portugal). O concelho de Vouzela enquanto case-study. Em J. Senna-Martinez, M. Diniz , &amp; A. Carvalho (Ed.), *De Gibraltar aos Pirinéus - Megalitismo, Vida e Morte na Fachada Atlântica Peninsular* (pp. 37-50). Fundação Lapa do Lobo.</span>
<span id="cb11-905"><a href="#cb11-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-906"><a href="#cb11-906" aria-hidden="true" tabindex="-1"></a>Catela, J. (2020). Construction materials of the monuments of Los Llanetes group, El Pozuelo cemetery (Huelva, Spain). Selection, exploitation and provenance of stone blocks. Em R. Boaventura, R. Mataloto, &amp; A. Pereira (Edits.), *Megaliths and Geology. MEGA-TALKS 2 19-20 November 2015* (pp. 87-134). Redondo, Portugal: Archaeopress Publishing Ltd.</span>
<span id="cb11-907"><a href="#cb11-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-908"><a href="#cb11-908" aria-hidden="true" tabindex="-1"></a>Cleto, J., &amp; Faro, S. (1988). Escavação da Mamoa de Igrejinhas (Marco de Canaveses - Serra da Aboboreira). *Arqueologia*(17), 44-57.</span>
<span id="cb11-909"><a href="#cb11-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-910"><a href="#cb11-910" aria-hidden="true" tabindex="-1"></a>Conolly, J., &amp; Lake, M. (2006). *Geographical Information Systems in Archaeology.* Cambridge University Press. doi:https://doi.org/10.1017/CBO9780511807459</span>
<span id="cb11-911"><a href="#cb11-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-912"><a href="#cb11-912" aria-hidden="true" tabindex="-1"></a>Conrad, O. (2011). *Module TPI Based Landform Classification*. Retrieved 2 15, 2023, from SAGA-GIS Module Library Documentation (v2.2.1): https://saga-gis.sourceforge.io/saga_tool_doc/2.2.1/ta_morphometry_19.html</span>
<span id="cb11-913"><a href="#cb11-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-914"><a href="#cb11-914" aria-hidden="true" tabindex="-1"></a>Conrad, O. (2016). *Tool Multi-Scale Topographic Position Index (TPI)*. Retrieved 2 15, 2023, from SAGA-GIS Tool Library Documentation (v7.0.0): https://saga-gis.sourceforge.io/saga_tool_doc/7.0.0/ta_morphometry_28.html</span>
<span id="cb11-915"><a href="#cb11-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-916"><a href="#cb11-916" aria-hidden="true" tabindex="-1"></a>Cortell Nicolau, A., &amp; Pardo-Gordó, S. (2023). Modelizaciones computacionales para la comprensión de fenómenos históricos y sociales. *Vegueta. Anuário de la Facultad de Geografia e História, 23*(1), 9-14.</span>
<span id="cb11-917"><a href="#cb11-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-918"><a href="#cb11-918" aria-hidden="true" tabindex="-1"></a>Criado Boado, F. (1988). Arqueología del Paisaje y Espacio Megalítico en Galicia. *Seminario sobre Arqueología*, 61-117.</span>
<span id="cb11-919"><a href="#cb11-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-920"><a href="#cb11-920" aria-hidden="true" tabindex="-1"></a>Criado Boado, F., &amp; Villoch Vázquez, V. (2000). Monumentalizing landscape: from present perception to the past meaning of Galician Megalithism (north-west Iberian Peninsula). *European Journal of Archaeology, 3*(2), 188-216.</span>
<span id="cb11-921"><a href="#cb11-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-922"><a href="#cb11-922" aria-hidden="true" tabindex="-1"></a>Criado Boado, F., &amp; Grajal Blanco, M. (1981). Relación entre la distribución de mámoas y el medio físico de la zona de Sobrado-Curtis. *Brigantium,*(2), 7-26.</span>
<span id="cb11-923"><a href="#cb11-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-924"><a href="#cb11-924" aria-hidden="true" tabindex="-1"></a>Criado Boado, F., &amp; Valcarce, R. (1989). The megalithic phenomenon of northwest Spain: main trends. *Antiquity, 63*(241), 682-696.</span>
<span id="cb11-925"><a href="#cb11-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-926"><a href="#cb11-926" aria-hidden="true" tabindex="-1"></a>Criado-Boado, F. (1984). El tercer factor o la lógica oculta del emplazamiento de los túmulos megalíticos. *Cuadernos de Estudios Gallegos, 35*, 7-18.</span>
<span id="cb11-927"><a href="#cb11-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-928"><a href="#cb11-928" aria-hidden="true" tabindex="-1"></a>Cruz, D. J. (1980). Contribuição para o levantamento cartográfico do conjunto megalítico da Serra da Aboboreira (concelhos de Amarante e Baião). *Actas do Seminário de Arqueologia do Noroeste Peninsular.* *I*, pp. 23-40. Guimarães: Sociedade Martins Sarmento.</span>
<span id="cb11-929"><a href="#cb11-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-930"><a href="#cb11-930" aria-hidden="true" tabindex="-1"></a>Cruz, D. J. (1992). A Mamoa 1 de Chã de Carvalhal no Contexto Arqueológico da Serra da Aboboreira. Em *Conimbriga, Anexos* (Vol. I). Coimbra: Instituto de Arqueologia da Faculdade de Letras de Coimbra.</span>
<span id="cb11-931"><a href="#cb11-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-932"><a href="#cb11-932" aria-hidden="true" tabindex="-1"></a>Cruz, D. J., &amp; Sanches, M. J. (1985). Escavação da Mamoa 4 de Outeiro de Gregos (Serra da Aboboreira - Baião). *Arqueologia*(11), 26-39.</span>
<span id="cb11-933"><a href="#cb11-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-934"><a href="#cb11-934" aria-hidden="true" tabindex="-1"></a>Čučković, Z. (2016). Advanced viewshed analysis: a Quantum GIS plug-in for the analysis of visual landscapes. *Journal of Open Source Software, 1*(4), 32. doi:doi:10.21105/joss.00032</span>
<span id="cb11-935"><a href="#cb11-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-936"><a href="#cb11-936" aria-hidden="true" tabindex="-1"></a>Díaz-Rodríguez, M., &amp; Fábregas-Valcarce, R. (2022). Evaluating the effectiveness of three spatial cluster analysis methods on Palaeolithic site location distributions in Galicia, NW Iberian Peninsula. *Journal of Archaeological Science: Reports, 41*. doi:https://doi.org/10.1016/j.jasrep.2021.103323</span>
<span id="cb11-937"><a href="#cb11-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-938"><a href="#cb11-938" aria-hidden="true" tabindex="-1"></a>Diéz Castillo, A. (1996). Utilización de los recursos en la marina y montaña cantábricas: una prehistoria ecológica de los valles del deva y Nansa. *Illunzar*(3), 11-185.</span>
<span id="cb11-939"><a href="#cb11-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-940"><a href="#cb11-940" aria-hidden="true" tabindex="-1"></a>Eguileta Franco , J. (1999). *A Baixa Limia na Prehistoria Recente. Arqueoloxía dunha Paisaxe na Galicia interior.* Ourense:: Excma. Diputación Provincial de Ourense.</span>
<span id="cb11-941"><a href="#cb11-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-942"><a href="#cb11-942" aria-hidden="true" tabindex="-1"></a>Eguileta Franco, J. (1993-1994). As Mámoas dos concellos da Baixa Limia: Aportación al catálogo de monumentos tumulares de la comarca. *Cuadernos de Estudios Gallegos, 41*(106), 41-64.</span>
<span id="cb11-943"><a href="#cb11-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-944"><a href="#cb11-944" aria-hidden="true" tabindex="-1"></a>Eguileta Franco, J. (1995). El volumen de los monumentos megalíticos: aportación a los patrones de emplazamiento en la comarca de A Baixa Limia (Ourense, Galicia). *Boletín del Seminario de Estudios de Arte y Arqueología de Valladolid, LXI*, 9-39.</span>
<span id="cb11-945"><a href="#cb11-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-946"><a href="#cb11-946" aria-hidden="true" tabindex="-1"></a>Ehlschlaeger, C. (1989). Using the AT Search Algorithm to Develop Hydrologic Models from Digital Elevation Data. *International Geographic Information Systems (IGIS) Symposium '89*, (pp. 275-281). Baltimore, Maryland, USA.</span>
<span id="cb11-947"><a href="#cb11-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-948"><a href="#cb11-948" aria-hidden="true" tabindex="-1"></a>Esquivel, F., Cabrero, C., Cámara, J., &amp; Esquivel, J. (2022). Statistical analysis on metric and geometric features of dolmens in the Gor river megalithic landscape (Granada, Andalusia, Spain). *Archaeometry*, 1-18. doi:10.1111/arcm.12750</span>
<span id="cb11-949"><a href="#cb11-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-950"><a href="#cb11-950" aria-hidden="true" tabindex="-1"></a>Fábregas Valcarce, R. (1988). Cronología y periodización del megalitismo en Galicia y norte de Portugal. *Espacio, Tiempo y Forma, 1*(1), 279-291. doi:DOI: 10.5944/etfi.1.1988.4494</span>
<span id="cb11-951"><a href="#cb11-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-952"><a href="#cb11-952" aria-hidden="true" tabindex="-1"></a>Fábregas Valcarce, R., &amp; Vilaseco Vásquez, X. (2000). El Neolítico y el Megalitismo en Galicia: problemas teórico-metodológicos y estado de la cuestión. (V. GONÇALVES, Ed.), *Trabalhos de Arqueologia*(25), 281-305.</span>
<span id="cb11-953"><a href="#cb11-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-954"><a href="#cb11-954" aria-hidden="true" tabindex="-1"></a>Gallant, J.C., Dowling, T.I. (2003): A multiresolution index of valley bottom flatness for mapping depositional areas. *Water Resources Research*, 39/12, 1347-1359.</span>
<span id="cb11-955"><a href="#cb11-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-956"><a href="#cb11-956" aria-hidden="true" tabindex="-1"></a>García Sanjuán, L. (2008). Grandes piedras en un mundo cambiante: la arqueología de los megalitos en su paisaje. *PH Boletín del Instituto Andaluz del Patrimonio Histórico*, 67, 24-33.</span>
<span id="cb11-957"><a href="#cb11-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-958"><a href="#cb11-958" aria-hidden="true" tabindex="-1"></a>García Sanjuán, L., Wheatley, D., Murrieta-Flores, P., &amp; Márquez Pérez, J. (2009). Los SIG y el análisis espacial en arqueología. Aplicaciones en la prehistoria reciente del sur de España. Em M. Cau Ontiveros, &amp; F. Nieto Prieto (Edits.), *Arqueología náutica mediterránea* (pp. 163-180). Girona: Centre d'Arqueologia Subacuàtica de Catalunya. Obtido de http://hdl.handle.net/11441/53295</span>
<span id="cb11-959"><a href="#cb11-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-960"><a href="#cb11-960" aria-hidden="true" tabindex="-1"></a>Gillings, M. (2012). Landscape Phenomenology, GIS and the Role of Affordance. *Journal of Archaeological Method and Theory, 19*, 601–611. doi:DOI 10.1007/s10816-012-9137-4</span>
<span id="cb11-961"><a href="#cb11-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-962"><a href="#cb11-962" aria-hidden="true" tabindex="-1"></a>Gillings, M., Hacigüzeller, P., &amp; Lock, G. (2020). *Archaeological Spatial Analysis: A Methodologial Guide.* Routledge.</span>
<span id="cb11-963"><a href="#cb11-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-964"><a href="#cb11-964" aria-hidden="true" tabindex="-1"></a>Günther, G., Kempf, M., Knitter, D., 2022. *rbias* (Version R-package 0.1), <span class="ot">&lt;https://zenodo.org/record/7071418&gt;</span></span>
<span id="cb11-965"><a href="#cb11-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-966"><a href="#cb11-966" aria-hidden="true" tabindex="-1"></a>Higginbottom, G., Gonzalez-Garcia, A., Carrero-Pazos, M., Vilas-Estévez, B., &amp; López-López, V. (2022). Landscapes of the “Coast of Death”: dolmen topographies of NW Iberia. *STAR: Science &amp; Technology of Archaeological Research, 8*(1), 1-19. doi:10.1080/20548923.2022.2078029</span>
<span id="cb11-967"><a href="#cb11-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-968"><a href="#cb11-968" aria-hidden="true" tabindex="-1"></a>Higginbottom, G., Verdonkschot, J., Scarre, C., González-García, C., Criado Boado, F. (2025). *Megalithic Societies: Old Questions, New Narratives*. Oxford: Archaeopress.</span>
<span id="cb11-969"><a href="#cb11-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-970"><a href="#cb11-970" aria-hidden="true" tabindex="-1"></a>Hu, D. (2011). Advancing Theory? Landscape Archaeology and Geographical Information Systems. *PIA, 21*, 80-90. doi: 10.5334/pia.381</span>
<span id="cb11-971"><a href="#cb11-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-972"><a href="#cb11-972" aria-hidden="true" tabindex="-1"></a>Jasiewicz, J., &amp; Stepinski, T. (2013). Geomorphons - a pattern recognition approach to classification and mapping of landforms. *Geomorphology*, 147-156. doi: 10.1016/j.geomorph.2012.11.005</span>
<span id="cb11-973"><a href="#cb11-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-974"><a href="#cb11-974" aria-hidden="true" tabindex="-1"></a>Jorge, V. O. (1980a). A Mamoa 2 de Outeiro de Gregos - Serra da Aboboreira, Baião. *Revista de Guimarães*(90), 191-209.</span>
<span id="cb11-975"><a href="#cb11-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-976"><a href="#cb11-976" aria-hidden="true" tabindex="-1"></a>Jorge, V. O. (1980b). Escavação das Mamoas 2 e 3 de Outeiro de Gregos (Serra da Aboboreira - Baião) - Notícia Preliminar. *IV Congresso Nacional de Arqueologia* (pp. 251-267). Faro: Lisboa: Centro de Hist. das Universidades de Lisboa, <span class="sc">\[</span>D.L. 1979<span class="sc">\]</span>.</span>
<span id="cb11-977"><a href="#cb11-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-978"><a href="#cb11-978" aria-hidden="true" tabindex="-1"></a>Jorge, V. O. (1980c). Escavação da Mamoa 1 de Outeiro de Gregos. Serra da Aboboreira, Baião. *Portugália, nova série*(I), 9-28.</span>
<span id="cb11-979"><a href="#cb11-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-980"><a href="#cb11-980" aria-hidden="true" tabindex="-1"></a>Jorge, V. (1980d). Sobre uma estrutura periférica situada na periferia da Mamoa 2 de Outeiro de Gregos (Serra da Aboboreira, Baião). *Arqueologia*(2), 19-24.</span>
<span id="cb11-981"><a href="#cb11-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-982"><a href="#cb11-982" aria-hidden="true" tabindex="-1"></a>Jorge, V. O. (1980e). Nótula sobre a fossa aberta no saibro de Outeiro de Gregos (Serra da Aboboreira, Baião). *Arqueologia*(1), 19-24.</span>
<span id="cb11-983"><a href="#cb11-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-984"><a href="#cb11-984" aria-hidden="true" tabindex="-1"></a>Jorge, V. (1982a). *Megalitismo do Norte de Portugal: o Distrito do Porto - Os Monumentos e a sua Problemática no Contexto Europeu.* (Vol. I). Porto: Dissertação de doutoramento apresentada à Faculdade de Letras da Universidade do Porto.</span>
<span id="cb11-985"><a href="#cb11-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-986"><a href="#cb11-986" aria-hidden="true" tabindex="-1"></a>Jorge, V. O. (1982b). A Mamoa 5 de Outeiro de Gregos, um tumulus não Megalítico da Serra da Aboboreira. *Arqueologia*(6), 32-39.</span>
<span id="cb11-987"><a href="#cb11-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-988"><a href="#cb11-988" aria-hidden="true" tabindex="-1"></a>Jorge, V. (1987). Megalitismo de Entre-Douro-e-Minho e de Trás-os-Montes (Norte de Portugal): conhecimentos actuais e linhas de pesquisa a desenvolver. *História: revista da Faculdade de Letras da Universidade do Porto*(4), 269-192.</span>
<span id="cb11-989"><a href="#cb11-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-990"><a href="#cb11-990" aria-hidden="true" tabindex="-1"></a>Jorge, V. O. (1981). Importância do Núcleo Megalítico de Outeiro de Gregos. Serra da Aboboreira, Baião. *Arqueologia*(3), 29-35.</span>
<span id="cb11-991"><a href="#cb11-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-992"><a href="#cb11-992" aria-hidden="true" tabindex="-1"></a>Jorge, V. O. (1983-84). O Megalitismo do Norte de Portugal: um novo balanço. *Portugália*(IV-V), 37-45.</span>
<span id="cb11-993"><a href="#cb11-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-994"><a href="#cb11-994" aria-hidden="true" tabindex="-1"></a>Jorge, V. O. (1989). Les tumulus de Chã de Santinhos : (ensemble mégalíthique de Serra da Aboboreira, Nord du Portugal). Em P. I. Científica (Ed.), *Livro de homenagem a Jean Roche* (pp. 381-413).</span>
<span id="cb11-995"><a href="#cb11-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-996"><a href="#cb11-996" aria-hidden="true" tabindex="-1"></a>Jorge, V. O. (1992). As mamoas funerárias do norte de Portugal (do Neolítico à Idade do Bronze Antigo) como elementos indicadores de uma progressiva complexidade social. *Revista da Faculdade de Letras. Historia*(9), 463-480.</span>
<span id="cb11-997"><a href="#cb11-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-998"><a href="#cb11-998" aria-hidden="true" tabindex="-1"></a>Kempf, M., Günther, G. (2022). Point pattern and spatial analyses using archaeological and environmental data – A case study from the Neolithic Carpathian Basin. Journal of Archaeological Science: Reports 47, 103747. https://doi.org/10.1016/j.jasrep.2022.103747</span>
<span id="cb11-999"><a href="#cb11-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1000"><a href="#cb11-1000" aria-hidden="true" tabindex="-1"></a>Kokalj, Ž., &amp; Hesse, R. (2017). *Airborne laser scanning raster data visualization: A Guide to Good Practice.* Ljubljana: Založba ZRC.</span>
<span id="cb11-1001"><a href="#cb11-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1002"><a href="#cb11-1002" aria-hidden="true" tabindex="-1"></a>Kvamme, K. L. (2020). Analysing regional environmental relationships. In Gillings, M., Hacigüzeller, P., &amp; Lock, G. (2020). *Archaeological Spatial Analysis: A Methodologial Guide* (212-230)*.* London: Routledge.</span>
<span id="cb11-1003"><a href="#cb11-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1004"><a href="#cb11-1004" aria-hidden="true" tabindex="-1"></a>L'helgouac'h, J. (1965). *Les sépultures mégalithiques en Armorique.* Rennes: Laboratoire d'Anthropologie Préhistorique de la Faculté des Sciences.</span>
<span id="cb11-1005"><a href="#cb11-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1006"><a href="#cb11-1006" aria-hidden="true" tabindex="-1"></a>Llober, M. (2000). Understanding movement: a Pilot Model Towards the Sociology of Movement. In G. Lock (Ed.), *Beyond the Map: Archaeology and Spatial Technologies* (pp. 66-84). Washington.: IOS Press.</span>
<span id="cb11-1007"><a href="#cb11-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1008"><a href="#cb11-1008" aria-hidden="true" tabindex="-1"></a>Llobera, M. (2015). Working the Digital: Some thoughts from Landscape Archaeology. Em R. Chapman, &amp; A. Wylie (Edits.), *Material Evidence: Learning from Archaeological Practice* (pp. 173-188). Abingdon: Routledge.</span>
<span id="cb11-1009"><a href="#cb11-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1010"><a href="#cb11-1010" aria-hidden="true" tabindex="-1"></a>López Cuevillas, F. (1923). Os dólmenes do Monte das Motas en Lobeira. *Revista Nós, 18*, 18-21.</span>
<span id="cb11-1011"><a href="#cb11-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1012"><a href="#cb11-1012" aria-hidden="true" tabindex="-1"></a>López Cuevillas, F. (1925a). La época megalítica en el Noroeste de la Península. *Boletín de la Real Academia Gallega, XV*, 25-39.</span>
<span id="cb11-1013"><a href="#cb11-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1014"><a href="#cb11-1014" aria-hidden="true" tabindex="-1"></a>López Cuevillas, F. (1925b). As mámoas do Concello de Rairiz. *Boletín de la Real Academia Gallega, XV*, 235-245.</span>
<span id="cb11-1015"><a href="#cb11-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1016"><a href="#cb11-1016" aria-hidden="true" tabindex="-1"></a>López Cuevillas, F. (1973). A edade megalítica. Em R. Otero Pedrayo (Ed.), *Historia de Galicia* (Vol. I, pp. 43-122). Buenos Aires: Ediciones Galicia.</span>
<span id="cb11-1017"><a href="#cb11-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1018"><a href="#cb11-1018" aria-hidden="true" tabindex="-1"></a>Mehrer, M., &amp; Wescott, K. (2006). *GIS and Archaeological Site Location Modeling.* Routledge.</span>
<span id="cb11-1019"><a href="#cb11-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1020"><a href="#cb11-1020" aria-hidden="true" tabindex="-1"></a>Murrieta-Flores, P. (2012). Understanding human movement through spatial technologies. The role of natural areas of transit in the Late Prehistory of South-western Iberia. *Trabajos de Prehistoria, 69*(1), 103-122. doi:10.3989/tp.2012.12082</span>
<span id="cb11-1021"><a href="#cb11-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1022"><a href="#cb11-1022" aria-hidden="true" tabindex="-1"></a>Murrieta-Flores, P. (2014). Developing computational approaches for the study of movement: assessing the role of visibility and landscape markers in terrestrial navigation during Iberian Late Prehistory. Em S. Polla, &amp; P. Verhagen (Edits.), *Computational Approaches to the Study of Movement in Archaeology. Theory, Practice and Interpretation of Factors and Effects of Long-Term Landscape Formation and Transformation* (Vol. 23, pp. 74-99). Berlin, Boston: Walter de Gruyter.</span>
<span id="cb11-1023"><a href="#cb11-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1024"><a href="#cb11-1024" aria-hidden="true" tabindex="-1"></a>Opitz, R. S., Cowley, D. C. (2013). *Interpreting Archaeological Topography: 3D Data, Visualisation and Observation*. Oxford: Oxbow Books.</span>
<span id="cb11-1025"><a href="#cb11-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1026"><a href="#cb11-1026" aria-hidden="true" tabindex="-1"></a>O'Sullivan, M. (2011). Megalithic tombs and storied landscapes in Neolithic Ireland. Em M. Furholt, F. Lüth, &amp; J. Müller (Edits.), *Megaliths and identities: early monuments and Neolithic societies from the Atlantic to the Baltic* (Vol. 12, pp. 53-66). Dr Rudolph Habelt GmbH.</span>
<span id="cb11-1027"><a href="#cb11-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1028"><a href="#cb11-1028" aria-hidden="true" tabindex="-1"></a>Parcero Oubiña, C., &amp; Fábrega Álvarez, P. (2006). Diseño metodológico para el análisis locacional de asentamientos a través de un SIG de base raster. Em I. Grau Mira (Ed.), *La aplicación de los SIG en la Arqueología del Paisaje* (pp. 69-91). Alicante: Servicio de Publicaciones Universidad de Alicante.</span>
<span id="cb11-1029"><a href="#cb11-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1030"><a href="#cb11-1030" aria-hidden="true" tabindex="-1"></a>Renfrew, C. (1973). *The Explanation of Culture change: models in Prehistory.* Liverpool: Duckworth.</span>
<span id="cb11-1031"><a href="#cb11-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1032"><a href="#cb11-1032" aria-hidden="true" tabindex="-1"></a>Renfrew, C. (1976). Megaliths, territories and populations. *Acculturation and Continuity in Atlantic Europe, mainly during the Neolithic period and the Bronze Age. Papers Presented at the IV Atlantic Colloquium* (pp. 198-220). Ghent, Bruges: De Tempel.</span>
<span id="cb11-1033"><a href="#cb11-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1034"><a href="#cb11-1034" aria-hidden="true" tabindex="-1"></a>Rodríguez Casal, A. (1979). O Megalitismo na Galiza. A sua problemática e o estado actual de investigación. Em *1ª Mesa-Redonda sobre o Neolítico e o Calcolitico em Portugal* (pp. 103-115). Porto: Grupo de Estudos Arqueológicos do Porto.</span>
<span id="cb11-1035"><a href="#cb11-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1036"><a href="#cb11-1036" aria-hidden="true" tabindex="-1"></a>Rodríguez del Cueto, F., &amp; Carrero-Pazos, M. (2021a). Contributions from LiDAR technology to the sites and monuments records: the prehistoric barrows of Salas Council (Asturias, Spain). *Veleia, 38*, 9-31.</span>
<span id="cb11-1037"><a href="#cb11-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1038"><a href="#cb11-1038" aria-hidden="true" tabindex="-1"></a>Rodríguez del Cueto, F., &amp; Carrero-Pazos, M. (2021b). Límites y posibilidades de los análisis LiDAR aplicados al megalitismo asturiano. Revisión de cuatro conjuntos tumulares prehistóricos en el concejo de Salas (España). *Veleia, 38*(38), 9-31. doi:10.1387/veleia.21455</span>
<span id="cb11-1039"><a href="#cb11-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1040"><a href="#cb11-1040" aria-hidden="true" tabindex="-1"></a>Rodríguez del Cueto, F., Busto Zapico, M. &amp; Lastra Alonso, E. (2023). El dolmen de la Cobertoria (Salas, Asturias): fases arquitectónicas y primeras aproximaciones al estudio arqueológico y documental del saqueo de las ruinas prehistóricas. En D. García Rivero, *Actas del VII Congreso sobre Neolítico en la península ibérica* (pp. 551-565). Sevilla: Universidad de Sevilla.</span>
<span id="cb11-1041"><a href="#cb11-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1042"><a href="#cb11-1042" aria-hidden="true" tabindex="-1"></a>Rodríguez-Rellán, C., &amp; Fábregas Valcarce, R. (2019). Monuments on the move. Assessing megaliths’ interaction with the North-Western Iberian landscapes. Em J. Müller, M. Hinz, &amp; M. Wunderlich (Ed.), *Proceedings of the international conference - Megaliths, Societies, Landscapes. Early monumentality and social differentiation in Neolithic Europe.* *2*, pp. 621-639. Kiel: Frühe Monumentalität und soziale Differenzierung, 18.</span>
<span id="cb11-1043"><a href="#cb11-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1044"><a href="#cb11-1044" aria-hidden="true" tabindex="-1"></a>Rubio-Campillo, X., Ble, E., Sala, R., &amp; Tamba, R. (2022). A Spatial Connectivity Approach to Landscapes of Conflict: Julius Caesar and the Assault to Puig Ciutat (NE Iberian Peninsula). *Journal of Archaeological Method and Theory, 29*, 1059-1089. doi:https://doi.org/10.1007/s10816-022-09549-7</span>
<span id="cb11-1045"><a href="#cb11-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1046"><a href="#cb11-1046" aria-hidden="true" tabindex="-1"></a>Sanches, M., &amp; Nunes, S. (2005). Monumentos em pedra numa região de Trás-os-Montes - Nordeste de Portugal: Sua expressão na paisagem habitada durante o 4º e 3º milénio BC. *Revista da Faculdade de Letras, CIÊNCIAS E TÉCNICAS DO PATRIMÓNIO, IV*(I Série), 53-82.</span>
<span id="cb11-1047"><a href="#cb11-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1048"><a href="#cb11-1048" aria-hidden="true" tabindex="-1"></a>Shepard, D. (1968). A two-dimensional interpolation function for irregularly-spaced data. *Proceedings of the 1968 23rd ACM National Conference*, (pp. 517-524).</span>
<span id="cb11-1049"><a href="#cb11-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1050"><a href="#cb11-1050" aria-hidden="true" tabindex="-1"></a>Silva, E. (2003). Novos dados sobre o Megalitismo do Norte de Portugal. Em V. Gonçalves (Ed.), *Muita gente, poucas antas? Origens, espaços e contextos do Megalitismo. Actas do II Colóquio Internacional sobre Megalitismo* (Vol. 25, pp. 269-279). Trabalhos de Arqueologia.</span>
<span id="cb11-1051"><a href="#cb11-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1052"><a href="#cb11-1052" aria-hidden="true" tabindex="-1"></a>Sousa, M. G. F. de (2012). O fenómeno tumular e megalítico na região galaico-portuguesa do Minho: tese doutoral. Universidade de Santiago de Compostela. Departamento de Historia I. <span class="ot">&lt;http://hdl.handle.net/10347/7510&gt;</span></span>
<span id="cb11-1053"><a href="#cb11-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1054"><a href="#cb11-1054" aria-hidden="true" tabindex="-1"></a>Tilley, C. (1994). *A Phenomenology of Landscape: Places, Paths and Monuments.* Oxford: Berg.</span>
<span id="cb11-1055"><a href="#cb11-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1056"><a href="#cb11-1056" aria-hidden="true" tabindex="-1"></a>Verhagen, P. (2018). Predictive Modeling. Em S. López Varela (Ed.), *The Encyclopedia of Archaeological Sciences* (pp. 1-3). JohnWiley &amp; Sons, Inc. doi:DOI: 10.1002/9781119188230.saseas0475</span>
<span id="cb11-1057"><a href="#cb11-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1058"><a href="#cb11-1058" aria-hidden="true" tabindex="-1"></a>Vilas-Estévez, B. (2015). Estudio de las orientaciones y emplazamientos de los túmulos de la necrópolis de la Serra do Leboreiro en base a la Arqueología del Paisaje y la Arqueoastronomía. Santiago de Compostela: Universidade de Santiago de Compostela.</span>
<span id="cb11-1059"><a href="#cb11-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1060"><a href="#cb11-1060" aria-hidden="true" tabindex="-1"></a>Villoch Vázquez, V. (1995). Monumentos y petroglifos: la construcción del espacio en las sociedades constructoras de túmulos del noroeste peninsular. *Trabajos de Prehistoria, 52*(1), 39-55.</span>
<span id="cb11-1061"><a href="#cb11-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1062"><a href="#cb11-1062" aria-hidden="true" tabindex="-1"></a>Weiss, A. D. (2001). Topographic position and landforms analysis. Poster Presentation, ESRI Users Conference, San Diego, CA. <span class="ot">&lt;https://env761.github.io/assets/files/tpi-poster-tnc_18x22.pdf&gt;</span></span>
<span id="cb11-1063"><a href="#cb11-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1064"><a href="#cb11-1064" aria-hidden="true" tabindex="-1"></a>Yubero-Gómez, M., Rubio-Campillo, X., López-Cachero, F., &amp; Esteve-Gràcia, X. (2015). Mapping changes in late prehistoric landscapes: A case study in the Northeastern Iberian Peninsula. *Journal of Anthropological Archaeology, 40*, 123-134. doi: https://doi.org/10.1016/j.jaa.2015.07.002</span>
<span id="cb11-1065"><a href="#cb11-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1066"><a href="#cb11-1066" aria-hidden="true" tabindex="-1"></a>Zakšek, K., Oštir, K., &amp; Kokalj, Ž. (2011). Sky-View Factor as a Relief Visualization Technique. *Remote Sensing, 3*(2), 398-415. doi: https://doi.org/10.3390/rs3020398</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>